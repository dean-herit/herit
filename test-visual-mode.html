<!DOCTYPE html>
<html>
<head>
    <title>Test Visual Dev Mode</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #1a1a1a; 
            color: white; 
        }
        .test-component {
            border: 2px solid #333;
            padding: 20px;
            margin: 10px;
            border-radius: 8px;
        }
        .status { margin: 10px 0; }
        .success { color: #10b981; }
        .error { color: #ef4444; }
    </style>
</head>
<body>
    <h1>Visual Dev Mode Test</h1>
    
    <div class="status" id="env-status"></div>
    <div class="status" id="localStorage-status"></div>
    <div class="status" id="events-status"></div>
    
    <div 
        class="test-component" 
        data-component-id="test-component-1" 
        data-component-category="ui"
    >
        Test Component 1 - UI Category
    </div>
    
    <div 
        class="test-component" 
        data-component-id="test-component-2" 
        data-component-category="layout"
    >
        Test Component 2 - Layout Category
    </div>
    
    <div 
        class="test-component" 
        data-component-id="test-component-3" 
        data-component-category="business"
    >
        Test Component 3 - Business Category
    </div>
    
    <button onclick="enableVisualMode()">Enable Visual Mode</button>
    <button onclick="testHighlighting()">Test Component Highlighting</button>
    <button onclick="checkState()">Check Current State</button>
    
    <div id="output"></div>
    
    <script>
        function checkEnvironment() {
            // Check if NEXT_PUBLIC_VISUAL_DEV_MODE is available
            const envEnabled = typeof window !== 'undefined' && 
                               window.location.href.includes('localhost:3000');
            
            document.getElementById('env-status').innerHTML = 
                envEnabled ? 
                '<span class="success">✓ Development Environment Detected</span>' : 
                '<span class="error">✗ Not in Development Environment</span>';
        }
        
        function checkLocalStorage() {
            const visualMode = localStorage.getItem('visualDevMode');
            const highlighting = localStorage.getItem('highlightingEnabled');
            const tooltips = localStorage.getItem('showTooltips');
            
            const status = `
                <div>visualDevMode: ${visualMode || 'null'}</div>
                <div>highlightingEnabled: ${highlighting || 'null'}</div>
                <div>showTooltips: ${tooltips || 'null'}</div>
            `;
            
            document.getElementById('localStorage-status').innerHTML = status;
        }
        
        function enableVisualMode() {
            localStorage.setItem('visualDevMode', 'true');
            localStorage.setItem('highlightingEnabled', 'true');
            localStorage.setItem('showTooltips', 'true');
            localStorage.setItem('boundaryOverlay', 'false');
            localStorage.setItem('animateOnHover', 'false');
            
            // Dispatch events
            window.dispatchEvent(new CustomEvent('visualModeToggled'));
            window.dispatchEvent(new Event('storage'));
            
            document.getElementById('output').innerHTML = '<div class="success">Visual dev mode enabled!</div>';
            checkLocalStorage();
        }
        
        function testHighlighting() {
            const components = document.querySelectorAll('[data-component-id]');
            document.getElementById('output').innerHTML = 
                `<div>Found ${components.length} components with data-component-id</div>`;
            
            // Add simple highlighting
            components.forEach((comp, index) => {
                setTimeout(() => {
                    comp.style.border = '2px solid #3b82f6';
                    comp.style.backgroundColor = 'rgba(59, 130, 246, 0.1)';
                    
                    setTimeout(() => {
                        comp.style.border = '2px solid #333';
                        comp.style.backgroundColor = 'transparent';
                    }, 1000);
                }, index * 200);
            });
        }
        
        function checkState() {
            const components = document.querySelectorAll('[data-component-id]');
            const componentList = Array.from(components).map(comp => ({
                id: comp.getAttribute('data-component-id'),
                category: comp.getAttribute('data-component-category')
            }));
            
            const state = {
                visualDevMode: localStorage.getItem('visualDevMode'),
                componentsFound: components.length,
                components: componentList
            };
            
            document.getElementById('output').innerHTML = 
                '<pre>' + JSON.stringify(state, null, 2) + '</pre>';
        }
        
        // Initialize on load
        window.onload = function() {
            checkEnvironment();
            checkLocalStorage();
            
            // Enable visual mode by default for testing
            enableVisualMode();
        };
    </script>
</body>
</html>