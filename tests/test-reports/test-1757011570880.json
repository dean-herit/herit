{
  "executionId": "test-1757011570880",
  "timestamp": "2025-09-04T18:46:10.881Z",
  "status": "failed",
  "overallSuccess": false,
  "results": {
    "backendTests": {
      "command": "npm run test:unit -- tests/api",
      "status": "failed",
      "output": "\n> herit@0.1.0 test:unit\n> NODE_ENV=test vitest run tests/api\n\n\n RUN  v3.2.4 /Users/dean/code/Herit\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Core Functionality > handles POST requests with valid personal info data\nReceived data: {\n  firstName: \u001b[32m'John'\u001b[39m,\n  lastName: \u001b[32m'Doe'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  ppsNumber: \u001b[32m'1234567T'\u001b[39m,\n  addressLine1: \u001b[32m'123 Test Street'\u001b[39m,\n  addressLine2: \u001b[32m'Apt 4'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  photo_url: \u001b[1mnull\u001b[22m,\n  photoMarkedForDeletion: \u001b[33mfalse\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Core Functionality > handles POST requests with valid personal info data\nCurrent user query result: {\n  id: \u001b[32m'a6ce766d-5de1-4005-911e-24600ededf7c'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011580785-f4c8ef35@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T18:46:20.827Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T18:46:20.827Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'John Doe'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011580785-f4c8ef35@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m'1234567T'\u001b[39m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[32m'Apt 4'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'John Doe'\u001b[39m,\n    email: \u001b[32m'test-auth-1757011580785-f4c8ef35@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m'1234567T'\u001b[39m,\n    address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n    address_line_2: \u001b[32m'Apt 4'\u001b[39m,\n    city: \u001b[32m'Dublin'\u001b[39m,\n    county: \u001b[32m'Dublin'\u001b[39m,\n    eircode: \u001b[32m'D01 X123'\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'John'\u001b[39m,\n  last_name: \u001b[32m'Doe'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m'1234567T'\u001b[39m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[32m'Apt 4'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Core Functionality > handles POST requests with valid personal info data\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'John'\u001b[39m,\n  last_name: \u001b[32m'Doe'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m'1234567T'\u001b[39m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[32m'Apt 4'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Error States > validates required personal info fields\nReceived data: {\n  firstName: \u001b[32m''\u001b[39m,\n  lastName: \u001b[32m''\u001b[39m,\n  phoneNumber: \u001b[32m'invalid-phone'\u001b[39m,\n  dateOfBirth: \u001b[32m'invalid-date'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Error States > validates required personal info fields\nCurrent user query result: {\n  id: \u001b[32m'1d0c4c22-683c-40b6-9286-a6a42520b35a'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011581636-b88b8cb1@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T18:46:21.676Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T18:46:21.676Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m''\u001b[39m,\n  email: \u001b[32m'test-auth-1757011581636-b88b8cb1@example.com'\u001b[39m,\n  phone: \u001b[32m'invalid-phone'\u001b[39m,\n  date_of_birth: \u001b[32m'invalid-date'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m''\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m''\u001b[39m,\n  county: \u001b[32m''\u001b[39m,\n  eircode: \u001b[32m''\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mfalse\u001b[39m,\n  error: ZodError: [\n    {\n      \"origin\": \"string\",\n      \"code\": \"too_small\",\n      \"minimum\": 1,\n      \"inclusive\": true,\n      \"path\": [\n        \"name\"\n      ],\n      \"message\": \"Name is required\"\n    },\n    {\n      \"origin\": \"string\",\n      \"code\": \"invalid_format\",\n      \"format\": \"regex\",\n      \"pattern\": \"/^(\\\\+353|0)[1-9]\\\\d{7,9}$/\",\n      \"path\": [\n        \"phone\"\n      ],\n      \"message\": \"Invalid Irish phone number (e.g., +353 1 234 5678)\"\n    }\n  ]\n      at new ZodError \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/core/core.js:30:39\u001b[90m)\u001b[39m\n      at Module.<anonymous> \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/core/parse.js:40:20\u001b[90m)\u001b[39m\n      at _.inst.safeParse \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/classic/schemas.js:30:46\u001b[90m)\u001b[39m\n      at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/personal-info/route.ts:288:49\u001b[90m)\u001b[39m\n  \u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n      at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/personal-info/personal-info.test.ts:142:24\n      at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n}\n\n ❯ tests/api/onboarding/signature/signature.test.ts (10 tests | 1 failed) 3171ms\n   ✓ /api/onboarding > Core Functionality > handles authenticated requests with real JWT tokens  683ms\n   × /api/onboarding > Core Functionality > handles POST requests with valid data 389ms\n     → expected 400 to be less than 300\n   ✓ /api/onboarding > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/onboarding > Security > requires valid JWT authentication 0ms\n   ✓ /api/onboarding > Security > validates JWT signature integrity 0ms\n   ✓ /api/onboarding > Performance > responds within acceptable time with real authentication  434ms\n   ✓ /api/onboarding > Database Integrity > maintains data consistency with real database operations  436ms\n   ✓ /api/onboarding > Integration Scenarios > integrates with authentication workflow  407ms\n   ✓ /api/onboarding > Compliance > meets API standards with proper authentication  431ms\n   ✓ /api/onboarding > Edge Cases > handles malformed requests appropriately  386ms\n ❯ tests/api/auth/create-test-user/create-test-user.test.ts (10 tests | 4 failed) 3187ms\n   ✓ /api/auth/create-test-user > Core Functionality > handles GET requests with valid authentication  593ms\n   ✓ /api/auth/create-test-user > Core Functionality > handles POST requests with valid data  402ms\n   × /api/auth/create-test-user > Error States > returns proper error for unauthenticated requests 63ms\n     → expected 200 to be greater than or equal to 400\n   × /api/auth/create-test-user > Security > requires valid JWT authentication 51ms\n     → expected 200 to be greater than or equal to 400\n   × /api/auth/create-test-user > Security > validates JWT signature integrity 55ms\n     → expected 200 to be greater than or equal to 400\n   ✓ /api/auth/create-test-user > Performance > responds within acceptable time with real authentication  414ms\n   ✓ /api/auth/create-test-user > Database Integrity > maintains data consistency with real database operations  371ms\n   ✓ /api/auth/create-test-user > Integration Scenarios > integrates with authentication workflow  421ms\n   ✓ /api/auth/create-test-user > Compliance > meets API standards with proper authentication  403ms\n   × /api/auth/create-test-user > Edge Cases > handles malformed JSON appropriately 411ms\n     → expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/google/callback/callback.test.ts (10 tests | 6 failed) 3355ms\n   × /api/auth/google/callback > Core Functionality > handles GET requests with valid authentication 621ms\n     → expected 307 to be less than 300\n   × /api/auth/google/callback > Core Functionality > handles POST requests with valid data 387ms\n     → POST is not a function\n   × /api/auth/google/callback > Error States > returns proper error for unauthenticated requests 76ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google/callback > Security > requires valid JWT authentication 82ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google/callback > Security > validates JWT signature integrity 76ms\n     → expected 307 to be greater than or equal to 400\n   ✓ /api/auth/google/callback > Performance > responds within acceptable time with real authentication  436ms\n   ✓ /api/auth/google/callback > Database Integrity > maintains data consistency with real database operations  443ms\n   ✓ /api/auth/google/callback > Integration Scenarios > integrates with authentication workflow  451ms\n   ✓ /api/auth/google/callback > Compliance > meets API standards with proper authentication  446ms\n   × /api/auth/google/callback > Edge Cases > handles malformed JSON appropriately 334ms\n     → POST is not a function\n ❯ tests/api/beneficiaries/beneficiaries.test.ts (10 tests | 1 failed) 3582ms\n   ✓ /api/beneficiaries > Core Functionality > handles authenticated requests with real JWT tokens  800ms\n   × /api/beneficiaries > Core Functionality > handles POST requests with valid data 412ms\n     → expected 400 to be less than 300\n   ✓ /api/beneficiaries > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/beneficiaries > Security > requires valid JWT authentication 0ms\n   ✓ /api/beneficiaries > Security > validates JWT signature integrity 1ms\n   ✓ /api/beneficiaries > Performance > responds within acceptable time with real authentication  504ms\n   ✓ /api/beneficiaries > Database Integrity > maintains data consistency with real database operations  490ms\n   ✓ /api/beneficiaries > Integration Scenarios > integrates with authentication workflow  487ms\n   ✓ /api/beneficiaries > Compliance > meets API standards with proper authentication  501ms\n   ✓ /api/beneficiaries > Edge Cases > handles malformed requests appropriately  383ms\n ❯ tests/api/will/status/status.test.ts (10 tests | 1 failed) 3602ms\n   ✓ /api/will/status > Core Functionality > handles GET requests with valid authentication  742ms\n   × /api/will/status > Core Functionality > handles POST requests with valid data 488ms\n     → expected 404 to be less than 300\n   ✓ /api/will/status > Error States > returns proper error for unauthenticated requests 2ms\n   ✓ /api/will/status > Security > requires valid JWT authentication 1ms\n   ✓ /api/will/status > Security > validates JWT signature integrity 1ms\n   ✓ /api/will/status > Performance > responds within acceptable time with real authentication  504ms\n   ✓ /api/will/status > Database Integrity > maintains data consistency with real database operations  474ms\n   ✓ /api/will/status > Integration Scenarios > integrates with authentication workflow  488ms\n   ✓ /api/will/status > Compliance > meets API standards with proper authentication  493ms\n   ✓ /api/will/status > Edge Cases > handles malformed JSON appropriately  406ms\n ❯ tests/api/rules/rules.test.ts (10 tests | 1 failed) 3917ms\n   ✓ /api/rules > Core Functionality > handles GET requests with valid authentication  807ms\n   × /api/rules > Core Functionality > handles POST requests with valid data 433ms\n     → expected 400 to be less than 300\n   ✓ /api/rules > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/rules > Security > requires valid JWT authentication 0ms\n   ✓ /api/rules > Security > validates JWT signature integrity 0ms\n   ✓ /api/rules > Performance > responds within acceptable time with real authentication  584ms\n   ✓ /api/rules > Database Integrity > maintains data consistency with real database operations  565ms\n   ✓ /api/rules > Integration Scenarios > integrates with authentication workflow  550ms\n   ✓ /api/rules > Compliance > meets API standards with proper authentication  555ms\n   ✓ /api/rules > Edge Cases > handles malformed JSON appropriately  418ms\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates\nReceived data: {\n  firstName: \u001b[32m'Updated'\u001b[39m,\n  lastName: \u001b[32m'Name'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  addressLine1: \u001b[32m'123 New Street'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates\nCurrent user query result: {\n  id: \u001b[32m'9a9954ee-1c2e-4393-b890-826c6cb950b8'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011584126-d9939f7b@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T18:46:24.163Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T18:46:24.163Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Updated Name'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011584126-d9939f7b@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Updated Name'\u001b[39m,\n    email: \u001b[32m'test-auth-1757011584126-d9939f7b@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m'Dublin'\u001b[39m,\n    county: \u001b[32m'Dublin'\u001b[39m,\n    eircode: \u001b[32m'D01 X123'\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Updated'\u001b[39m,\n  last_name: \u001b[32m'Name'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Updated'\u001b[39m,\n  last_name: \u001b[32m'Name'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Core Functionality > handles POST requests with valid data\nOnboarding completion check: {\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  allStepsCompleted: \u001b[33mtrue\u001b[39m,\n  alreadyCompleted: \u001b[33mfalse\u001b[39m\n}\n\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Core Functionality > handles POST requests with valid data\nMarked onboarding complete for user 3b0f5baf-1c9a-4d8b-80bd-ef362538a7e8\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression\nReceived data: {\n  firstName: \u001b[32m'Test'\u001b[39m,\n  lastName: \u001b[32m'User'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  addressLine1: \u001b[32m'123 Test Street'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression\nCurrent user query result: {\n  id: \u001b[32m'7a40be33-8d7f-4f18-be3a-f73ff56dfdd3'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011585365-80b423ff@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mfalse\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mfalse\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mfalse\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mfalse\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mfalse\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T18:46:25.406Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T18:46:25.406Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Test User'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011585365-80b423ff@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Test User'\u001b[39m,\n    email: \u001b[32m'test-auth-1757011585365-80b423ff@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m'Dublin'\u001b[39m,\n    county: \u001b[32m'Dublin'\u001b[39m,\n    eircode: \u001b[32m'D01 X123'\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mfalse\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mfalse\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Edge Cases > handles malformed JSON appropriately\nOnboarding completion check: {\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  allStepsCompleted: \u001b[33mtrue\u001b[39m,\n  alreadyCompleted: \u001b[33mfalse\u001b[39m\n}\n\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Edge Cases > handles malformed JSON appropriately\nMarked onboarding complete for user 250218ca-8302-4231-bad3-6792d32db274\n\n ❯ tests/api/onboarding/verification/verification.test.ts (10 tests | 1 failed) 3143ms\n   ✓ /api/onboarding > Core Functionality > handles authenticated requests with real JWT tokens  574ms\n   × /api/onboarding > Core Functionality > handles POST requests with valid data 382ms\n     → expected 400 to be less than 300\n   ✓ /api/onboarding > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/onboarding > Security > requires valid JWT authentication 0ms\n   ✓ /api/onboarding > Security > validates JWT signature integrity 1ms\n   ✓ /api/onboarding > Performance > responds within acceptable time with real authentication  451ms\n   ✓ /api/onboarding > Database Integrity > maintains data consistency with real database operations  458ms\n   ✓ /api/onboarding > Integration Scenarios > integrates with authentication workflow  414ms\n   ✓ /api/onboarding > Compliance > meets API standards with proper authentication  466ms\n   ✓ /api/onboarding > Edge Cases > handles malformed requests appropriately  392ms\n ❯ tests/api/onboarding/complete/complete.test.ts (10 tests | 9 failed) 3087ms\n   × /api/onboarding/complete > Core Functionality > handles GET requests with valid authentication 532ms\n     → GET is not a function\n   ✓ /api/onboarding/complete > Core Functionality > handles POST requests with valid data  480ms\n   × /api/onboarding/complete > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/onboarding/complete > Security > requires valid JWT authentication 0ms\n     → GET is not a function\n   × /api/onboarding/complete > Security > validates JWT signature integrity 1ms\n     → GET is not a function\n   × /api/onboarding/complete > Performance > responds within acceptable time with real authentication 388ms\n     → GET is not a function\n   × /api/onboarding/complete > Database Integrity > maintains data consistency with real database operations 395ms\n     → GET is not a function\n   × /api/onboarding/complete > Integration Scenarios > integrates with authentication workflow 361ms\n     → GET is not a function\n   × /api/onboarding/complete > Compliance > meets API standards with proper authentication 414ms\n     → GET is not a function\n   × /api/onboarding/complete > Edge Cases > handles malformed JSON appropriately 513ms\n     → expected 200 to be greater than or equal to 400\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Compliance > validates Irish compliance requirements\nReceived data: {\n  firstName: \u001b[32m'Seán'\u001b[39m,\n  lastName: \u001b[32m'Ó Súilleabháin'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  ppsNumber: \u001b[32m'1234567T'\u001b[39m,\n  addressLine1: \u001b[32m'123 Sráid na hÉireann'\u001b[39m,\n  city: \u001b[32m'Baile Átha Cliath'\u001b[39m,\n  county: \u001b[32m'Átha Cliath'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Compliance > validates Irish compliance requirements\nCurrent user query result: {\n  id: \u001b[32m'40219357-d30e-4993-a5c6-eb606a26a96c'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011587241-8666b0b5@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T18:46:27.285Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T18:46:27.285Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Seán Ó Súilleabháin'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011587241-8666b0b5@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m'1234567T'\u001b[39m,\n  address_line_1: \u001b[32m'123 Sráid na hÉireann'\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m'Baile Átha Cliath'\u001b[39m,\n  county: \u001b[32m'Átha Cliath'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mfalse\u001b[39m,\n  error: ZodError: [\n    {\n      \"code\": \"invalid_value\",\n      \"values\": [\n        \"\",\n        \"Antrim\",\n        \"Armagh\",\n        \"Carlow\",\n        \"Cavan\",\n        \"Clare\",\n        \"Cork\",\n        \"Derry\",\n        \"Donegal\",\n        \"Down\",\n        \"Dublin\",\n        \"Fermanagh\",\n        \"Galway\",\n        \"Kerry\",\n        \"Kildare\",\n        \"Kilkenny\",\n        \"Laois\",\n        \"Leitrim\",\n        \"Limerick\",\n        \"Longford\",\n        \"Louth\",\n        \"Mayo\",\n        \"Meath\",\n        \"Monaghan\",\n        \"Offaly\",\n        \"Roscommon\",\n        \"Sligo\",\n        \"Tipperary\",\n        \"Tyrone\",\n        \"Waterford\",\n        \"Westmeath\",\n        \"Wexford\",\n        \"Wicklow\"\n      ],\n      \"path\": [\n        \"county\"\n      ],\n      \"message\": \"Invalid option: expected one of \\\"\\\"|\\\"Antrim\\\"|\\\"Armagh\\\"|\\\"Carlow\\\"|\\\"Cavan\\\"|\\\"Clare\\\"|\\\"Cork\\\"|\\\"Derry\\\"|\\\"Donegal\\\"|\\\"Down\\\"|\\\"Dublin\\\"|\\\"Fermanagh\\\"|\\\"Galway\\\"|\\\"Kerry\\\"|\\\"Kildare\\\"|\\\"Kilkenny\\\"|\\\"Laois\\\"|\\\"Leitrim\\\"|\\\"Limerick\\\"|\\\"Longford\\\"|\\\"Louth\\\"|\\\"Mayo\\\"|\\\"Meath\\\"|\\\"Monaghan\\\"|\\\"Offaly\\\"|\\\"Roscommon\\\"|\\\"Sligo\\\"|\\\"Tipperary\\\"|\\\"Tyrone\\\"|\\\"Waterford\\\"|\\\"Westmeath\\\"|\\\"Wexford\\\"|\\\"Wicklow\\\"\"\n    }\n  ]\n      at new ZodError \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/core/core.js:30:39\u001b[90m)\u001b[39m\n      at Module.<anonymous> \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/core/parse.js:40:20\u001b[90m)\u001b[39m\n      at _.inst.safeParse \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/classic/schemas.js:30:46\u001b[90m)\u001b[39m\n      at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/personal-info/route.ts:288:49\u001b[90m)\u001b[39m\n  \u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n      at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/personal-info/personal-info.test.ts:397:24\n      at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n}\n\n ❯ tests/api/onboarding/photo/photo.test.ts (10 tests | 1 failed) 2888ms\n   ✓ /api/onboarding > Core Functionality > handles authenticated requests with real JWT tokens  553ms\n   × /api/onboarding > Core Functionality > handles POST requests with valid data 405ms\n     → expected 500 to be less than 300\n   ✓ /api/onboarding > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/onboarding > Security > requires valid JWT authentication 0ms\n   ✓ /api/onboarding > Security > validates JWT signature integrity 1ms\n   ✓ /api/onboarding > Performance > responds within acceptable time with real authentication  401ms\n   ✓ /api/onboarding > Database Integrity > maintains data consistency with real database operations  354ms\n   ✓ /api/onboarding > Integration Scenarios > integrates with authentication workflow  381ms\n   ✓ /api/onboarding > Compliance > meets API standards with proper authentication  391ms\n   ✓ /api/onboarding > Edge Cases > handles malformed requests appropriately  397ms\n ❯ tests/api/rules/[id]/[id].test.ts (11 tests | 3 failed) 3046ms\n   × /api/rules/[id] > Core Functionality > handles GET requests with valid authentication 714ms\n     → expected 500 to be less than 300\n   × /api/rules/[id] > Core Functionality > handles PUT requests with valid data 402ms\n     → expected 500 to be less than 300\n   × /api/rules/[id] > Core Functionality > handles DELETE requests with authentication 403ms\n     → expected 500 to be less than 500\n   ✓ /api/rules/[id] > Error States > returns proper error for unauthenticated requests 2ms\n   ✓ /api/rules/[id] > Security > requires valid JWT authentication 1ms\n   ✓ /api/rules/[id] > Security > validates JWT signature integrity 1ms\n   ✓ /api/rules/[id] > Performance > responds within acceptable time with real authentication  373ms\n   ✓ /api/rules/[id] > Database Integrity > maintains data consistency with real database operations  412ms\n   ✓ /api/rules/[id] > Integration Scenarios > integrates with authentication workflow  379ms\n   ✓ /api/rules/[id] > Compliance > meets API standards with proper authentication  356ms\n   ✓ /api/rules/[id] > Edge Cases > handles edge cases appropriately 0ms\n ❯ tests/api/debug/verification/verification.test.ts (10 tests | 3 failed) 3166ms\n   ✓ /api/debug/verification > Core Functionality > handles GET requests with valid authentication  613ms\n   × /api/debug/verification > Core Functionality > handles POST requests with valid data 402ms\n     → POST is not a function\n   × /api/debug/verification > Error States > returns proper error for unauthenticated requests 2ms\n     → POST is not a function\n   ✓ /api/debug/verification > Security > requires valid JWT authentication 1ms\n   ✓ /api/debug/verification > Security > validates JWT signature integrity 1ms\n   ✓ /api/debug/verification > Performance > responds within acceptable time with real authentication  435ms\n   ✓ /api/debug/verification > Database Integrity > maintains data consistency with real database operations  422ms\n   ✓ /api/debug/verification > Integration Scenarios > integrates with authentication workflow  451ms\n   ✓ /api/debug/verification > Compliance > meets API standards with proper authentication  418ms\n   × /api/debug/verification > Edge Cases > handles malformed JSON appropriately 419ms\n     → POST is not a function\n ❯ tests/api/beneficiaries/count/count.test.ts (10 tests | 1 failed) 3228ms\n   ✓ /api/beneficiaries/count > Core Functionality > handles GET requests with valid authentication  692ms\n   ✓ /api/beneficiaries/count > Core Functionality > returns consistent response format  518ms\n   ✓ /api/beneficiaries/count > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/beneficiaries/count > Security > requires valid JWT authentication 0ms\n   ✓ /api/beneficiaries/count > Security > validates JWT signature integrity 1ms\n   ✓ /api/beneficiaries/count > Performance > responds within acceptable time with real authentication  492ms\n   ✓ /api/beneficiaries/count > Database Integrity > maintains data consistency with real database operations  531ms\n   ✓ /api/beneficiaries/count > Integration Scenarios > integrates with authentication workflow  515ms\n   ✓ /api/beneficiaries/count > Compliance > meets API standards with proper authentication  473ms\n   × /api/beneficiaries/count > Edge Cases > handles edge cases appropriately 2ms\n     → expected 500 to be less than 500\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow\nReceived data: {\n  firstName: \u001b[32m'Test'\u001b[39m,\n  lastName: \u001b[32m'User'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  photoMarkedForDeletion: \u001b[33mtrue\u001b[39m,\n  photo_url: \u001b[1mnull\u001b[22m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow\nCurrent user query result: {\n  id: \u001b[32m'9e11c91e-c2a4-459a-95f5-1b6e7c645422'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011588177-71d988cf@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T18:46:28.219Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T18:46:28.219Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Test User'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011588177-71d988cf@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m''\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m''\u001b[39m,\n  county: \u001b[32m''\u001b[39m,\n  eircode: \u001b[32m''\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Test User'\u001b[39m,\n    email: \u001b[32m'test-auth-1757011588177-71d988cf@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m''\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m''\u001b[39m,\n    county: \u001b[32m''\u001b[39m,\n    eircode: \u001b[32m''\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Token Management > maintains session consistency across operations\nReceived data: {\n  firstName: \u001b[32m'Test'\u001b[39m,\n  lastName: \u001b[32m'User'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Token Management > maintains session consistency across operations\nCurrent user query result: {\n  id: \u001b[32m'024c3fea-14c9-4017-a48a-90f29465eaa5'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011590029-ad8ae946@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T18:46:30.073Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T18:46:30.073Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Test User'\u001b[39m,\n  email: \u001b[32m'test-auth-1757011590029-ad8ae946@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m''\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m''\u001b[39m,\n  county: \u001b[32m''\u001b[39m,\n  eircode: \u001b[32m''\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Test User'\u001b[39m,\n    email: \u001b[32m'test-auth-1757011590029-ad8ae946@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m''\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m''\u001b[39m,\n    county: \u001b[32m''\u001b[39m,\n    eircode: \u001b[32m''\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Token Management > maintains session consistency across operations\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\n ❯ tests/api/onboarding/personal-info/personal-info.test.ts (25 tests | 4 failed) 11264ms\n   ✓ /api/onboarding/personal-info > Core Functionality > handles GET requests with valid authentication  782ms\n   ✓ /api/onboarding/personal-info > Core Functionality > returns completion status correctly  521ms\n   ✓ /api/onboarding/personal-info > Core Functionality > handles POST requests with valid personal info data  693ms\n   ✓ /api/onboarding/personal-info > Error States > returns 401 for unauthenticated GET requests 77ms\n   ✓ /api/onboarding/personal-info > Error States > returns 401 for unauthenticated POST requests 80ms\n   ✓ /api/onboarding/personal-info > Error States > validates required personal info fields  520ms\n   ✓ /api/onboarding/personal-info > Security > requires valid JWT authentication for GET 80ms\n   ✓ /api/onboarding/personal-info > Security > requires valid JWT authentication for POST 79ms\n   ✓ /api/onboarding/personal-info > Security > validates JWT signature integrity 81ms\n   × /api/onboarding/personal-info > Security > prevents OAuth email tampering 61ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: face3ad7-6573-4351-b88b-73a98263f60e,original@example.com,Test,User,true,true,true,true,verified\n   ✓ /api/onboarding/personal-info > Performance > responds within acceptable time with real authentication  541ms\n   ✓ /api/onboarding/personal-info > Performance > handles concurrent requests efficiently  673ms\n   ✓ /api/onboarding/personal-info > Database Integrity > maintains user data consistency with real database operations  456ms\n   ✓ /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates  652ms\n   × /api/onboarding/personal-info > Integration Scenarios > integrates with OAuth data source tracking 587ms\n     → expected false to be true // Object.is equality\n   ✓ /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression  720ms\n   ✓ /api/onboarding/personal-info > Compliance > meets API standards with proper authentication  588ms\n   ✓ /api/onboarding/personal-info > Compliance > follows REST API conventions  567ms\n   × /api/onboarding/personal-info > Compliance > validates Irish compliance requirements 509ms\n     → expected 400 to be less than 300\n   ✓ /api/onboarding/personal-info > Edge Cases > handles requests with malformed JSON  427ms\n   ✓ /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow  651ms\n   × /api/onboarding/personal-info > Edge Cases > handles users with incomplete profile data 568ms\n     → expected 'Test' to be '' // Object.is equality\n   ✓ /api/onboarding/personal-info > Token Management > validates access token structure and claims  555ms\n   ✓ /api/onboarding/personal-info > Token Management > handles expired tokens appropriately 78ms\n   ✓ /api/onboarding/personal-info > Token Management > maintains session consistency across operations  715ms\n ❯ tests/api/audit/log-event/log-event.test.ts (10 tests | 9 failed) 2934ms\n   × /api/audit/log-event > Core Functionality > handles GET requests with valid authentication 529ms\n     → GET is not a function\n   ✓ /api/audit/log-event > Core Functionality > handles POST requests with valid data  431ms\n   × /api/audit/log-event > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/audit/log-event > Security > requires valid JWT authentication 0ms\n     → GET is not a function\n   × /api/audit/log-event > Security > validates JWT signature integrity 0ms\n     → GET is not a function\n   × /api/audit/log-event > Performance > responds within acceptable time with real authentication 394ms\n     → GET is not a function\n   × /api/audit/log-event > Database Integrity > maintains data consistency with real database operations 408ms\n     → GET is not a function\n   × /api/audit/log-event > Integration Scenarios > integrates with authentication workflow 398ms\n     → GET is not a function\n   × /api/audit/log-event > Compliance > meets API standards with proper authentication 373ms\n     → GET is not a function\n   × /api/audit/log-event > Edge Cases > handles malformed JSON appropriately 396ms\n     → expected 200 to be greater than or equal to 400\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts (10 tests | 9 failed) 2781ms\n   × /api/rules/validate-allocation > Core Functionality > handles GET requests with valid authentication 512ms\n     → GET is not a function\n   × /api/rules/validate-allocation > Core Functionality > handles POST requests with valid data 383ms\n     → expected 400 to be less than 300\n   × /api/rules/validate-allocation > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/rules/validate-allocation > Security > requires valid JWT authentication 1ms\n     → GET is not a function\n   × /api/rules/validate-allocation > Security > validates JWT signature integrity 1ms\n     → GET is not a function\n   × /api/rules/validate-allocation > Performance > responds within acceptable time with real authentication 396ms\n     → GET is not a function\n   × /api/rules/validate-allocation > Database Integrity > maintains data consistency with real database operations 380ms\n     → GET is not a function\n   × /api/rules/validate-allocation > Integration Scenarios > integrates with authentication workflow 366ms\n     → GET is not a function\n   × /api/rules/validate-allocation > Compliance > meets API standards with proper authentication 358ms\n     → GET is not a function\n   ✓ /api/rules/validate-allocation > Edge Cases > handles malformed JSON appropriately  380ms\n ❯ tests/api/debug-user/debug-user.test.ts (10 tests | 4 failed) 2886ms\n   × /api/debug-user > Core Functionality > handles GET requests with valid authentication 526ms\n     → expected 400 to be less than 300\n   × /api/debug-user > Core Functionality > handles POST requests with valid data 395ms\n     → POST is not a function\n   × /api/debug-user > Error States > returns proper error for unauthenticated requests 1ms\n     → POST is not a function\n   ✓ /api/debug-user > Security > requires valid JWT authentication 0ms\n   ✓ /api/debug-user > Security > validates JWT signature integrity 1ms\n   ✓ /api/debug-user > Performance > responds within acceptable time with real authentication  402ms\n   ✓ /api/debug-user > Database Integrity > maintains data consistency with real database operations  390ms\n   ✓ /api/debug-user > Integration Scenarios > integrates with authentication workflow  386ms\n   ✓ /api/debug-user > Compliance > meets API standards with proper authentication  393ms\n   × /api/debug-user > Edge Cases > handles malformed JSON appropriately 391ms\n     → POST is not a function\n ❯ tests/api/auth/register/register.test.ts (10 tests | 1 failed) 2845ms\n   ✓ /api/auth > Core Functionality > handles authenticated requests with real JWT tokens  539ms\n   × /api/auth > Core Functionality > handles POST requests with valid data 372ms\n     → expected 400 to be less than 300\n   ✓ /api/auth > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/auth > Security > requires valid JWT authentication 0ms\n   ✓ /api/auth > Security > validates JWT signature integrity 1ms\n   ✓ /api/auth > Performance > responds within acceptable time with real authentication  419ms\n   ✓ /api/auth > Database Integrity > maintains data consistency with real database operations  385ms\n   ✓ /api/auth > Integration Scenarios > integrates with authentication workflow  360ms\n   ✓ /api/auth > Compliance > meets API standards with proper authentication  385ms\n   ✓ /api/auth > Edge Cases > handles malformed requests appropriately  381ms\n ❯ tests/api/auth/login/login.test.ts (10 tests | 1 failed) 2790ms\n   ✓ /api/auth > Core Functionality > handles authenticated requests with real JWT tokens  546ms\n   × /api/auth > Core Functionality > handles POST requests with valid data 390ms\n     → expected 400 to be less than 300\n   ✓ /api/auth > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/auth > Security > requires valid JWT authentication 0ms\n   ✓ /api/auth > Security > validates JWT signature integrity 0ms\n   ✓ /api/auth > Performance > responds within acceptable time with real authentication  372ms\n   ✓ /api/auth > Database Integrity > maintains data consistency with real database operations  381ms\n   ✓ /api/auth > Integration Scenarios > integrates with authentication workflow  350ms\n   ✓ /api/auth > Compliance > meets API standards with proper authentication  378ms\n   ✓ /api/auth > Edge Cases > handles malformed requests appropriately  369ms\n ❯ tests/api/auth/google/google.test.ts (10 tests | 6 failed) 2908ms\n   × /api/auth/google > Core Functionality > handles GET requests with valid authentication 539ms\n     → expected 307 to be less than 300\n   × /api/auth/google > Core Functionality > handles POST requests with valid data 398ms\n     → POST is not a function\n   × /api/auth/google > Error States > returns proper error for unauthenticated requests 1ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google > Security > requires valid JWT authentication 1ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google > Security > validates JWT signature integrity 1ms\n     → expected 307 to be greater than or equal to 400\n   ✓ /api/auth/google > Performance > responds within acceptable time with real authentication  411ms\n   ✓ /api/auth/google > Database Integrity > maintains data consistency with real database operations  389ms\n   ✓ /api/auth/google > Integration Scenarios > integrates with authentication workflow  376ms\n   ✓ /api/auth/google > Compliance > meets API standards with proper authentication  396ms\n   × /api/auth/google > Edge Cases > handles malformed JSON appropriately 394ms\n     → POST is not a function\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Core Functionality > handles POST requests with valid data\n=== CONSENT SIGNATURE API HIT ===\n\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Core Functionality > handles POST requests with valid data\nSession check: {\n  isAuthenticated: \u001b[33mtrue\u001b[39m,\n  userId: \u001b[32m'84ef1c35-bc02-406c-b27b-d8e34d7d5f6e'\u001b[39m\n}\n\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately\n=== CONSENT SIGNATURE API HIT ===\n\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately\nSession check: {\n  isAuthenticated: \u001b[33mtrue\u001b[39m,\n  userId: \u001b[32m'1b2c4e75-34cb-4785-9904-10fb1d2bc383'\u001b[39m\n}\n\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts (10 tests | 9 failed) 2969ms\n   × /api/onboarding/consent-signature > Core Functionality > handles GET requests with valid authentication 572ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Core Functionality > handles POST requests with valid data 390ms\n     → expected 400 to be less than 300\n   × /api/onboarding/consent-signature > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Security > requires valid JWT authentication 0ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Security > validates JWT signature integrity 0ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Performance > responds within acceptable time with real authentication 395ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Database Integrity > maintains data consistency with real database operations 411ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Integration Scenarios > integrates with authentication workflow 405ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Compliance > meets API standards with proper authentication 389ms\n     → GET is not a function\n   ✓ /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately  403ms\n ❯ tests/api/stripe/webhook/webhook.test.ts (9 tests | 1 failed) 2466ms\n   × /api/stripe/webhook > Core Functionality > handles POST requests with valid data 514ms\n     → expected 400 to be less than 300\n   ✓ /api/stripe/webhook > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/stripe/webhook > Security > requires valid JWT authentication 0ms\n   ✓ /api/stripe/webhook > Security > validates JWT signature integrity 0ms\n   ✓ /api/stripe/webhook > Performance > responds within acceptable time with real authentication  399ms\n   ✓ /api/stripe/webhook > Database Integrity > maintains data consistency with real database operations  411ms\n   ✓ /api/stripe/webhook > Integration Scenarios > integrates with authentication workflow  386ms\n   ✓ /api/stripe/webhook > Compliance > meets API standards with proper authentication  349ms\n   ✓ /api/stripe/webhook > Edge Cases > handles malformed JSON appropriately  403ms\n ❯ tests/api/documents/requirements/[type]/[type].test.ts (10 tests | 3 failed) 2532ms\n   ✓ /api/documents/requirements/[type] > Core Functionality > handles GET requests with valid authentication  549ms\n   ✓ /api/documents/requirements/[type] > Core Functionality > returns consistent response format  398ms\n   × /api/documents/requirements/[type] > Error States > returns proper error for unauthenticated requests 3ms\n     → expected 200 to be greater than or equal to 400\n   × /api/documents/requirements/[type] > Security > requires valid JWT authentication 1ms\n     → expected 200 to be greater than or equal to 400\n   × /api/documents/requirements/[type] > Security > validates JWT signature integrity 1ms\n     → expected 200 to be greater than or equal to 400\n   ✓ /api/documents/requirements/[type] > Performance > responds within acceptable time with real authentication  396ms\n   ✓ /api/documents/requirements/[type] > Database Integrity > maintains data consistency with real database operations  414ms\n   ✓ /api/documents/requirements/[type] > Integration Scenarios > integrates with authentication workflow  378ms\n   ✓ /api/documents/requirements/[type] > Compliance > meets API standards with proper authentication  388ms\n   ✓ /api/documents/requirements/[type] > Edge Cases > handles edge cases appropriately 1ms\n ❯ tests/api/assets/categories/categories.test.ts (10 tests | 1 failed) 2488ms\n   ✓ /api/assets/categories > Core Functionality > handles GET requests with valid authentication  535ms\n   ✓ /api/assets/categories > Core Functionality > returns consistent response format  399ms\n   ✓ /api/assets/categories > Error States > returns proper error for unauthenticated requests 2ms\n   ✓ /api/assets/categories > Security > requires valid JWT authentication 0ms\n   ✓ /api/assets/categories > Security > validates JWT signature integrity 1ms\n   ✓ /api/assets/categories > Performance > responds within acceptable time with real authentication  405ms\n   ✓ /api/assets/categories > Database Integrity > maintains data consistency with real database operations  384ms\n   ✓ /api/assets/categories > Integration Scenarios > integrates with authentication workflow  356ms\n   ✓ /api/assets/categories > Compliance > meets API standards with proper authentication  402ms\n   × /api/assets/categories > Edge Cases > handles edge cases appropriately 3ms\n     → expected 500 to be less than 500\n ❯ tests/api/auth/logout/logout.test.ts (10 tests | 9 failed) 2904ms\n   × /api/auth/logout > Core Functionality > handles GET requests with valid authentication 554ms\n     → GET is not a function\n   ✓ /api/auth/logout > Core Functionality > handles POST requests with valid data  370ms\n   × /api/auth/logout > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/auth/logout > Security > requires valid JWT authentication 0ms\n     → GET is not a function\n   × /api/auth/logout > Security > validates JWT signature integrity 0ms\n     → GET is not a function\n   × /api/auth/logout > Performance > responds within acceptable time with real authentication 398ms\n     → GET is not a function\n   × /api/auth/logout > Database Integrity > maintains data consistency with real database operations 408ms\n     → GET is not a function\n   × /api/auth/logout > Integration Scenarios > integrates with authentication workflow 380ms\n     → GET is not a function\n   × /api/auth/logout > Compliance > meets API standards with proper authentication 390ms\n     → GET is not a function\n   × /api/auth/logout > Edge Cases > handles malformed JSON appropriately 398ms\n     → expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/refresh/refresh.test.ts (10 tests | 1 failed) 3010ms\n   ✓ /api/auth > Core Functionality > handles authenticated requests with real JWT tokens  574ms\n   × /api/auth > Core Functionality > handles POST requests with valid data 397ms\n     → expected 401 to be less than 300\n   ✓ /api/auth > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/auth > Security > requires valid JWT authentication 0ms\n   ✓ /api/auth > Security > validates JWT signature integrity 0ms\n   ✓ /api/auth > Performance > responds within acceptable time with real authentication  433ms\n   ✓ /api/auth > Database Integrity > maintains data consistency with real database operations  405ms\n   ✓ /api/auth > Integration Scenarios > integrates with authentication workflow  399ms\n   ✓ /api/auth > Compliance > meets API standards with proper authentication  402ms\n   ✓ /api/auth > Edge Cases > handles malformed requests appropriately  397ms\n ❯ tests/api/beneficiaries/photo/photo.test.ts (10 tests | 9 failed) 2886ms\n   × /api/beneficiaries/photo > Core Functionality > handles GET requests with valid authentication 556ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Core Functionality > handles POST requests with valid data 398ms\n     → expected 500 to be less than 300\n   × /api/beneficiaries/photo > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Security > requires valid JWT authentication 1ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Security > validates JWT signature integrity 1ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Performance > responds within acceptable time with real authentication 403ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Database Integrity > maintains data consistency with real database operations 400ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Integration Scenarios > integrates with authentication workflow 370ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Compliance > meets API standards with proper authentication 403ms\n     → GET is not a function\n   ✓ /api/beneficiaries/photo > Edge Cases > handles malformed JSON appropriately  351ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Core Functionality > handles POST requests with valid authentication\nOnboarding step 0 completed for user d29ec63d-b6f5-45f1-9186-fa4ec71c9122\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Core Functionality > saves step completion data correctly\nOnboarding step 1 completed for user fe57693e-8fa2-4346-af48-11d262b6c4b9\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Core Functionality > handles final step completion\nOnboarding step 3 completed for user a320eb8b-0820-4498-9dd8-c8d2e42200c9\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Security > prevents data injection through step data\nOnboarding step 0 completed for user 824db65f-bd2a-42be-838f-645298fe1ef4\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Performance > responds within acceptable time with real authentication\nOnboarding step 1 completed for user 9703fafe-52d5-4201-b32f-b0f07a1d27bc\n\n ✓ tests/api/will/will.test.ts (10 tests) 3667ms\n   ✓ /api/will > Core Functionality > handles GET requests with valid authentication  738ms\n   ✓ /api/will > Core Functionality > handles POST requests with valid data  530ms\n   ✓ /api/will > Performance > responds within acceptable time with real authentication  490ms\n   ✓ /api/will > Database Integrity > maintains data consistency with real database operations  533ms\n   ✓ /api/will > Integration Scenarios > integrates with authentication workflow  532ms\n   ✓ /api/will > Compliance > meets API standards with proper authentication  463ms\n   ✓ /api/will > Edge Cases > handles malformed JSON appropriately  375ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Performance > handles concurrent requests efficiently\nOnboarding step 0 completed for user 8e9a12ad-7abe-41eb-8283-15adcc0fc7e7\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Performance > handles concurrent requests efficiently\nOnboarding step 2 completed for user 8e9a12ad-7abe-41eb-8283-15adcc0fc7e7\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Performance > handles concurrent requests efficiently\nOnboarding step 1 completed for user 8e9a12ad-7abe-41eb-8283-15adcc0fc7e7\n\n ✓ tests/api/assets/[id]/[id].test.ts (11 tests) 4200ms\n   ✓ /api/assets/[id] > Core Functionality > handles GET requests with valid authentication  736ms\n   ✓ /api/assets/[id] > Core Functionality > handles PUT requests with valid data  614ms\n   ✓ /api/assets/[id] > Core Functionality > handles DELETE requests with authentication  632ms\n   ✓ /api/assets/[id] > Performance > responds within acceptable time with real authentication  582ms\n   ✓ /api/assets/[id] > Database Integrity > maintains data consistency with real database operations  541ms\n   ✓ /api/assets/[id] > Integration Scenarios > integrates with authentication workflow  557ms\n   ✓ /api/assets/[id] > Compliance > meets API standards with proper authentication  532ms\n ✓ tests/api/beneficiaries/[id]/[id].test.ts (11 tests) 4187ms\n   ✓ /api/beneficiaries/[id] > Core Functionality > handles GET requests with valid authentication  737ms\n   ✓ /api/beneficiaries/[id] > Core Functionality > handles PUT requests with valid data  587ms\n   ✓ /api/beneficiaries/[id] > Core Functionality > handles DELETE requests with authentication  608ms\n   ✓ /api/beneficiaries/[id] > Performance > responds within acceptable time with real authentication  575ms\n   ✓ /api/beneficiaries/[id] > Database Integrity > maintains data consistency with real database operations  574ms\n   ✓ /api/beneficiaries/[id] > Integration Scenarios > integrates with authentication workflow  555ms\n   ✓ /api/beneficiaries/[id] > Compliance > meets API standards with proper authentication  546ms\n ✓ tests/api/onboarding/legal-consent/legal-consent.test.ts (12 tests) 4501ms\n   ✓ /api/onboarding/legal-consent > Core Functionality > handles GET requests with authentication  603ms\n   ✓ /api/onboarding/legal-consent > Core Functionality > handles POST requests with valid consent data  460ms\n   ✓ /api/onboarding/legal-consent > Core Functionality > returns user's consent data correctly  460ms\n   ✓ /api/onboarding/legal-consent > Error States > validates required consent fields  396ms\n   ✓ /api/onboarding/legal-consent > Error States > validates consent data format  392ms\n   ✓ /api/onboarding/legal-consent > Security > handles malicious consent data safely  479ms\n   ✓ /api/onboarding/legal-consent > Security > stores IP address and user agent for audit trail  441ms\n   ✓ /api/onboarding/legal-consent > Performance & Edge Cases > responds within acceptable time  414ms\n   ✓ /api/onboarding/legal-consent > Performance & Edge Cases > handles concurrent requests safely  561ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Database Integrity > maintains user data consistency with real database operations\nOnboarding step 0 completed for user b9fe1373-d552-4850-a256-a82d622b81d8\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Database Integrity > creates proper audit trail for step completions\nOnboarding step 2 completed for user c9b28b8f-19ae-4380-b3bb-560f5eb00427\n\n ✓ tests/api/auth/session/session.test.ts (21 tests) 5644ms\n   ✓ /api/auth/session > Core Functionality > handles GET requests with valid session  554ms\n   ✓ /api/auth/session > Core Functionality > returns user session data correctly  410ms\n   ✓ /api/auth/session > Security > prevents session fixation attacks  418ms\n   ✓ /api/auth/session > Performance > responds within acceptable time with real authentication  427ms\n   ✓ /api/auth/session > Performance > handles concurrent authenticated requests efficiently  408ms\n   ✓ /api/auth/session > Database Integrity > maintains user data consistency with real database queries  411ms\n   ✓ /api/auth/session > Integration Scenarios > integrates with onboarding status workflow  402ms\n   ✓ /api/auth/session > Integration Scenarios > provides complete user context for authenticated requests  350ms\n   ✓ /api/auth/session > Compliance > meets API standards with proper authentication  378ms\n   ✓ /api/auth/session > Compliance > follows REST API conventions  377ms\n   ✓ /api/auth/session > Edge Cases > handles users with incomplete profile data  371ms\n   ✓ /api/auth/session > Token Management > validates access token structure and claims  367ms\n   ✓ /api/auth/session > Token Management > handles refresh token scenarios appropriately  392ms\n   ✓ /api/auth/session > Token Management > maintains session consistency across requests  372ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Integration Scenarios > integrates with onboarding progression workflow\nOnboarding step 0 completed for user 1947a887-a907-454e-8690-20916b8cbf81\n\n ✓ tests/api/test-db/test-db.test.ts (12 tests) 9ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Integration Scenarios > handles step progression through onboarding flow\nOnboarding step 1 completed for user 786b47d6-d4d8-4543-b208-28d99525fc3e\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Integration Scenarios > handles step progression through onboarding flow\nOnboarding step 2 completed for user 786b47d6-d4d8-4543-b208-28d99525fc3e\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Integration Scenarios > handles step progression through onboarding flow\nOnboarding step 3 completed for user 786b47d6-d4d8-4543-b208-28d99525fc3e\n\n ✓ tests/api/health/health.test.ts (12 tests) 8ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Compliance > meets API standards with proper authentication\nOnboarding step 1 completed for user 707aae2a-3454-46f0-841a-21383cbd4979\n\n ✓ tests/api/onboarding/verification/sync/sync.test.ts (10 tests) 2707ms\n   ✓ /api/onboarding/verification/sync > Core Functionality > handles GET requests with valid authentication  567ms\n   ✓ /api/onboarding/verification/sync > Core Functionality > handles POST requests with valid data  422ms\n   ✓ /api/onboarding/verification/sync > Performance > responds within acceptable time with real authentication  435ms\n   ✓ /api/onboarding/verification/sync > Database Integrity > maintains data consistency with real database operations  422ms\n   ✓ /api/onboarding/verification/sync > Integration Scenarios > integrates with authentication workflow  410ms\n   ✓ /api/onboarding/verification/sync > Compliance > meets API standards with proper authentication  446ms\n ✓ tests/api/documents/[id]/[id].test.ts (10 tests) 2422ms\n   ✓ /api/documents/[id] > Core Functionality > handles GET requests with valid authentication  506ms\n   ✓ /api/documents/[id] > Core Functionality > handles DELETE requests with authentication  387ms\n   ✓ /api/documents/[id] > Performance > responds within acceptable time with real authentication  386ms\n   ✓ /api/documents/[id] > Database Integrity > maintains data consistency with real database operations  364ms\n   ✓ /api/documents/[id] > Integration Scenarios > integrates with authentication workflow  386ms\n   ✓ /api/documents/[id] > Compliance > meets API standards with proper authentication  389ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Compliance > follows REST API conventions\nOnboarding step 0 completed for user 30c8079f-01d2-47fb-ad2f-b5bfbd9fda87\n\n ✓ tests/api/assets/[id]/documents/documents.test.ts (9 tests) 2336ms\n   ✓ /api/assets/[id]/documents > Core Functionality > handles GET requests with valid authentication  611ms\n   ✓ /api/assets/[id]/documents > Performance > responds within acceptable time with real authentication  412ms\n   ✓ /api/assets/[id]/documents > Database Integrity > maintains data consistency with real database operations  420ms\n   ✓ /api/assets/[id]/documents > Integration Scenarios > integrates with authentication workflow  447ms\n   ✓ /api/assets/[id]/documents > Compliance > meets API standards with proper authentication  441ms\n ✓ tests/api/onboarding/status/status.test.ts (10 tests) 2799ms\n   ✓ /api/onboarding/status > Core Functionality > handles GET requests with valid authentication  531ms\n   ✓ /api/onboarding/status > Core Functionality > returns consistent onboarding status data  378ms\n   ✓ /api/onboarding/status > Performance > responds within acceptable time with real authentication  375ms\n   ✓ /api/onboarding/status > Database Integrity > maintains data consistency with real database operations  384ms\n   ✓ /api/onboarding/status > Integration Scenarios > integrates with authentication workflow  387ms\n   ✓ /api/onboarding/status > Compliance > meets API standards with proper authentication  358ms\n   ✓ /api/onboarding/status > Edge Cases > handles edge cases appropriately  382ms\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Edge Cases > handles null data for non-personal info steps\nOnboarding step 1 completed for user e41c82d4-7205-443a-8ba2-8804e1413ec8\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Token Management > validates access token structure and claims\nOnboarding step 1 completed for user e255d870-ee6b-4f7f-a7e8-04ea6d416e67\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Token Management > maintains session consistency across step saves\nOnboarding step 2 completed for user d3082674-4f30-469d-969c-9cab9d5d7b31\n\nstdout | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Token Management > maintains session consistency across step saves\nOnboarding step 1 completed for user d3082674-4f30-469d-969c-9cab9d5d7b31\n\n ✓ tests/api/onboarding/save-step/save-step.test.ts (23 tests) 9863ms\n   ✓ /api/onboarding/save-step > Core Functionality > handles POST requests with valid authentication  702ms\n   ✓ /api/onboarding/save-step > Core Functionality > saves step completion data correctly  555ms\n   ✓ /api/onboarding/save-step > Core Functionality > handles final step completion  540ms\n   ✓ /api/onboarding/save-step > Error States > validates step number range  395ms\n   ✓ /api/onboarding/save-step > Error States > validates step number type  403ms\n   ✓ /api/onboarding/save-step > Security > prevents data injection through step data  539ms\n   ✓ /api/onboarding/save-step > Performance > responds within acceptable time with real authentication  532ms\n   ✓ /api/onboarding/save-step > Performance > handles concurrent requests efficiently  682ms\n   ✓ /api/onboarding/save-step > Database Integrity > maintains user data consistency with real database operations  503ms\n   ✓ /api/onboarding/save-step > Database Integrity > creates proper audit trail for step completions  509ms\n   ✓ /api/onboarding/save-step > Integration Scenarios > integrates with onboarding progression workflow  514ms\n   ✓ /api/onboarding/save-step > Integration Scenarios > handles step progression through onboarding flow  777ms\n   ✓ /api/onboarding/save-step > Compliance > meets API standards with proper authentication  510ms\n   ✓ /api/onboarding/save-step > Compliance > follows REST API conventions  516ms\n   ✓ /api/onboarding/save-step > Edge Cases > handles requests with malformed JSON  359ms\n   ✓ /api/onboarding/save-step > Edge Cases > handles requests with missing step parameter  341ms\n   ✓ /api/onboarding/save-step > Edge Cases > handles null data for non-personal info steps  466ms\n   ✓ /api/onboarding/save-step > Token Management > validates access token structure and claims  501ms\n   ✓ /api/onboarding/save-step > Token Management > maintains session consistency across step saves  510ms\n ✓ tests/api/assets/assets.test.ts (21 tests) 11398ms\n   ✓ /api/assets > Core Functionality > handles GET requests to retrieve user assets  915ms\n   ✓ /api/assets > Core Functionality > handles POST requests to create new assets  539ms\n   ✓ /api/assets > Error States > returns 400 for POST with missing required fields  422ms\n   ✓ /api/assets > Error States > handles database errors gracefully  434ms\n   ✓ /api/assets > Security > prevents access to other users' assets  617ms\n   ✓ /api/assets > Security > validates asset type enum values  401ms\n   ✓ /api/assets > Security > prevents XSS in asset metadata  425ms\n   ✓ /api/assets > Performance > responds within acceptable time for asset retrieval  1651ms\n   ✓ /api/assets > Performance > handles concurrent asset creation efficiently  659ms\n   ✓ /api/assets > Database Integrity > maintains asset-user relationship integrity  502ms\n   ✓ /api/assets > Database Integrity > handles asset metadata JSON storage correctly  472ms\n   ✓ /api/assets > Integration Scenarios > integrates with asset categorization system  813ms\n   ✓ /api/assets > Integration Scenarios > supports asset valuation workflow  459ms\n   ✓ /api/assets > Compliance > meets API standards for asset management  551ms\n   ✓ /api/assets > Compliance > follows REST API conventions for assets  660ms\n   ✓ /api/assets > Edge Cases > handles assets with zero value  471ms\n   ✓ /api/assets > Edge Cases > handles very long asset names  409ms\n   ✓ /api/assets > Edge Cases > handles empty asset lists gracefully  556ms\n   ✓ /api/assets > Edge Cases > handles unicode characters in asset names  435ms\n\n Test Files  26 failed | 13 passed (39)\n      Tests  99 failed | 348 passed (447)\n   Start at  19:46:17\n   Duration  29.80s (transform 674ms, setup 9.20s, collect 15.63s, tests 140.78s, environment 10.62s, prepare 2.50s)\n\nstderr | tests/api/onboarding/signature/signature.test.ts > /api/onboarding > Edge Cases > handles malformed requests appropriately\nSignature save error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/signature/route.ts:74:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/signature/signature.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/beneficiaries/beneficiaries.test.ts > /api/beneficiaries > Edge Cases > handles malformed requests appropriately\nError creating beneficiary: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/beneficiaries/route.ts:107:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/beneficiaries/beneficiaries.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/rules.test.ts > /api/rules > Edge Cases > handles malformed JSON appropriately\nError creating rule: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/route.ts:130:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/rules.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles GET requests with valid authentication\nError fetching rule: DrizzleQueryError: Failed query: select \"id\", \"user_id\", \"name\", \"description\", \"rule_definition\", \"priority\", \"is_active\", \"created_at\", \"updated_at\" from \"inheritance_rules\" where (\"inheritance_rules\".\"id\" = $1 and \"inheritance_rules\".\"user_id\" = $2)\nparams: test-id-123,\n    at PostgresJsPreparedQuery.queryWithCache \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/pg-core/session.ts:73:11\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/postgres-js/session.ts:58:17\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:54:20\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:27:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20 {\n  query: \u001b[32m'select \"id\", \"user_id\", \"name\", \"description\", \"rule_definition\", \"priority\", \"is_active\", \"created_at\", \"updated_at\" from \"inheritance_rules\" where (\"inheritance_rules\".\"id\" = $1 and \"inheritance_rules\".\"user_id\" = $2)'\u001b[39m,\n  params: [ \u001b[32m'test-id-123'\u001b[39m, \u001b[90mundefined\u001b[39m ],\n  cause: Error: UNDEFINED_VALUE: Undefined values are not allowed\n      at handleValue \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/types.js:83:20\u001b[90m)\u001b[39m\n      at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:225:38\n      at Array.forEach (<anonymous>)\n      at build \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:225:25\u001b[90m)\u001b[39m\n      at Object.execute \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:167:7\u001b[90m)\u001b[39m\n      at go \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/index.js:345:14\u001b[90m)\u001b[39m\n      at Query.handler \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/index.js:334:14\u001b[90m)\u001b[39m\n      at Query.handle \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/query.js:140:65\u001b[90m)\u001b[39m\n  \u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m {\n    code: \u001b[32m'UNDEFINED_VALUE'\u001b[39m\n  }\n}\n\nstderr | tests/api/onboarding/photo/photo.test.ts > /api/onboarding > Core Functionality > handles POST requests with valid data\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/photo/photo.test.ts:52:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles PUT requests with valid data\nError updating rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.PUT \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:108:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:43:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles DELETE requests with authentication\nError deleting rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.DELETE \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:267:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:52:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Error States > returns proper error for unauthenticated requests\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:64:27\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Security > requires valid JWT authentication\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:74:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Security > validates JWT signature integrity\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:87:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Performance > responds within acceptable time with real authentication\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:99:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Database Integrity > maintains data consistency with real database operations\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:112:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Integration Scenarios > integrates with authentication workflow\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:123:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/photo/photo.test.ts > /api/onboarding > Edge Cases > handles malformed requests appropriately\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/photo/photo.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Compliance > meets API standards with proper authentication\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:134:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles requests with malformed JSON\nPersonal info save error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/personal-info/route.ts:184:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/personal-info/personal-info.test.ts:412:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Core Functionality > handles POST requests with valid data\nAudit logging error: DrizzleQueryError: Failed query: insert into \"audit_events\" (\"id\", \"user_id\", \"event_type\", \"event_action\", \"resource_type\", \"resource_id\", \"event_data\", \"old_data\", \"new_data\", \"ip_address\", \"user_agent\", \"session_id\", \"event_time\") values (default, $1, default, default, default, default, $2, default, default, $3, $4, default, default)\nparams: 464dd8af-e074-46e3-87cc-411d8a5a869a,{},unknown,unknown\n    at PostgresJsPreparedQuery.queryWithCache \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/pg-core/session.ts:73:11\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/audit/log-event/route.ts:33:5\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/audit/log-event/log-event.test.ts:42:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20 {\n  query: \u001b[32m'insert into \"audit_events\" (\"id\", \"user_id\", \"event_type\", \"event_action\", \"resource_type\", \"resource_id\", \"event_data\", \"old_data\", \"new_data\", \"ip_address\", \"user_agent\", \"session_id\", \"event_time\") values (default, $1, default, default, default, default, $2, default, default, $3, $4, default, default)'\u001b[39m,\n  params: [\n    \u001b[32m'464dd8af-e074-46e3-87cc-411d8a5a869a'\u001b[39m,\n    \u001b[32m'{}'\u001b[39m,\n    \u001b[32m'unknown'\u001b[39m,\n    \u001b[32m'unknown'\u001b[39m\n  ],\n  cause: PostgresError: null value in column \"event_type\" of relation \"audit_events\" violates not-null constraint\n      at ErrorResponse \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:794:26\u001b[90m)\u001b[39m\n      at handle \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:480:6\u001b[90m)\u001b[39m\n      at Socket.data \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:315:9\u001b[90m)\u001b[39m\n  \u001b[90m    at Socket.emit (node:events:507:28)\u001b[39m\n  \u001b[90m    at addChunk (node:internal/streams/readable:559:12)\u001b[39m\n  \u001b[90m    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\u001b[39m\n  \u001b[90m    at Socket.Readable.push (node:internal/streams/readable:390:5)\u001b[39m\n  \u001b[90m    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)\u001b[39m {\n    severity_local: \u001b[32m'ERROR'\u001b[39m,\n    severity: \u001b[32m'ERROR'\u001b[39m,\n    code: \u001b[32m'23502'\u001b[39m,\n    detail: \u001b[32m'Failing row contains (a729de44-3e03-4eee-b254-757748d1e68a, 464dd8af-e074-46e3-87cc-411d8a5a869a, null, null, null, null, {}, null, null, unknown, unknown, null, 2025-09-04 18:46:28.561883).'\u001b[39m,\n    schema_name: \u001b[32m'public'\u001b[39m,\n    table_name: \u001b[32m'audit_events'\u001b[39m,\n    column_name: \u001b[32m'event_type'\u001b[39m,\n    file: \u001b[32m'execMain.c'\u001b[39m,\n    line: \u001b[32m'1982'\u001b[39m,\n    routine: \u001b[32m'ExecConstraints'\u001b[39m\n  }\n}\n\nstderr | tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Edge Cases > handles malformed JSON appropriately\nAudit logging error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/audit/log-event/route.ts:10:7\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/audit/log-event/log-event.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Edge Cases > handles malformed JSON appropriately\nError validating allocation: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/validate-allocation/route.ts:45:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/validate-allocation/validate-allocation.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/auth/register/register.test.ts > /api/auth > Edge Cases > handles malformed requests appropriately\nRegistration error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at registerHandler \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/auth/register/route.ts:11:54\u001b[90m)\u001b[39m\n    at Module.<anonymous> \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/rate-limit.ts:111:22\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/auth/register/register.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/auth/login/login.test.ts > /api/auth > Edge Cases > handles malformed requests appropriately\nLogin error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at loginHandler \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/auth/login/route.ts:11:33\u001b[90m)\u001b[39m\n    at Module.<anonymous> \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/rate-limit.ts:111:22\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/auth/login/login.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Core Functionality > handles POST requests with valid data\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/beneficiaries/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/beneficiaries/photo/photo.test.ts:42:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately\nConsent signature save error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/consent-signature/route.ts:27:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/consent-signature/consent-signature.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/assets/categories/categories.test.ts > /api/assets/categories > Edge Cases > handles edge cases appropriately\nAsset categories fetch error: TypeError: Cannot read properties of undefined (reading 'isAuthenticated')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/assets/categories/route.ts:16:18\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/assets/categories/categories.test.ts:134:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Edge Cases > handles malformed JSON appropriately\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/beneficiaries/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/beneficiaries/photo/photo.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/test-db/test-db.test.ts > /api/test-db > Error States > handles database failures gracefully\nDatabase connection test failed: Error: Database connection failed\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/test-db/test-db.test.ts:112:23\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:155:11\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:1863:10\u001b[90m)\u001b[39m\n    at runTest \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:1574:12\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at runSuite \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:1729:8\u001b[90m)\u001b[39m\n    at runSuite \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:1729:8\u001b[90m)\u001b[39m\n\nstderr | tests/api/test-db/test-db.test.ts > /api/test-db > Security > validates authentication when required\nDatabase connection test failed: TypeError: Cannot read properties of undefined (reading '0')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/test-db/route.ts:14:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/test-db/test-db.test.ts:144:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/test-db/test-db.test.ts > /api/test-db > Compliance > meets API standards\nDatabase connection test failed: TypeError: Cannot read properties of undefined (reading '0')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/test-db/route.ts:14:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/test-db/test-db.test.ts:223:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/test-db/test-db.test.ts > /api/test-db > Edge Cases > handles empty requests\nDatabase connection test failed: TypeError: Cannot read properties of undefined (reading '0')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/test-db/route.ts:14:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/test-db/test-db.test.ts:236:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/save-step/save-step.test.ts > /api/onboarding/save-step > Edge Cases > handles requests with malformed JSON\nSave step error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/save-step/route.ts:20:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/save-step/save-step.test.ts:383:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\n\n⎯⎯⎯⎯⎯⎯ Failed Tests 99 ⎯⎯⎯⎯⎯⎯⎯\n\n FAIL  tests/api/beneficiaries/beneficiaries.test.ts > /api/beneficiaries > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/beneficiaries/beneficiaries.test.ts:53:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/99]⎯\n\n FAIL  tests/api/debug-user/debug-user.test.ts > /api/debug-user > Core Functionality > handles GET requests with valid authentication\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/debug-user/debug-user.test.ts:28:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/99]⎯\n\n FAIL  tests/api/debug-user/debug-user.test.ts > /api/debug-user > Core Functionality > handles POST requests with valid data\nTypeError: POST is not a function\n ❯ tests/api/debug-user/debug-user.test.ts:42:44\n     40|       }, authContext);\n     41| \n     42|       const response = await routeHandlers.POST(request);\n       |                                            ^\n     43|       \n     44|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/99]⎯\n\n FAIL  tests/api/debug-user/debug-user.test.ts > /api/debug-user > Error States > returns proper error for unauthenticated requests\nTypeError: POST is not a function\n ❯ tests/api/debug-user/debug-user.test.ts:61:48\n     59|         body: JSON.stringify({}),\n     60|       });\n     61|       const postResponse = await routeHandlers.POST(postRequest);\n       |                                                ^\n     62|       expect(postResponse.status).toBeGreaterThanOrEqual(400);\n     63|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/99]⎯\n\n FAIL  tests/api/debug-user/debug-user.test.ts > /api/debug-user > Edge Cases > handles malformed JSON appropriately\nTypeError: POST is not a function\n ❯ tests/api/debug-user/debug-user.test.ts:148:44\n    146|       }, authContext);\n    147| \n    148|       const response = await routeHandlers.POST(request);\n       |                                            ^\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/99]⎯\n\n FAIL  tests/api/rules/rules.test.ts > /api/rules > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/rules/rules.test.ts:44:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/99]⎯\n\n FAIL  tests/api/assets/categories/categories.test.ts > /api/assets/categories > Edge Cases > handles edge cases appropriately\nAssertionError: expected 500 to be less than 500\n ❯ tests/api/assets/categories/categories.test.ts:136:31\n    134|       const response = await routeHandlers.GET(new NextRequest('http:/…\n    135|       expect(response).toBeDefined();\n    136|       expect(response.status).toBeLessThan(500); // Should not crash\n       |                               ^\n    137|     });\n    138|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Core Functionality > handles GET requests with valid authentication\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:26:44\n     24|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n     25| \n     26|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     27|       \n     28|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Error States > returns proper error for unauthenticated requests\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:53:47\n     51|       \n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n       |                                               ^\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n     55|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Security > requires valid JWT authentication\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:71:44\n     69|       \n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n     73|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Security > validates JWT signature integrity\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:84:44\n     82|         }\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n     86|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Performance > responds within acceptable time with real authentication\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:96:44\n     94| \n     95|       const startTime = performance.now();\n     96|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     97|       const responseTime = performance.now() - startTime;\n     98|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Database Integrity > maintains data consistency with real database operations\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:109:44\n    107|       \n    108|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    109|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    110|       \n    111|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Integration Scenarios > integrates with authentication workflow\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:120:44\n    118|       \n    119|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    120|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    121|       \n    122|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Compliance > meets API standards with proper authentication\nTypeError: GET is not a function\n ❯ tests/api/audit/log-event/log-event.test.ts:131:44\n    129|       \n    130|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    131|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    132|       \n    133|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/99]⎯\n\n FAIL  tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Edge Cases > handles malformed JSON appropriately\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/audit/log-event/log-event.test.ts:150:31\n    148|       const response = await routeHandlers.POST(request);\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n    151|     });\n    152|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/99]⎯\n\n FAIL  tests/api/auth/create-test-user/create-test-user.test.ts > /api/auth/create-test-user > Error States > returns proper error for unauthenticated requests\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/create-test-user/create-test-user.test.ts:54:34\n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n       |                                  ^\n     55|       \n     56|       const postRequest = new NextRequest(url, {\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/99]⎯\n\n FAIL  tests/api/auth/create-test-user/create-test-user.test.ts > /api/auth/create-test-user > Security > requires valid JWT authentication\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/create-test-user/create-test-user.test.ts:72:31\n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     73|     });\n     74| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/99]⎯\n\n FAIL  tests/api/auth/create-test-user/create-test-user.test.ts > /api/auth/create-test-user > Security > validates JWT signature integrity\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/create-test-user/create-test-user.test.ts:85:31\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     86|     });\n     87|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/99]⎯\n\n FAIL  tests/api/auth/create-test-user/create-test-user.test.ts > /api/auth/create-test-user > Edge Cases > handles malformed JSON appropriately\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/create-test-user/create-test-user.test.ts:150:31\n    148|       const response = await routeHandlers.POST(request);\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n    151|     });\n    152|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/99]⎯\n\n FAIL  tests/api/auth/google/google.test.ts > /api/auth/google > Core Functionality > handles GET requests with valid authentication\nAssertionError: expected 307 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/auth/google/google.test.ts:28:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/99]⎯\n\n FAIL  tests/api/auth/google/google.test.ts > /api/auth/google > Core Functionality > handles POST requests with valid data\nTypeError: POST is not a function\n ❯ tests/api/auth/google/google.test.ts:42:44\n     40|       }, authContext);\n     41| \n     42|       const response = await routeHandlers.POST(request);\n       |                                            ^\n     43|       \n     44|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/99]⎯\n\n FAIL  tests/api/auth/google/google.test.ts > /api/auth/google > Error States > returns proper error for unauthenticated requests\nAssertionError: expected 307 to be greater than or equal to 400\n ❯ tests/api/auth/google/google.test.ts:54:34\n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n       |                                  ^\n     55|       \n     56|       const postRequest = new NextRequest(url, {\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/99]⎯\n\n FAIL  tests/api/auth/google/google.test.ts > /api/auth/google > Security > requires valid JWT authentication\nAssertionError: expected 307 to be greater than or equal to 400\n ❯ tests/api/auth/google/google.test.ts:72:31\n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     73|     });\n     74| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/99]⎯\n\n FAIL  tests/api/auth/google/google.test.ts > /api/auth/google > Security > validates JWT signature integrity\nAssertionError: expected 307 to be greater than or equal to 400\n ❯ tests/api/auth/google/google.test.ts:85:31\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     86|     });\n     87|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/99]⎯\n\n FAIL  tests/api/auth/google/google.test.ts > /api/auth/google > Edge Cases > handles malformed JSON appropriately\nTypeError: POST is not a function\n ❯ tests/api/auth/google/google.test.ts:148:44\n    146|       }, authContext);\n    147| \n    148|       const response = await routeHandlers.POST(request);\n       |                                            ^\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/99]⎯\n\n FAIL  tests/api/auth/login/login.test.ts > /api/auth > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/auth/login/login.test.ts:53:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Core Functionality > handles GET requests with valid authentication\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:26:44\n     24|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n     25| \n     26|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     27|       \n     28|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Error States > returns proper error for unauthenticated requests\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:53:47\n     51|       \n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n       |                                               ^\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n     55|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Security > requires valid JWT authentication\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:71:44\n     69|       \n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n     73|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Security > validates JWT signature integrity\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:84:44\n     82|         }\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n     86|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Performance > responds within acceptable time with real authentication\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:96:44\n     94| \n     95|       const startTime = performance.now();\n     96|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     97|       const responseTime = performance.now() - startTime;\n     98|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Database Integrity > maintains data consistency with real database operations\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:109:44\n    107|       \n    108|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    109|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    110|       \n    111|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Integration Scenarios > integrates with authentication workflow\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:120:44\n    118|       \n    119|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    120|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    121|       \n    122|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Compliance > meets API standards with proper authentication\nTypeError: GET is not a function\n ❯ tests/api/auth/logout/logout.test.ts:131:44\n    129|       \n    130|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    131|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    132|       \n    133|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/99]⎯\n\n FAIL  tests/api/auth/logout/logout.test.ts > /api/auth/logout > Edge Cases > handles malformed JSON appropriately\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/logout/logout.test.ts:150:31\n    148|       const response = await routeHandlers.POST(request);\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n    151|     });\n    152|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[36/99]⎯\n\n FAIL  tests/api/auth/refresh/refresh.test.ts > /api/auth > Core Functionality > handles POST requests with valid data\nAssertionError: expected 401 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/auth/refresh/refresh.test.ts:53:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[37/99]⎯\n\n FAIL  tests/api/auth/register/register.test.ts > /api/auth > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/auth/register/register.test.ts:53:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[38/99]⎯\n\n FAIL  tests/api/debug/verification/verification.test.ts > /api/debug/verification > Core Functionality > handles POST requests with valid data\nTypeError: POST is not a function\n ❯ tests/api/debug/verification/verification.test.ts:42:44\n     40|       }, authContext);\n     41| \n     42|       const response = await routeHandlers.POST(request);\n       |                                            ^\n     43|       \n     44|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[39/99]⎯\n\n FAIL  tests/api/debug/verification/verification.test.ts > /api/debug/verification > Error States > returns proper error for unauthenticated requests\nTypeError: POST is not a function\n ❯ tests/api/debug/verification/verification.test.ts:61:48\n     59|         body: JSON.stringify({}),\n     60|       });\n     61|       const postResponse = await routeHandlers.POST(postRequest);\n       |                                                ^\n     62|       expect(postResponse.status).toBeGreaterThanOrEqual(400);\n     63|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[40/99]⎯\n\n FAIL  tests/api/debug/verification/verification.test.ts > /api/debug/verification > Edge Cases > handles malformed JSON appropriately\nTypeError: POST is not a function\n ❯ tests/api/debug/verification/verification.test.ts:148:44\n    146|       }, authContext);\n    147| \n    148|       const response = await routeHandlers.POST(request);\n       |                                            ^\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[41/99]⎯\n\n FAIL  tests/api/beneficiaries/count/count.test.ts > /api/beneficiaries/count > Edge Cases > handles edge cases appropriately\nAssertionError: expected 500 to be less than 500\n ❯ tests/api/beneficiaries/count/count.test.ts:136:31\n    134|       const response = await routeHandlers.GET(new NextRequest('http:/…\n    135|       expect(response).toBeDefined();\n    136|       expect(response.status).toBeLessThan(500); // Should not crash\n       |                               ^\n    137|     });\n    138|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[42/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Core Functionality > handles GET requests with valid authentication\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:26:44\n     24|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n     25| \n     26|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     27|       \n     28|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[43/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Core Functionality > handles POST requests with valid data\nAssertionError: expected 500 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/beneficiaries/photo/photo.test.ts:44:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[44/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Error States > returns proper error for unauthenticated requests\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:53:47\n     51|       \n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n       |                                               ^\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n     55|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[45/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Security > requires valid JWT authentication\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:71:44\n     69|       \n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n     73|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[46/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Security > validates JWT signature integrity\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:84:44\n     82|         }\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n     86|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[47/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Performance > responds within acceptable time with real authentication\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:96:44\n     94| \n     95|       const startTime = performance.now();\n     96|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     97|       const responseTime = performance.now() - startTime;\n     98|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[48/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Database Integrity > maintains data consistency with real database operations\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:109:44\n    107|       \n    108|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    109|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    110|       \n    111|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[49/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Integration Scenarios > integrates with authentication workflow\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:120:44\n    118|       \n    119|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    120|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    121|       \n    122|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[50/99]⎯\n\n FAIL  tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Compliance > meets API standards with proper authentication\nTypeError: GET is not a function\n ❯ tests/api/beneficiaries/photo/photo.test.ts:131:44\n    129|       \n    130|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    131|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    132|       \n    133|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[51/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Core Functionality > handles GET requests with valid authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:26:44\n     24|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n     25| \n     26|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     27|       \n     28|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[52/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Error States > returns proper error for unauthenticated requests\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:53:47\n     51|       \n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n       |                                               ^\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n     55|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[53/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Security > requires valid JWT authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:71:44\n     69|       \n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n     73|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[54/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Security > validates JWT signature integrity\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:84:44\n     82|         }\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n     86|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[55/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Performance > responds within acceptable time with real authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:96:44\n     94| \n     95|       const startTime = performance.now();\n     96|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     97|       const responseTime = performance.now() - startTime;\n     98|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[56/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Database Integrity > maintains data consistency with real database operations\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:109:44\n    107|       \n    108|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    109|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    110|       \n    111|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[57/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Integration Scenarios > integrates with authentication workflow\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:120:44\n    118|       \n    119|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    120|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    121|       \n    122|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[58/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Compliance > meets API standards with proper authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/complete/complete.test.ts:131:44\n    129|       \n    130|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    131|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    132|       \n    133|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[59/99]⎯\n\n FAIL  tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Edge Cases > handles malformed JSON appropriately\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/onboarding/complete/complete.test.ts:150:31\n    148|       const response = await routeHandlers.POST(request);\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n    151|     });\n    152|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[60/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Core Functionality > handles GET requests with valid authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:26:44\n     24|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n     25| \n     26|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     27|       \n     28|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[61/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:44:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[62/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Error States > returns proper error for unauthenticated requests\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:53:47\n     51|       \n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n       |                                               ^\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n     55|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[63/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Security > requires valid JWT authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:71:44\n     69|       \n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n     73|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[64/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Security > validates JWT signature integrity\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:84:44\n     82|         }\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n     86|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[65/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Performance > responds within acceptable time with real authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:96:44\n     94| \n     95|       const startTime = performance.now();\n     96|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     97|       const responseTime = performance.now() - startTime;\n     98|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[66/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Database Integrity > maintains data consistency with real database operations\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:109:44\n    107|       \n    108|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    109|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    110|       \n    111|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[67/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Integration Scenarios > integrates with authentication workflow\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:120:44\n    118|       \n    119|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    120|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    121|       \n    122|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[68/99]⎯\n\n FAIL  tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Compliance > meets API standards with proper authentication\nTypeError: GET is not a function\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts:131:44\n    129|       \n    130|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    131|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    132|       \n    133|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[69/99]⎯\n\n FAIL  tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Security > prevents OAuth email tampering\nError: Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: face3ad7-6573-4351-b88b-73a98263f60e,original@example.com,Test,User,true,true,true,true,verified\n ❯ PostgresJsPreparedQuery.queryWithCache node_modules/.pnpm/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/src/pg-core/session.ts:73:11\n ❯ node_modules/.pnpm/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/src/postgres-js/session.ts:58:17\n ❯ Function.createTestUser tests/test-database-utils.ts:35:20\n     33|     verification_status?: string;\n     34|   }) {\n     35|     const [user] = await db.insert(users).values({\n       |                    ^\n     36|       id: randomUUID(),\n     37|       email: userData.email,\n ❯ Function.createAuthenticatedTestUser tests/test-auth-utils.ts:55:18\n ❯ setupAuthenticatedTest tests/test-setup-real-auth.ts:30:23\n ❯ tests/api/onboarding/personal-info/personal-info.test.ts:191:27\n\nCaused by: PostgresError: duplicate key value violates unique constraint \"app_users_email_unique\"\n ❯ ErrorResponse node_modules/.pnpm/postgres@3.4.7/node_modules/postgres/src/connection.js:794:26\n ❯ handle node_modules/.pnpm/postgres@3.4.7/node_modules/postgres/src/connection.js:480:6\n ❯ Socket.data node_modules/.pnpm/postgres@3.4.7/node_modules/postgres/src/connection.js:315:9\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯\nSerialized Error: { severity_local: 'ERROR', severity: 'ERROR', code: '23505', detail: 'Key (email)=(original@example.com) already exists.', schema_name: 'public', table_name: 'app_users', constraint_name: 'app_users_email_unique', file: 'nbtinsert.c', routine: '_bt_check_unique', query: 'insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"', parameters: [ 'face3ad7-6573-4351-b88b-73a98263f60e', 'original@example.com', 'Test', 'User', 't', 't', 't', 't', 'verified' ], args: [ 'face3ad7-6573-4351-b88b-73a98263f60e', 'original@example.com', 'Test', 'User', true, true, true, true, 'verified' ], types: [ 2950, 1043, 1043, 1043, 16, 16, 16, 16, 46250 ] }\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[70/99]⎯\n\n FAIL  tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Integration Scenarios > integrates with OAuth data source tracking\nAssertionError: expected false to be true // Object.is equality\n\n\u001b[32m- Expected\u001b[39m\n\u001b[31m+ Received\u001b[39m\n\n\u001b[32m- true\u001b[39m\n\u001b[31m+ false\u001b[39m\n\n ❯ tests/api/onboarding/personal-info/personal-info.test.ts:315:42\n    313|       \n    314|       const data = await response.json();\n    315|       expect(data.dataSource.from_oauth).toBe(true);\n       |                                          ^\n    316|       expect(data.dataSource.provider).toBe('google');\n    317|       expect(data.dataSource.has_profile_photo).toBe(true);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[71/99]⎯\n\n FAIL  tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Compliance > validates Irish compliance requirements\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/onboarding/personal-info/personal-info.test.ts:399:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[72/99]⎯\n\n FAIL  tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles users with incomplete profile data\nAssertionError: expected 'Test' to be '' // Object.is equality\n\n\u001b[32m- Expected\u001b[39m\n\u001b[31m+ Received\u001b[39m\n\n\u001b[31m+ Test\u001b[39m\n\n ❯ tests/api/onboarding/personal-info/personal-info.test.ts:461:44\n    459|       \n    460|       const data = await response.json();\n    461|       expect(data.personalInfo.first_name).toBe('');\n       |                                            ^\n    462|       expect(data.personalInfo.last_name).toBe('');\n    463|       expect(data.personalInfo.phone_number).toBe('');\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[73/99]⎯\n\n FAIL  tests/api/onboarding/photo/photo.test.ts > /api/onboarding > Core Functionality > handles POST requests with valid data\nAssertionError: expected 500 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/onboarding/photo/photo.test.ts:53:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[74/99]⎯\n\n FAIL  tests/api/onboarding/signature/signature.test.ts > /api/onboarding > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/onboarding/signature/signature.test.ts:53:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[75/99]⎯\n\n FAIL  tests/api/onboarding/verification/verification.test.ts > /api/onboarding > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/onboarding/verification/verification.test.ts:53:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[76/99]⎯\n\n FAIL  tests/api/stripe/webhook/webhook.test.ts > /api/stripe/webhook > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/stripe/webhook/webhook.test.ts:33:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[77/99]⎯\n\n FAIL  tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles GET requests with valid authentication\nAssertionError: expected 500 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/rules/[id]/[id].test.ts:29:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[78/99]⎯\n\n FAIL  tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles PUT requests with valid data\nAssertionError: expected 500 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/rules/[id]/[id].test.ts:45:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[79/99]⎯\n\n FAIL  tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles DELETE requests with authentication\nAssertionError: expected 500 to be less than 500\n ❯ tests/api/rules/[id]/[id].test.ts:55:31\n     53|       \n     54|       expect(response).toBeDefined();\n     55|       expect(response.status).toBeLessThan(500);\n       |                               ^\n     56|     });\n     57|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[80/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Core Functionality > handles GET requests with valid authentication\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:26:44\n     24|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n     25| \n     26|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     27|       \n     28|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[81/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Core Functionality > handles POST requests with valid data\nAssertionError: expected 400 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:44:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[82/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Error States > returns proper error for unauthenticated requests\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:53:47\n     51|       \n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n       |                                               ^\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n     55|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[83/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Security > requires valid JWT authentication\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:71:44\n     69|       \n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n     73|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[84/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Security > validates JWT signature integrity\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:84:44\n     82|         }\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n     86|     });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[85/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Performance > responds within acceptable time with real authentication\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:96:44\n     94| \n     95|       const startTime = performance.now();\n     96|       const response = await routeHandlers.GET(request);\n       |                                            ^\n     97|       const responseTime = performance.now() - startTime;\n     98|       \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[86/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Database Integrity > maintains data consistency with real database operations\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:109:44\n    107|       \n    108|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    109|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    110|       \n    111|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[87/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Integration Scenarios > integrates with authentication workflow\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:120:44\n    118|       \n    119|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    120|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    121|       \n    122|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[88/99]⎯\n\n FAIL  tests/api/rules/validate-allocation/validate-allocation.test.ts > /api/rules/validate-allocation > Compliance > meets API standards with proper authentication\nTypeError: GET is not a function\n ❯ tests/api/rules/validate-allocation/validate-allocation.test.ts:131:44\n    129|       \n    130|       const request = createAuthenticatedRequest(url, { method: 'GET' …\n    131|       const response = await routeHandlers.GET(request);\n       |                                            ^\n    132|       \n    133|       expect(response).toBeDefined();\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[89/99]⎯\n\n FAIL  tests/api/will/status/status.test.ts > /api/will/status > Core Functionality > handles POST requests with valid data\nAssertionError: expected 404 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/will/status/status.test.ts:44:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[90/99]⎯\n\n FAIL  tests/api/auth/google/callback/callback.test.ts > /api/auth/google/callback > Core Functionality > handles GET requests with valid authentication\nAssertionError: expected 307 to be less than 300\n ❯ Object.expectSuccessfulResponse tests/test-setup-real-auth.ts:238:29\n    236|   expectSuccessfulResponse(response: Response) {\n    237|     expect(response.status).toBeGreaterThanOrEqual(200);\n    238|     expect(response.status).toBeLessThan(300);\n       |                             ^\n    239|   },\n    240|   \n ❯ tests/api/auth/google/callback/callback.test.ts:28:22\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[91/99]⎯\n\n FAIL  tests/api/auth/google/callback/callback.test.ts > /api/auth/google/callback > Core Functionality > handles POST requests with valid data\nTypeError: POST is not a function\n ❯ tests/api/auth/google/callback/callback.test.ts:42:44\n     40|       }, authContext);\n     41| \n     42|       const response = await routeHandlers.POST(request);\n       |                                            ^\n     43|       \n     44|       TestAssertions.expectSuccessfulResponse(response);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[92/99]⎯\n\n FAIL  tests/api/auth/google/callback/callback.test.ts > /api/auth/google/callback > Error States > returns proper error for unauthenticated requests\nAssertionError: expected 307 to be greater than or equal to 400\n ❯ tests/api/auth/google/callback/callback.test.ts:54:34\n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest);\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n       |                                  ^\n     55|       \n     56|       const postRequest = new NextRequest(url, {\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[93/99]⎯\n\n FAIL  tests/api/auth/google/callback/callback.test.ts > /api/auth/google/callback > Security > requires valid JWT authentication\nAssertionError: expected 307 to be greater than or equal to 400\n ❯ tests/api/auth/google/callback/callback.test.ts:72:31\n     70|       const request = new NextRequest(url, { method: 'GET' });\n     71|       const response = await routeHandlers.GET(request);\n     72|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     73|     });\n     74| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[94/99]⎯\n\n FAIL  tests/api/auth/google/callback/callback.test.ts > /api/auth/google/callback > Security > validates JWT signature integrity\nAssertionError: expected 307 to be greater than or equal to 400\n ❯ tests/api/auth/google/callback/callback.test.ts:85:31\n     83|       });\n     84|       const response = await routeHandlers.GET(request);\n     85|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     86|     });\n     87|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[95/99]⎯\n\n FAIL  tests/api/auth/google/callback/callback.test.ts > /api/auth/google/callback > Edge Cases > handles malformed JSON appropriately\nTypeError: POST is not a function\n ❯ tests/api/auth/google/callback/callback.test.ts:148:44\n    146|       }, authContext);\n    147| \n    148|       const response = await routeHandlers.POST(request);\n       |                                            ^\n    149|       expect(response).toBeDefined();\n    150|       expect(response.status).toBeGreaterThanOrEqual(400);\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[96/99]⎯\n\n FAIL  tests/api/documents/requirements/[type]/[type].test.ts > /api/documents/requirements/[type] > Error States > returns proper error for unauthenticated requests\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/documents/requirements/[type]/[type].test.ts:54:34\n     52|       const getRequest = new NextRequest(url, { method: 'GET' });\n     53|       const getResponse = await routeHandlers.GET(getRequest, { params…\n     54|       expect(getResponse.status).toBeGreaterThanOrEqual(400);\n       |                                  ^\n     55|       \n     56|       // This route only supports GET\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[97/99]⎯\n\n FAIL  tests/api/documents/requirements/[type]/[type].test.ts > /api/documents/requirements/[type] > Security > requires valid JWT authentication\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/documents/requirements/[type]/[type].test.ts:66:31\n     64|       const request = new NextRequest(url, { method: 'GET' });\n     65|       const response = await routeHandlers.GET(request, { params: Prom…\n     66|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     67|     });\n     68| \n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[98/99]⎯\n\n FAIL  tests/api/documents/requirements/[type]/[type].test.ts > /api/documents/requirements/[type] > Security > validates JWT signature integrity\nAssertionError: expected 200 to be greater than or equal to 400\n ❯ tests/api/documents/requirements/[type]/[type].test.ts:79:31\n     77|       });\n     78|       const response = await routeHandlers.GET(request, { params: Prom…\n     79|       expect(response.status).toBeGreaterThanOrEqual(400);\n       |                               ^\n     80|     });\n     81|   });\n\n⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[99/99]⎯\n\n",
      "startTime": 1757011577145,
      "endTime": 1757011607342,
      "duration": 30197,
      "error": "Process exited with code 1",
      "individualTests": {
        "total": 394,
        "passed": 295,
        "failed": 99,
        "skipped": 0,
        "passRate": 75,
        "progress": 90
      }
    },
    "linting": {
      "command": "npm run lint",
      "status": "completed",
      "output": "\n> herit@0.1.0 lint\n> eslint --fix\n\n\n/Users/dean/code/Herit/app/(auth)/layout.tsx\n  1:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(auth)/login/page.tsx\n  22:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/LegalConsentStep.tsx\n  199:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/PersonalInfoStep.cy.tsx\n  23:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/PersonalInfoStep.tsx\n  120:11  warning  Unexpected console statement  no-console\n  142:25  warning  Unexpected console statement  no-console\n  224:27  warning  Unexpected console statement  no-console\n  252:25  warning  Unexpected console statement  no-console\n  273:25  warning  Unexpected console statement  no-console\n  278:7   warning  Unexpected console statement  no-console\n  296:25  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/SignatureStamp-optimized.cy.tsx\n   9:3  warning  'timestamp' is defined but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                          @typescript-eslint/no-unused-vars\n  41:9  warning  Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element  @next/next/no-img-element\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/SignatureStep.tsx\n   29:3  warning  'onChange' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  113:9  warning  'handleBackToCreation' is assigned a value but never used                       @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/VerificationStep.tsx\n   59:5  warning  Unexpected console statement  no-console\n   68:9  warning  Unexpected console statement  no-console\n   82:9  warning  Unexpected console statement  no-console\n   88:7  warning  Unexpected console statement  no-console\n  137:5  warning  Unexpected console statement  no-console\n  153:9  warning  Unexpected console statement  no-console\n  163:9  warning  Unexpected console statement  no-console\n  183:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(auth)/onboarding/page.tsx\n   48:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n   86:5   warning  Unexpected console statement                                                           no-console\n  101:9   warning  Unexpected console statement                                                           no-console\n  110:9   warning  Unexpected console statement                                                           no-console\n  135:5   warning  Unexpected console statement                                                           no-console\n  142:5   warning  Unexpected console statement                                                           no-console\n  149:5   warning  Unexpected console statement                                                           no-console\n  153:7   warning  Unexpected console statement                                                           no-console\n  159:9   warning  Unexpected console statement                                                           no-console\n  174:11  warning  Unexpected console statement                                                           no-console\n  182:11  warning  Unexpected console statement                                                           no-console\n  193:13  warning  Unexpected console statement                                                           no-console\n  198:9   warning  Unexpected console statement                                                           no-console\n  206:7   warning  Unexpected console statement                                                           no-console\n  212:9   warning  Unexpected console statement                                                           no-console\n  216:11  warning  Unexpected console statement                                                           no-console\n  219:9   warning  Unexpected console statement                                                           no-console\n  227:7   warning  Unexpected console statement                                                           no-console\n  233:9   warning  Unexpected console statement                                                           no-console\n  241:11  warning  Unexpected console statement                                                           no-console\n  244:9   warning  Unexpected console statement                                                           no-console\n  251:7   warning  Unexpected console statement                                                           no-console\n  283:7   warning  Unexpected console statement                                                           no-console\n  322:7   warning  Unexpected console statement                                                           no-console\n  350:7   warning  Unexpected console statement                                                           no-console\n  355:7   warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(auth)/signup/page.tsx\n  14:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  82:15  warning  'confirmPassword' is assigned a value but never used                                   @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/assets/[id]/edit/page.tsx\n  8:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/assets/add/page.tsx\n    62:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n   160:5   warning  Unexpected console statement                                                           no-console\n   161:5   warning  Unexpected console statement                                                           no-console\n   166:9   warning  Unexpected console statement                                                           no-console\n   167:9   warning  Unexpected console statement                                                           no-console\n   171:11  warning  Unexpected console statement                                                           no-console\n   176:13  warning  Unexpected console statement                                                           no-console\n   179:11  warning  Unexpected console statement                                                           no-console\n   185:9   warning  Unexpected console statement                                                           no-console\n   189:7   warning  Unexpected console statement                                                           no-console\n   194:5   warning  Unexpected console statement                                                           no-console\n   202:9   warning  Unexpected console statement                                                           no-console\n   203:9   warning  Unexpected console statement                                                           no-console\n   204:9   warning  Unexpected console statement                                                           no-console\n   205:9   warning  Unexpected console statement                                                           no-console\n   209:9   warning  Unexpected console statement                                                           no-console\n   219:9   warning  Unexpected console statement                                                           no-console\n   237:7   warning  Unexpected console statement                                                           no-console\n   238:7   warning  Unexpected console statement                                                           no-console\n   241:7   warning  Unexpected console statement                                                           no-console\n   248:7   warning  Unexpected console statement                                                           no-console\n   249:7   warning  Unexpected console statement                                                           no-console\n   254:9   warning  Unexpected console statement                                                           no-console\n   255:9   warning  Unexpected console statement                                                           no-console\n   260:9   warning  Unexpected console statement                                                           no-console\n   268:9   warning  Unexpected console statement                                                           no-console\n   275:7   warning  Unexpected console statement                                                           no-console\n   288:5   warning  Unexpected console statement                                                           no-console\n   289:5   warning  Unexpected console statement                                                           no-console\n   290:5   warning  Unexpected console statement                                                           no-console\n   303:7   warning  Unexpected console statement                                                           no-console\n   811:21  warning  Unexpected console statement                                                           no-console\n   815:21  warning  Unexpected console statement                                                           no-console\n  1037:17  warning  Unexpected console statement                                                           no-console\n  1038:17  warning  Unexpected console statement                                                           no-console\n  1039:17  warning  Unexpected console statement                                                           no-console\n  1040:17  warning  Unexpected console statement                                                           no-console\n  1041:17  warning  Unexpected console statement                                                           no-console\n  1045:21  warning  Unexpected console statement                                                           no-console\n  1048:21  warning  Unexpected console statement                                                           no-console\n  1054:19  warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/assets/page.tsx\n  39:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  46:21  warning  'setSortOrder' is assigned a value but never used                                      @typescript-eslint/no-unused-vars\n  75:9   warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/beneficiaries/[id]/edit/page.tsx\n  20:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/beneficiaries/add/page.tsx\n  13:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/beneficiaries/page.tsx\n  29:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/dashboard/DashboardClient.tsx\n  29:11  warning  'DashboardStats' is defined but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/dashboard/page.tsx\n  8:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/layout.tsx\n  4:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/CreateRuleModal.cy.tsx\n  20:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/CreateRuleModal.tsx\n  213:9  warning  Unexpected console statement  no-console\n  270:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/EditRuleModal.cy.tsx\n  21:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/EditRuleModal.tsx\n  216:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/ViewRuleModal.tsx\n  46:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(dashboard)/rules/page.tsx\n  27:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  64:9  warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/test-shared-form/page.tsx\n   9:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  13:5  warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/will/WillClient.tsx\n  22:12  warning  'willError' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/will/page.tsx\n  7:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/_lib/QueryProvider.cy.tsx\n  16:9   warning  'queryClient' is assigned a value but never used  @typescript-eslint/no-unused-vars\n  39:17  warning  'queryClient' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/_lib/error.tsx\n  5:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/api/assets/[id]/documents/route.ts\n   73:5   warning  Unexpected console statement                 no-console\n   75:7   warning  Unexpected console statement                 no-console\n  121:7   warning  Unexpected console statement                 no-console\n  125:7   warning  Unexpected console statement                 no-console\n  166:5   warning  Unexpected console statement                 no-console\n  167:5   warning  Unexpected console statement                 no-console\n  196:11  warning  'filter' is assigned a value but never used  @typescript-eslint/no-unused-vars\n  221:5   warning  Unexpected console statement                 no-console\n\n/Users/dean/code/Herit/app/api/assets/[id]/route.ts\n   52:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n  146:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n  210:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/assets/categories/route.ts\n  12:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  37:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/assets/route.ts\n  164:5   warning  Unexpected console statement       no-console\n  277:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/audit/log-event/route.ts\n  45:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/create-test-user/route.ts\n  75:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/google/callback/route.ts\n   39:7  warning  Unexpected console statement  no-console\n  166:7  warning  Unexpected console statement  no-console\n  216:7  warning  Unexpected console statement  no-console\n  505:7  warning  Unexpected console statement  no-console\n  534:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/google/route.ts\n   6:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  56:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/auth/login/route.ts\n  70:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/logout/route.ts\n   5:28  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  12:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/auth/refresh/route.ts\n  51:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/register/route.ts\n  85:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/session/route.ts\n   5:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  27:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/beneficiaries/[id]/route.ts\n   49:5  warning  Unexpected console statement  no-console\n  127:5  warning  Unexpected console statement  no-console\n  180:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/beneficiaries/count/route.ts\n   8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  40:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/beneficiaries/photo/route.ts\n  75:7  warning  Unexpected console statement  no-console\n  83:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/beneficiaries/route.ts\n   90:5  warning  Unexpected console statement  no-console\n  154:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/debug-user/route.ts\n  68:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/debug/verification/route.ts\n  147:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/documents/[id]/route.ts\n  24:5  warning  Unexpected console statement  no-console\n  55:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/documents/requirements/[type]/route.ts\n  25:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/health/route.ts\n  34:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  55:11  warning  'result' is assigned a value but never used                                    @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/onboarding/complete/route.ts\n    9:28  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   48:9   warning  Unexpected console statement                                                   no-console\n   61:11  warning  Unexpected console statement                                                   no-console\n   78:9   warning  Unexpected console statement                                                   no-console\n   91:5   warning  Unexpected console statement                                                   no-console\n  127:7   warning  Unexpected console statement                                                   no-console\n  136:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/consent-signature/route.ts\n   9:3  warning  Unexpected console statement  no-console\n  13:5  warning  Unexpected console statement  no-console\n  19:7  warning  Unexpected console statement  no-console\n  91:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/legal-consent/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   38:5   warning  Unexpected console statement                                                   no-console\n  110:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/personal-info/route.ts\n  127:5   warning  Unexpected console statement  no-console\n  186:5   warning  Unexpected console statement  no-console\n  210:5   warning  Unexpected console statement  no-console\n  283:5   warning  Unexpected console statement  no-console\n  289:7   warning  Unexpected console statement  no-console\n  291:7   warning  Unexpected console statement  no-console\n  341:5   warning  Unexpected console statement  no-console\n  349:7   warning  Unexpected console statement  no-console\n  369:5   warning  Unexpected console statement  no-console\n  405:13  warning  Unexpected console statement  no-console\n  406:13  warning  Unexpected console statement  no-console\n  412:13  warning  Unexpected console statement  no-console\n  432:5   warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/photo/route.ts\n  75:7  warning  Unexpected console statement  no-console\n  83:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/save-step/route.ts\n   91:5  warning  Unexpected console statement  no-console\n  100:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/signature/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   54:5   warning  Unexpected console statement                                                   no-console\n  173:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/status/route.ts\n   5:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  23:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/verification/route.ts\n   9:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  93:7   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/verification/sync/route.ts\n    9:28  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   66:11  warning  Unexpected console statement                                                   no-console\n   96:9   warning  Unexpected console statement                                                   no-console\n  139:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/rules/[id]/route.ts\n   86:5  warning  Unexpected console statement  no-console\n  248:5  warning  Unexpected console statement  no-console\n  284:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/rules/route.ts\n   40:6   warning  'CreateRuleRequest' is defined but never used                                  @typescript-eslint/no-unused-vars\n   42:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  105:5   warning  Unexpected console statement                                                   no-console\n  247:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/rules/validate-allocation/route.ts\n   22:6  warning  'ValidateAllocationRequest' is defined but never used  @typescript-eslint/no-unused-vars\n  195:5  warning  Unexpected console statement                           no-console\n\n/Users/dean/code/Herit/app/api/stripe/webhook/route.ts\n   22:7   warning  Unexpected console statement                           no-console\n   39:14  warning  'error' is defined but never used                      @typescript-eslint/no-unused-vars\n   57:12  warning  'error' is defined but never used                      @typescript-eslint/no-unused-vars\n   72:7   warning  Unexpected console statement                           no-console\n   77:29  warning  'verificationData' is assigned a value but never used  @typescript-eslint/no-unused-vars\n  113:7   warning  Unexpected console statement                           no-console\n  128:5   warning  Unexpected console statement                           no-console\n  151:7   warning  Unexpected console statement                           no-console\n  160:5   warning  Unexpected console statement                           no-console\n  168:5   warning  Unexpected console statement                           no-console\n\n/Users/dean/code/Herit/app/api/test-counts/route.ts\n  18:5  warning  Unexpected console statement  no-console\n  25:5  warning  Unexpected console statement  no-console\n  26:5  warning  Unexpected console statement  no-console\n  33:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/test-db/route.ts\n  18:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/test-reports/route.ts\n  25:11  warning  Unexpected console statement  no-console\n  43:5   warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/test-runner/route.ts\n   23:5   warning  Unexpected console statement       no-console\n   49:7   warning  Unexpected console statement       no-console\n   83:11  warning  Unexpected console statement       no-console\n  114:24  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n  165:13  warning  Unexpected console statement       no-console\n  177:13  warning  Unexpected console statement       no-console\n  196:15  warning  Unexpected console statement       no-console\n  207:11  warning  Unexpected console statement       no-console\n  232:5   warning  Unexpected console statement       no-console\n  248:5   warning  Unexpected console statement       no-console\n  253:7   warning  Unexpected console statement       no-console\n  267:5   warning  Unexpected console statement       no-console\n\n/Users/dean/code/Herit/app/api/will/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   58:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n  116:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/will/status/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   61:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n  136:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/auth/AuthErrorHandler.tsx\n  31:7  warning  Unexpected console statement  no-console\n  40:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/auth/EmailSignupForm.tsx\n  62:15  warning  'confirmPassword' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/auth/LoginForm-enhanced.cy.tsx\n  555:13  warning  'currentMode' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/auth/ProtectedRoute.tsx\n  25:5  warning  Unexpected console statement  no-console\n  41:9  warning  Unexpected console statement  no-console\n  50:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/auth/SignatureCanvas.tsx\n  24:11  warning  'theme' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryForm.cy.tsx\n  22:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryList.tsx\n  59:3  warning  'onPageSizeChange' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryPhotoInput.cy.tsx\n  22:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryPhotoInput.tsx\n  24:3  warning  'isInvalid' is assigned a value but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  25:3  warning  'errorMessage' is defined but never used. Allowed unused args must match /^_.*?$/u        @typescript-eslint/no-unused-vars\n  91:7  warning  Unexpected console statement                                                              no-console\n\n/Users/dean/code/Herit/app/components/documents/DocumentManager.tsx\n   53:1   warning  Prefer named exports over default exports for React components to improve testability                                                                                                                                                                                                    storybook-cypress-compliance/require-named-export\n   60:10  warning  'viewMode' is assigned a value but never used                                                                                                                                                                                                                                            @typescript-eslint/no-unused-vars\n   60:20  warning  'setViewMode' is assigned a value but never used                                                                                                                                                                                                                                         @typescript-eslint/no-unused-vars\n  122:5   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  130:11  warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  144:9   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  162:9   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  404:17  warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  430:19  warning  Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element  @next/next/no-img-element\n\n/Users/dean/code/Herit/app/components/documents/DocumentUploadZone.tsx\n   49:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n   51:3   warning  'assetType' is defined but never used. Allowed unused args must match /^_.*?$/u        @typescript-eslint/no-unused-vars\n  118:11  warning  'uploadId' is assigned a value but never used                                          @typescript-eslint/no-unused-vars\n  171:13  warning  Unexpected console statement                                                           no-console\n  228:7   warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/components/layout/navbar.tsx\n  23:17  warning  'isSessionLoading' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/pages/HomePageClient.tsx\n  31:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/shared/DependencyInjectionExample.tsx\n   60:13  warning  'key' is defined but never used. Allowed unused args must match /^_.*?$/u    @typescript-eslint/no-unused-vars\n   60:18  warning  'value' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   63:13  warning  'key' is defined but never used. Allowed unused args must match /^_.*?$/u    @typescript-eslint/no-unused-vars\n   64:16  warning  'key' is defined but never used. Allowed unused args must match /^_.*?$/u    @typescript-eslint/no-unused-vars\n  141:7   warning  Unexpected console statement                                                 no-console\n  161:7   warning  Unexpected console statement                                                 no-console\n  182:7   warning  Unexpected console statement                                                 no-console\n  303:14  warning  'error' is defined but never used                                            @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/shared/SharedPersonalInfoFormProvider.tsx\n  65:7  warning  Unexpected console statement  no-console\n  69:7  warning  Unexpected console statement  no-console\n  86:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/shared/SharedPhotoUpload.tsx\n   27:3   warning  'name' is assigned a value but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                      @typescript-eslint/no-unused-vars\n   28:3   warning  'isInvalid' is assigned a value but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                 @typescript-eslint/no-unused-vars\n   29:3   warning  'errorMessage' is defined but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                       @typescript-eslint/no-unused-vars\n  129:7   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  171:9   warning  'markPhotoForDeletion' is assigned a value but never used                                                                                                                                                                                                                                @typescript-eslint/no-unused-vars\n  183:9   warning  'restorePhoto' is assigned a value but never used                                                                                                                                                                                                                                        @typescript-eslint/no-unused-vars\n  209:9   warning  'getTitle' is assigned a value but never used                                                                                                                                                                                                                                            @typescript-eslint/no-unused-vars\n  231:9   warning  'getDescription' is assigned a value but never used                                                                                                                                                                                                                                      @typescript-eslint/no-unused-vars\n  313:13  warning  Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element  @next/next/no-img-element\n\n/Users/dean/code/Herit/app/components/ui/ErrorBoundary.tsx\n   29:5  warning  Unexpected console statement  no-console\n  101:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/hooks/useAssets.ts\n  220:22  warning  'assetId' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/hooks/useDocuments.ts\n  79:20  warning  'documentId' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/hooks/useRules.ts\n  109:7  warning  Unexpected console statement  no-console\n  152:7  warning  Unexpected console statement  no-console\n  185:7  warning  Unexpected console statement  no-console\n  218:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/layout.tsx\n  48:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/lib/audit-middleware.ts\n   66:7   warning  Unexpected console statement                 no-console\n   84:11  warning  'action' is assigned a value but never used  @typescript-eslint/no-unused-vars\n   99:14  warning  'error' is defined but never used            @typescript-eslint/no-unused-vars\n  185:14  warning  'error' is defined but never used            @typescript-eslint/no-unused-vars\n  202:16  warning  'error' is defined but never used            @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/lib/auth-client.ts\n  28:7  warning  Unexpected console statement  no-console\n  40:5  warning  Unexpected console statement  no-console\n  74:5  warning  Unexpected console statement  no-console\n  93:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/auth.ts\n   70:5  warning  Unexpected console statement  no-console\n   89:5  warning  Unexpected console statement  no-console\n  108:5  warning  Unexpected console statement  no-console\n  128:5  warning  Unexpected console statement  no-console\n  150:7  warning  Unexpected console statement  no-console\n  174:7  warning  Unexpected console statement  no-console\n  246:5  warning  Unexpected console statement  no-console\n  302:7  warning  Unexpected console statement  no-console\n  361:7  warning  Unexpected console statement  no-console\n  407:5  warning  Unexpected console statement  no-console\n  517:5  warning  Unexpected console statement  no-console\n  533:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/document-storage.ts\n  103:7   warning  Unexpected console statement                                                   no-console\n  115:7   warning  Unexpected console statement                                                   no-console\n  140:7   warning  Unexpected console statement                                                   no-console\n  219:27  warning  'assetId' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  225:7   warning  Unexpected console statement                                                   no-console\n  240:7   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/lib/logger.ts\n  42:11  warning  Unexpected console statement  no-console\n  46:9   warning  Unexpected console statement  no-console\n  49:9   warning  Unexpected console statement  no-console\n  52:9   warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/photo-utils.ts\n   54:7  warning  Unexpected console statement  no-console\n   60:5  warning  Unexpected console statement  no-console\n   64:7  warning  Unexpected console statement  no-console\n   73:7  warning  Unexpected console statement  no-console\n   80:7  warning  Unexpected console statement  no-console\n   97:5  warning  Unexpected console statement  no-console\n  101:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/query-error-handling.ts\n  78:9  warning  Unexpected console statement  no-console\n  92:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/signature-extract.ts\n  496:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/stripe.ts\n   51:9  warning  Unexpected console statement  no-console\n  102:9  warning  Unexpected console statement  no-console\n  144:7  warning  Unexpected console statement  no-console\n  168:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/svg-sanitizer.ts\n  80:7  warning  Unexpected console statement  no-console\n  87:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/page.tsx\n  6:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/test-status/page.tsx\n  3:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/components/TestStatusDashboard.tsx\n    54:7   warning  'SSE_CHUNK_TIMEOUT' is assigned a value but never used                       @typescript-eslint/no-unused-vars\n    59:3   warning  'error' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   181:5   warning  Unexpected console statement                                                 no-console\n   531:9   warning  Unexpected console statement                                                 no-console\n   654:9   warning  'calculateWeightedProgress' is assigned a value but never used               @typescript-eslint/no-unused-vars\n   704:7   warning  Unexpected console statement                                                 no-console\n   706:7   warning  Unexpected console statement                                                 no-console\n   717:7   warning  Unexpected console statement                                                 no-console\n   724:7   warning  Unexpected console statement                                                 no-console\n   729:5   warning  Unexpected console statement                                                 no-console\n   769:7   warning  Unexpected console statement                                                 no-console\n   784:11  warning  Unexpected console statement                                                 no-console\n   965:5   warning  Unexpected console statement                                                 no-console\n   979:9   warning  Unexpected console statement                                                 no-console\n   981:9   warning  Unexpected console statement                                                 no-console\n   987:7   warning  Unexpected console statement                                                 no-console\n  1022:9   warning  Unexpected console statement                                                 no-console\n  1028:7   warning  Unexpected console statement                                                 no-console\n  1153:11  warning  Unexpected console statement                                                 no-console\n  1167:9   warning  Unexpected console statement                                                 no-console\n  1470:19  warning  Unexpected console statement                                                 no-console\n  1521:17  warning  Unexpected console statement                                                 no-console\n  1918:7   warning  Unexpected console statement                                                 no-console\n  2014:9   warning  'getSuccessRate' is assigned a value but never used                          @typescript-eslint/no-unused-vars\n  2036:9   warning  'liveTestStats' is assigned a value but never used                           @typescript-eslint/no-unused-vars\n  2369:23  warning  'totalTests' is assigned a value but never used                              @typescript-eslint/no-unused-vars\n  2370:23  warning  'passedTests' is assigned a value but never used                             @typescript-eslint/no-unused-vars\n  2371:23  warning  'failedTests' is assigned a value but never used                             @typescript-eslint/no-unused-vars\n  2374:23  warning  'passRate' is assigned a value but never used                                @typescript-eslint/no-unused-vars\n  2868:59  warning  'index' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/lib/test-counter.ts\n  145:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/lib/test-runner.ts\n   64:7   warning  Unexpected console statement                                                       no-console\n   84:7   warning  Unexpected console statement                                                       no-console\n   88:7   warning  Unexpected console statement                                                       no-console\n  103:11  warning  Unexpected console statement                                                       no-console\n  127:14  warning  'error' is defined but never used                                                  @typescript-eslint/no-unused-vars\n  128:7   warning  Unexpected console statement                                                       no-console\n  223:5   warning  'abortSignal' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  229:5   warning  Unexpected console statement                                                       no-console\n  311:7   warning  Unexpected console statement                                                       no-console\n  316:9   warning  Unexpected console statement                                                       no-console\n  326:9   warning  Unexpected console statement                                                       no-console\n  330:11  warning  Unexpected console statement                                                       no-console\n  344:15  warning  Unexpected console statement                                                       no-console\n  355:13  warning  Unexpected console statement                                                       no-console\n  358:13  warning  Unexpected console statement                                                       no-console\n  373:11  warning  Unexpected console statement                                                       no-console\n  387:15  warning  Unexpected console statement                                                       no-console\n  396:13  warning  Unexpected console statement                                                       no-console\n  399:13  warning  Unexpected console statement                                                       no-console\n  419:9   warning  Unexpected console statement                                                       no-console\n  448:13  warning  Unexpected console statement                                                       no-console\n  473:7   warning  Unexpected console statement                                                       no-console\n  477:7   warning  Unexpected console statement                                                       no-console\n  501:7   warning  Unexpected console statement                                                       no-console\n  518:11  warning  Unexpected console statement                                                       no-console\n  556:11  warning  Unexpected console statement                                                       no-console\n  559:11  warning  Unexpected console statement                                                       no-console\n  561:11  warning  Unexpected console statement                                                       no-console\n  623:7   warning  Unexpected console statement                                                       no-console\n  625:7   warning  Unexpected console statement                                                       no-console\n\n✖ 419 problems (0 errors, 419 warnings)\n\n",
      "startTime": 1757011570882,
      "endTime": 1757011574588,
      "duration": 3706,
      "individualTests": {
        "total": 1,
        "passed": 1,
        "failed": 0,
        "skipped": 0,
        "passRate": 100,
        "progress": 100
      }
    },
    "build": {
      "command": "npm run typecheck",
      "status": "completed",
      "output": "\n> herit@0.1.0 typecheck\n> tsc --noEmit --skipLibCheck\n\n",
      "startTime": 1757011574589,
      "endTime": 1757011577144,
      "duration": 2555,
      "individualTests": {
        "total": 1,
        "passed": 1,
        "failed": 0,
        "skipped": 0,
        "passRate": 100,
        "progress": 100
      }
    },
    "componentTestsAccessibility": {
      "command": "npm run test:ct:accessibility",
      "status": "failed",
      "output": "\n> herit@0.1.0 test:ct:accessibility\n> cypress run --component --config video=false,screenshotOnRunFailure=false --quiet --spec 'app/_lib/**/*.cy.tsx,app/components/auth/**/*.cy.tsx,app/components/ui/**/*.cy.tsx,app/components/layout/**/*.cy.tsx,app/components/branding/**/*.cy.tsx,app/components/pages/**/*.cy.tsx,app/components/examples/**/*.cy.tsx'\n\n16 assets\n970 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 1002 ms\n16 assets\n970 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 63 ms\n\n\n  QueryProvider\n    Core Functionality\n      ✓ renders without crashing (50ms)\n      ✓ provides QueryClient context to children (27ms)\n    Error Handling\n      ✓ handles component errors gracefully (26ms)\n    Accessibility\n      ✓ provides accessible context (27ms)\n    Responsive Design\n      ✓ works at different screen sizes (28ms)\n    Integration\n      ✓ works within parent containers (27ms)\n\n\n  6 passing (227ms)\n\n17 assets\n969 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 293 ms\n\n\n  Error Component\n    Core Functionality\n      ✓ renders error message and try again button (55ms)\n      (Attempt 1 of 3) calls reset callback when try again button is clicked\n      (Attempt 2 of 3) calls reset callback when try again button is clicked\n      1) calls reset callback when try again button is clicked\n      ✓ logs error to console on component mount (43ms)\n      ✓ handles different error types and messages (44ms)\n    Error States\n      ✓ handles missing error object gracefully (34ms)\n      (Attempt 1 of 3) handles missing reset callback gracefully\n      (Attempt 2 of 3) handles missing reset callback gracefully\n      2) handles missing reset callback gracefully\n      ✓ handles complex error objects (36ms)\n      (Attempt 1 of 3) handles multiple rapid error occurrences\n      (Attempt 2 of 3) handles multiple rapid error occurrences\n      3) handles multiple rapid error occurrences\n    Accessibility\n      (Attempt 1 of 3) should be accessible\n      (Attempt 2 of 3) should be accessible\n      4) should be accessible\n      (Attempt 1 of 3) supports keyboard navigation\n      (Attempt 2 of 3) supports keyboard navigation\n      5) supports keyboard navigation\n      (Attempt 1 of 3) has proper semantic structure\n      (Attempt 2 of 3) has proper semantic structure\n      6) has proper semantic structure\n      ✓ provides clear user guidance (31ms)\n    Performance\n      (Attempt 1 of 3) should render quickly\n      (Attempt 2 of 3) should render quickly\n      7) should render quickly\n      (Attempt 1 of 3) handles large error objects efficiently\n      (Attempt 2 of 3) handles large error objects efficiently\n      8) handles large error objects efficiently\n      (Attempt 1 of 3) handles rapid reset button clicks efficiently\n      (Attempt 2 of 3) handles rapid reset button clicks efficiently\n      9) handles rapid reset button clicks efficiently\n    Responsive Design\n      ✓ should work on all screen sizes (45ms)\n      ✓ maintains proper spacing on mobile (35ms)\n      ✓ handles long error messages on narrow screens (31ms)\n    Integration Scenarios\n      (Attempt 1 of 3) integrates with error boundary workflow\n      (Attempt 2 of 3) integrates with error boundary workflow\n      10) integrates with error boundary workflow\n      ✓ handles error reporting service integration (9ms)\n      (Attempt 1 of 3) works within Next.js app router context\n      (Attempt 2 of 3) works within Next.js app router context\n      11) works within Next.js app router context\n    Edge Cases\n      ✓ handles circular reference errors (32ms)\n      ✓ handles error objects without message (29ms)\n      ✓ handles non-Error objects passed as error (28ms)\n      ✓ handles rapid component remounting (37ms)\n    Security\n      (Attempt 1 of 3) safely handles malicious error messages\n      (Attempt 2 of 3) safely handles malicious error messages\n      12) safely handles malicious error messages\n      ✓ safely handles error properties with XSS attempts (35ms)\n      (Attempt 1 of 3) prevents reset callback injection attacks\n      (Attempt 2 of 3) prevents reset callback injection attacks\n      13) prevents reset callback injection attacks\n      (Attempt 1 of 3) handles error stack traces safely\n      (Attempt 2 of 3) handles error stack traces safely\n      14) handles error stack traces safely\n    Quality Checks\n      (Attempt 1 of 3) should meet performance standards\n      (Attempt 2 of 3) should meet performance standards\n      15) should meet performance standards\n      (Attempt 1 of 3) should be accessible\n      (Attempt 2 of 3) should be accessible\n      16) should be accessible\n      ✓ should handle responsive layouts (16ms)\n\n\n  16 passing (1m)\n  16 failing\n\n  1) Error Component\n       Core Functionality\n         calls reset callback when try again button is clicked:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n  From Your Spec Code:\n      at Object.proxyGetter [as get] (http://localhost:8080/__cypress/runner/cypress_runner.js:80426:22)\n      at exists (http://localhost:8080/__cypress/runner/cypress_runner.js:146470:26)\n      at elExists (http://localhost:8080/__cypress/runner/cypress_runner.js:146485:10)\n      at ensureExistence (http://localhost:8080/__cypress/runner/cypress_runner.js:146666:22)\n      at onFailFn (http://localhost:8080/__cypress/runner/cypress_runner.js:146695:53)\n\n  2) Error Component\n       Error States\n         handles missing reset callback gracefully:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n  3) Error Component\n       Error States\n         handles multiple rapid error occurrences:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n  4) Error Component\n       Accessibility\n         should be accessible:\n     CypressError: `cy.within()` can only be called on a single element. Your subject contained 2 elements. Narrow down your subject to a single element (using `.first()`, for example) before calling `.within()`.\n\nTo run `.within()` over multiple subjects, use `.each()`.\n\n  `cy.get('div').each($div => {`\n  `  cy.wrap($div).within(() => { ... })`\n  `})`\n\nhttps://on.cypress.io/within\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:135977:72)\n      at __WEBPACK_DEFAULT_EXPORT__ (http://localhost:8080/__cypress/runner/cypress_runner.js:133819:10)\n      at Context.within (http://localhost:8080/__cypress/runner/cypress_runner.js:135970:67)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n  From Your Spec Code:\n      at Object.proxyGetter [as get] (http://localhost:8080/__cypress/runner/cypress_runner.js:80426:22)\n      at exists (http://localhost:8080/__cypress/runner/cypress_runner.js:146470:26)\n      at elExists (http://localhost:8080/__cypress/runner/cypress_runner.js:146485:10)\n      at ensureExistence (http://localhost:8080/__cypress/runner/cypress_runner.js:146666:22)\n      at onFailFn (http://localhost:8080/__cypress/runner/cypress_runner.js:146695:53)\n\n  5) Error Component\n       Accessibility\n         supports keyboard navigation:\n     CypressError: `cy.focus()` can only be called on a single element. Your subject contained 2 elements.\n\nhttps://on.cypress.io/focus\n      at Context.focus (http://localhost:8080/__cypress/runner/cypress_runner.js:114705:70)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n  From Your Spec Code:\n      at Object.proxyGetter [as get] (http://localhost:8080/__cypress/runner/cypress_runner.js:80426:22)\n      at exists (http://localhost:8080/__cypress/runner/cypress_runner.js:146470:26)\n      at elExists (http://localhost:8080/__cypress/runner/cypress_runner.js:146485:10)\n      at ensureExistence (http://localhost:8080/__cypress/runner/cypress_runner.js:146666:22)\n      at onFailFn (http://localhost:8080/__cypress/runner/cypress_runner.js:146695:53)\n\n  6) Error Component\n       Accessibility\n         has proper semantic structure:\n\n      Timed out retrying after 4000ms\n      + expected - actual\n\n      -'DIV'\n      +'BUTTON'\n      \n      at Context.eval (webpack-internal:///./app/_lib/error.cy.tsx:344:46)\n\n  7) Error Component\n       Performance\n         should render quickly:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"button\"]`, but never found it.\n      at Object.measureRenderTime (webpack-internal:///./cypress/support/test-utils.ts:272:31)\n      at Context.eval (webpack-internal:///./app/_lib/error.cy.tsx:374:80)\n\n  8) Error Component\n       Performance\n         handles large error objects efficiently:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"button\"]`, but never found it.\n      at Object.measureRenderTime (webpack-internal:///./cypress/support/test-utils.ts:272:31)\n      at Context.eval (webpack-internal:///./app/_lib/error.cy.tsx:400:80)\n\n  9) Error Component\n       Performance\n         handles rapid reset button clicks efficiently:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n  10) Error Component\n       Integration Scenarios\n         integrates with error boundary workflow:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n  11) Error Component\n       Integration Scenarios\n         works within Next.js app router context:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n  12) Error Component\n       Security\n         safely handles malicious error messages:\n     AssertionError: Timed out retrying after 4000ms: Expected [ <script>, 3 more... ] not to exist in the DOM, but it was continuously found.\n      at Context.eval (webpack-internal:///./app/_lib/error.cy.tsx:835:30)\n\n  13) Error Component\n       Security\n         prevents reset callback injection attacks:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n  14) Error Component\n       Security\n         handles error stack traces safely:\n     AssertionError: Timed out retrying after 4000ms: Expected [ <script>, 3 more... ] not to exist in the DOM, but it was continuously found.\n      at Context.eval (webpack-internal:///./app/_lib/error.cy.tsx:905:30)\n\n  15) Error Component\n       Quality Checks\n         should meet performance standards:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"button\"]`, but never found it.\n      at Object.measureRenderTime (webpack-internal:///./cypress/support/test-utils.ts:272:31)\n      at Context.eval (webpack-internal:///./app/_lib/error.cy.tsx:913:80)\n\n  16) Error Component\n       Quality Checks\n         should be accessible:\n     CypressError: `cy.within()` can only be called on a single element. Your subject contained 2 elements. Narrow down your subject to a single element (using `.first()`, for example) before calling `.within()`.\n\nTo run `.within()` over multiple subjects, use `.each()`.\n\n  `cy.get('div').each($div => {`\n  `  cy.wrap($div).within(() => { ... })`\n  `})`\n\nhttps://on.cypress.io/within\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:135977:72)\n      at __WEBPACK_DEFAULT_EXPORT__ (http://localhost:8080/__cypress/runner/cypress_runner.js:133819:10)\n      at Context.within (http://localhost:8080/__cypress/runner/cypress_runner.js:135970:67)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n\n\n16 assets\n968 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 256 ms\n\n\n  providers\n    Core Functionality\n      (Attempt 1 of 3) renders without crashing\n      (Attempt 2 of 3) renders without crashing\n      1) renders without crashing\n      (Attempt 1 of 3) displays content correctly\n      (Attempt 2 of 3) displays content correctly\n      2) displays content correctly\n      (Attempt 1 of 3) handles props correctly\n      (Attempt 2 of 3) handles props correctly\n      3) handles props correctly\n    Accessibility\n      (Attempt 1 of 3) meets basic accessibility standards\n      (Attempt 2 of 3) meets basic accessibility standards\n      4) meets basic accessibility standards\n      (Attempt 1 of 3) supports keyboard navigation\n      (Attempt 2 of 3) supports keyboard navigation\n      5) supports keyboard navigation\n    Responsive Design\n      (Attempt 1 of 3) adapts to different screen sizes\n      (Attempt 2 of 3) adapts to different screen sizes\n      6) adapts to different screen sizes\n    Integration\n      (Attempt 1 of 3) works within parent containers\n      (Attempt 2 of 3) works within parent containers\n      7) works within parent containers\n\n\n  0 passing (1m)\n  7 failing\n\n  1) providers\n       Core Functionality\n         renders without crashing:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"providers\"], [data-testid=\"providers\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/_lib/providers.cy.tsx:38:76)\n\n  2) providers\n       Core Functionality\n         displays content correctly:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"providers\"], [data-testid=\"providers\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/_lib/providers.cy.tsx:58:76)\n\n  3) providers\n       Core Functionality\n         handles props correctly:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"providers\"], [data-testid=\"providers\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/_lib/providers.cy.tsx:81:76)\n\n  4) providers\n       Accessibility\n         meets basic accessibility standards:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `button, input, [tabindex], [role=\"button\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/_lib/providers.cy.tsx:104:16)\n\n  5) providers\n       Accessibility\n         supports keyboard navigation:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `focused`, but never found it.\n      at Context.eval (webpack-internal:///./app/_lib/providers.cy.tsx:134:26)\n\n  6) providers\n       Responsive Design\n         adapts to different screen sizes:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"providers\"], [data-testid=\"providers\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/_lib/providers.cy.tsx:164:76)\n\n  7) providers\n       Integration\n         works within parent containers:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"providers\"], [data-testid=\"providers\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/_lib/providers.cy.tsx:203:80)\n      at withinFn (http://localhost:8080/__cypress/runner/cypress_runner.js:135903:8)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:135984:16)\n      at __WEBPACK_DEFAULT_EXPORT__ (http://localhost:8080/__cypress/runner/cypress_runner.js:133819:10)\n      at Context.within (http://localhost:8080/__cypress/runner/cypress_runner.js:135970:67)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n\n\n\n15 assets\n969 modules\n\n\u001b[1m\u001b[31mERROR\u001b[39m\u001b[22m in \u001b[1m./app/components/auth/AuthErrorHandler.cy.tsx\u001b[39m\u001b[22m\nModule build failed (from ./node_modules/.pnpm/next@15.4.6_@babel+core@7.28.3_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-swc-loader.js):\nError:   \u001b[31mx\u001b[0m Expected '}', got '<eof>'\n     ,-[\u001b[36;1;4m/Users/dean/code/Herit/app/components/auth/AuthErrorHandler.cy.tsx\u001b[0m:131:1]\n \u001b[2m128\u001b[0m |       });\n \u001b[2m129\u001b[0m |     });\n \u001b[2m130\u001b[0m |   });\n \u001b[2m131\u001b[0m | });\n     : \u001b[35;1m ^\u001b[0m\n     `----\n  \u001b[31mx\u001b[0m Unexpected eof\n     ,-[\u001b[36;1;4m/Users/dean/code/Herit/app/components/auth/AuthErrorHandler.cy.tsx\u001b[0m:131:5]\n \u001b[2m129\u001b[0m |     });\n \u001b[2m130\u001b[0m |   });\n \u001b[2m131\u001b[0m | });\n     `----\n\n\nCaused by:\n    Syntax Error\n\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled with \u001b[1m\u001b[31m1 error\u001b[39m\u001b[22m in 276 ms\n\n\n  (Attempt 1 of 2) An uncaught error was detected outside of a test\n  1) An uncaught error was detected outside of a test\n\n  0 passing (18ms)\n  1 failing\n\n  1) An uncaught error was detected outside of a test:\n     TypeError: The following error originated from your test code, not from Cypress.\n\n  > Cannot read properties of undefined (reading 'bind')\n\nWhen Cypress detects uncaught errors originating from your test code it will automatically fail the current test.\n\nCypress could not associate this error to any specific test.\n\nWe dynamically generated a new test to display this failure.\n      at Object.load (webpack-internal:///../../Library/Caches/Cypress/15.0.0/Cypress.app/Contents/Resources/app/packages/server/node_modules/@cypress/webpack-dev-server/dist/loader.js!../../Library/Caches/Cypress/15.0.0/Cypress.app/Contents/Resources/app/packages/server/node_modules/@cypress/webpack-dev-server/dist/browser.js:4:101)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:113073:21)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Object.gotValue (http://localhost:8080/__cypress/runner/cypress_runner.js:6446:18)\n      at Object.gotAccum (http://localhost:8080/__cypress/runner/cypress_runner.js:6435:25)\n      at Object.tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromise0 (http://localhost:8080/__cypress/runner/cypress_runner.js:1591:10)\n      at Promise._settlePromises (http://localhost:8080/__cypress/runner/cypress_runner.js:1671:18)\n\n\n\n18 assets\n1269 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 308 ms\n\n\n  EmailLoginForm\n    Core Functionality\n      (Attempt 1 of 3) renders without crashing\n      (Attempt 2 of 3) renders without crashing\nwrite EPIPE\nError: write EPIPE\n    at afterWriteDispatched (node:internal/stream_base_commons:159:15)\n    at writeGeneric (node:internal/stream_base_commons:150:3)\n    at Socket._writeGeneric (node:net:971:11)\n    at Socket._write (node:net:983:8)\n    at writeOrBuffer (node:internal/streams/writable:572:12)\n    at _write (node:internal/streams/writable:501:10)\n    at Writable.write (node:internal/streams/writable:510:10)\n    at execSync (node:child_process:967:20)\n    at node:electron/js2c/node_init:2:17313\n    at <embedded>:1245:1069694\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)\n[60013:0904/194617.566865:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n[60013:0904/194617.566876:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n\nDevTools listening on ws://127.0.0.1:60081/devtools/browser/2e32b4b7-7147-4111-a14b-a701cde5db48\n<<<CYPRESS.STDERR.START>>><i> [webpack-dev-server] Project is running at:\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-server] Loopback: \u001b[36mhttp://127.0.0.1:8080/\u001b[39m\n<i> [webpack-dev-server] Content not from webpack is served from '\u001b[36m/Users/dean/code/Herit/public\u001b[39m' directory\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/main.js\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>>",
      "startTime": 1757011577145,
      "endTime": 1757011757340,
      "duration": 180195,
      "error": "Process was terminated (SIGTERM) due to timeout",
      "individualTests": {
        "total": 6,
        "passed": 6,
        "failed": 0,
        "skipped": 0,
        "passRate": 100,
        "progress": 100
      }
    },
    "componentTestsCore": {
      "command": "npm run test:ct:core",
      "status": "failed",
      "output": "\n> herit@0.1.0 test:ct:core\n> cypress run --component --config video=false,screenshotOnRunFailure=false --quiet --spec 'app/components/beneficiaries/**/*.cy.tsx,app/components/documents/**/*.cy.tsx,app/components/shared/**/*.cy.tsx,app/components/dashboard/**/*.cy.tsx,app/(dashboard)/**/*.cy.tsx,app/(auth)/**/*.cy.tsx,components/**/*.cy.tsx'\n\nYour configFile threw an error from: cypress.config.js\n\nWe stopped running your tests because your config file crashed.\n\nError: listen EADDRINUSE: address already in use 127.0.0.1:8080\n    at Server.setupListenHandle [as _listen2] (node:net:1937:16)\n    at listenInCluster (node:net:1994:12)\n    at node:net:2203:7\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n[60012:0904/194617.566850:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n[60012:0904/194617.566865:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n\nDevTools listening on ws://127.0.0.1:60080/devtools/browser/22b5d3a7-7494-4af8-9177-a0caf33292d4\n",
      "startTime": 1757011577145,
      "endTime": 1757011580243,
      "duration": 3098,
      "error": "Process exited with code 1",
      "individualTests": {
        "total": 1,
        "passed": 0,
        "failed": 1,
        "skipped": 0,
        "passRate": 0,
        "progress": 25
      }
    }
  }
}