{
  "executionId": "test-1757013046905",
  "timestamp": "2025-09-04T19:10:46.910Z",
  "status": "failed",
  "overallSuccess": false,
  "results": {
    "backendTests": {
      "command": "npm run test:unit -- tests/api",
      "status": "failed",
      "output": "\n> herit@0.1.0 test:unit\n> NODE_ENV=test vitest run tests/api\n\n\n RUN  v3.2.4 /Users/dean/code/Herit\n\n ❯ tests/api/beneficiaries/count/count.test.ts (10 tests | 4 failed) 15420ms\n   × /api/beneficiaries/count > Core Functionality > handles GET requests with valid authentication 286ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: e3bec4b9-eac3-4406-8124-56f17030a8d7,test-auth-1757013064832-c17bc7ba@example.com,Test,User,true,true,true,true,verified\n   × /api/beneficiaries/count > Core Functionality > returns consistent response format 432ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: 503fd427-8591-4523-bba8-3cf1ba0d584f,test-auth-1757013065118-0a93ce7d@example.com,Test,User,true,true,true,true,verified\n   ✓ /api/beneficiaries/count > Error States > returns proper error for unauthenticated requests 13ms\n   ✓ /api/beneficiaries/count > Security > requires valid JWT authentication 4ms\n   ✓ /api/beneficiaries/count > Security > validates JWT signature integrity 2ms\n   × /api/beneficiaries/count > Performance > responds within acceptable time with real authentication 587ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: 046a3982-2f2e-41f8-af0a-506b56149e41,test-auth-1757013065572-e0375aef@example.com,Test,User,true,true,true,true,verified\n   ✓ /api/beneficiaries/count > Database Integrity > maintains data consistency with real database operations  5673ms\n   ✓ /api/beneficiaries/count > Integration Scenarios > integrates with authentication workflow  4153ms\n   ✓ /api/beneficiaries/count > Compliance > meets API standards with proper authentication  4260ms\n   × /api/beneficiaries/count > Edge Cases > handles edge cases appropriately 2ms\n     → expected 500 to be less than 500\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates\nReceived data: {\n  firstName: \u001b[32m'Updated'\u001b[39m,\n  lastName: \u001b[32m'Name'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  addressLine1: \u001b[32m'123 New Street'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates\nCurrent user query result: {\n  id: \u001b[32m'028e18ed-5ce7-41bd-bd8b-22c3fbb43e40'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013086553-b4d0e7e6@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T19:11:26.665Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T19:11:26.665Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Updated Name'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013086553-b4d0e7e6@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Updated Name'\u001b[39m,\n    email: \u001b[32m'test-auth-1757013086553-b4d0e7e6@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m'Dublin'\u001b[39m,\n    county: \u001b[32m'Dublin'\u001b[39m,\n    eircode: \u001b[32m'D01 X123'\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Updated'\u001b[39m,\n  last_name: \u001b[32m'Name'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Updated'\u001b[39m,\n  last_name: \u001b[32m'Name'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 New Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\n ❯ tests/api/rules/rules.test.ts (10 tests | 3 failed) 23161ms\n   × /api/rules > Core Functionality > handles GET requests with valid authentication 422ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: a10527ef-89b1-4864-8e90-30413846fe41,test-auth-1757013064907-08178535@example.com,Test,User,true,true,true,true,verified\n   × /api/rules > Core Functionality > handles POST requests with valid data 678ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: 1b5e2569-270f-43d8-a5a3-a428cfb01797,test-auth-1757013065329-7dd89969@example.com,Test,User,true,true,true,true,verified\n   ✓ /api/rules > Error States > returns proper error for unauthenticated requests 8ms\n   ✓ /api/rules > Security > requires valid JWT authentication 1ms\n   ✓ /api/rules > Security > validates JWT signature integrity 1ms\n   × /api/rules > Performance > responds within acceptable time with real authentication 5814ms\n     → expected 2015.473 to be less than 2000\n   ✓ /api/rules > Database Integrity > maintains data consistency with real database operations  4812ms\n   ✓ /api/rules > Integration Scenarios > integrates with authentication workflow  4345ms\n   ✓ /api/rules > Compliance > meets API standards with proper authentication  4978ms\n   ✓ /api/rules > Edge Cases > handles malformed JSON appropriately  2098ms\n ❯ tests/api/auth/create-test-user/create-test-user.test.ts (10 tests | 4 failed) 27534ms\n   ✓ /api/auth/create-test-user > Core Functionality > handles GET requests with valid authentication  5522ms\n   ✓ /api/auth/create-test-user > Core Functionality > handles POST requests with valid data  3262ms\n   × /api/auth/create-test-user > Error States > returns proper error for unauthenticated requests 409ms\n     → expected 200 to be greater than or equal to 400\n   × /api/auth/create-test-user > Security > requires valid JWT authentication 351ms\n     → expected 200 to be greater than or equal to 400\n   × /api/auth/create-test-user > Security > validates JWT signature integrity 497ms\n     → expected 200 to be greater than or equal to 400\n   ✓ /api/auth/create-test-user > Performance > responds within acceptable time with real authentication  4203ms\n   ✓ /api/auth/create-test-user > Database Integrity > maintains data consistency with real database operations  3180ms\n   ✓ /api/auth/create-test-user > Integration Scenarios > integrates with authentication workflow  3754ms\n   ✓ /api/auth/create-test-user > Compliance > meets API standards with proper authentication  2079ms\n   × /api/auth/create-test-user > Edge Cases > handles malformed JSON appropriately 4270ms\n     → expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/google/callback/callback.test.ts (10 tests | 6 failed) 28060ms\n   × /api/auth/google/callback > Core Functionality > handles GET requests with valid authentication 5516ms\n     → expected 307 to be less than 300\n   × /api/auth/google/callback > Core Functionality > handles POST requests with valid data 2838ms\n     → POST is not a function\n   × /api/auth/google/callback > Error States > returns proper error for unauthenticated requests 776ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google/callback > Security > requires valid JWT authentication 409ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google/callback > Security > validates JWT signature integrity 805ms\n     → expected 307 to be greater than or equal to 400\n   ✓ /api/auth/google/callback > Performance > responds within acceptable time with real authentication  4021ms\n   ✓ /api/auth/google/callback > Database Integrity > maintains data consistency with real database operations  3541ms\n   ✓ /api/auth/google/callback > Integration Scenarios > integrates with authentication workflow  3736ms\n   ✓ /api/auth/google/callback > Compliance > meets API standards with proper authentication  2751ms\n   × /api/auth/google/callback > Edge Cases > handles malformed JSON appropriately 3617ms\n     → POST is not a function\n ❯ tests/api/beneficiaries/beneficiaries.test.ts (10 tests | 1 failed) 29108ms\n   ✓ /api/beneficiaries > Core Functionality > handles authenticated requests with real JWT tokens  7112ms\n   × /api/beneficiaries > Core Functionality > handles POST requests with valid data 2691ms\n     → expected 400 to be less than 300\n   ✓ /api/beneficiaries > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/beneficiaries > Security > requires valid JWT authentication 0ms\n   ✓ /api/beneficiaries > Security > validates JWT signature integrity 1ms\n   ✓ /api/beneficiaries > Performance > responds within acceptable time with real authentication  4738ms\n   ✓ /api/beneficiaries > Database Integrity > maintains data consistency with real database operations  3668ms\n   ✓ /api/beneficiaries > Integration Scenarios > integrates with authentication workflow  3838ms\n   ✓ /api/beneficiaries > Compliance > meets API standards with proper authentication  3438ms\n   ✓ /api/beneficiaries > Edge Cases > handles malformed requests appropriately  3617ms\n ❯ tests/api/will/status/status.test.ts (10 tests | 1 failed) 29238ms\n   ✓ /api/will/status > Core Functionality > handles GET requests with valid authentication  6320ms\n   × /api/will/status > Core Functionality > handles POST requests with valid data 3264ms\n     → expected 404 to be less than 300\n   ✓ /api/will/status > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/will/status > Security > requires valid JWT authentication 0ms\n   ✓ /api/will/status > Security > validates JWT signature integrity 1ms\n   ✓ /api/will/status > Performance > responds within acceptable time with real authentication  4739ms\n   ✓ /api/will/status > Database Integrity > maintains data consistency with real database operations  3645ms\n   ✓ /api/will/status > Integration Scenarios > integrates with authentication workflow  3845ms\n   ✓ /api/will/status > Compliance > meets API standards with proper authentication  3250ms\n   ✓ /api/will/status > Edge Cases > handles malformed JSON appropriately  4162ms\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression\nReceived data: {\n  firstName: \u001b[32m'Test'\u001b[39m,\n  lastName: \u001b[32m'User'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  addressLine1: \u001b[32m'123 Test Street'\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression\nCurrent user query result: {\n  id: \u001b[32m'22f11e17-e1cb-4061-bb2d-22a76eb2a809'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013096871-8b197419@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mfalse\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mfalse\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mfalse\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mfalse\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mfalse\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T19:11:36.944Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T19:11:36.944Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Test User'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013096871-8b197419@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Test User'\u001b[39m,\n    email: \u001b[32m'test-auth-1757013096871-8b197419@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m'Dublin'\u001b[39m,\n    county: \u001b[32m'Dublin'\u001b[39m,\n    eircode: \u001b[32m'D01 X123'\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mfalse\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mfalse\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[32m'123 Test Street'\u001b[39m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[32m'Dublin'\u001b[39m,\n  county: \u001b[32m'Dublin'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Core Functionality > handles POST requests with valid data\nOnboarding completion check: {\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  allStepsCompleted: \u001b[33mtrue\u001b[39m,\n  alreadyCompleted: \u001b[33mfalse\u001b[39m\n}\n\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Core Functionality > handles POST requests with valid data\nMarked onboarding complete for user bd041af5-512c-4ce9-8079-54f2305652ba\n\n ❯ tests/api/onboarding/signature/signature.test.ts (10 tests | 1 failed) 26192ms\n   ✓ /api/onboarding > Core Functionality > handles authenticated requests with real JWT tokens  4909ms\n   × /api/onboarding > Core Functionality > handles POST requests with valid data 2176ms\n     → expected 400 to be less than 300\n   ✓ /api/onboarding > Error States > returns proper error for unauthenticated requests 2ms\n   ✓ /api/onboarding > Security > requires valid JWT authentication 1ms\n   ✓ /api/onboarding > Security > validates JWT signature integrity 1ms\n   ✓ /api/onboarding > Performance > responds within acceptable time with real authentication  4214ms\n   ✓ /api/onboarding > Database Integrity > maintains data consistency with real database operations  3843ms\n   ✓ /api/onboarding > Integration Scenarios > integrates with authentication workflow  3981ms\n   ✓ /api/onboarding > Compliance > meets API standards with proper authentication  3313ms\n   ✓ /api/onboarding > Edge Cases > handles malformed requests appropriately  3748ms\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Compliance > validates Irish compliance requirements\nReceived data: {\n  firstName: \u001b[32m'Seán'\u001b[39m,\n  lastName: \u001b[32m'Ó Súilleabháin'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  ppsNumber: \u001b[32m'1234567T'\u001b[39m,\n  addressLine1: \u001b[32m'123 Sráid na hÉireann'\u001b[39m,\n  city: \u001b[32m'Baile Átha Cliath'\u001b[39m,\n  county: \u001b[32m'Átha Cliath'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Compliance > validates Irish compliance requirements\nCurrent user query result: {\n  id: \u001b[32m'860060b4-8538-4711-bfe3-98ceba1a0316'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013112064-67f92fe6@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T19:11:52.172Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T19:11:52.172Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Seán Ó Súilleabháin'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013112064-67f92fe6@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m'1234567T'\u001b[39m,\n  address_line_1: \u001b[32m'123 Sráid na hÉireann'\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m'Baile Átha Cliath'\u001b[39m,\n  county: \u001b[32m'Átha Cliath'\u001b[39m,\n  eircode: \u001b[32m'D01 X123'\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mfalse\u001b[39m,\n  error: ZodError: [\n    {\n      \"code\": \"invalid_value\",\n      \"values\": [\n        \"\",\n        \"Antrim\",\n        \"Armagh\",\n        \"Carlow\",\n        \"Cavan\",\n        \"Clare\",\n        \"Cork\",\n        \"Derry\",\n        \"Donegal\",\n        \"Down\",\n        \"Dublin\",\n        \"Fermanagh\",\n        \"Galway\",\n        \"Kerry\",\n        \"Kildare\",\n        \"Kilkenny\",\n        \"Laois\",\n        \"Leitrim\",\n        \"Limerick\",\n        \"Longford\",\n        \"Louth\",\n        \"Mayo\",\n        \"Meath\",\n        \"Monaghan\",\n        \"Offaly\",\n        \"Roscommon\",\n        \"Sligo\",\n        \"Tipperary\",\n        \"Tyrone\",\n        \"Waterford\",\n        \"Westmeath\",\n        \"Wexford\",\n        \"Wicklow\"\n      ],\n      \"path\": [\n        \"county\"\n      ],\n      \"message\": \"Invalid option: expected one of \\\"\\\"|\\\"Antrim\\\"|\\\"Armagh\\\"|\\\"Carlow\\\"|\\\"Cavan\\\"|\\\"Clare\\\"|\\\"Cork\\\"|\\\"Derry\\\"|\\\"Donegal\\\"|\\\"Down\\\"|\\\"Dublin\\\"|\\\"Fermanagh\\\"|\\\"Galway\\\"|\\\"Kerry\\\"|\\\"Kildare\\\"|\\\"Kilkenny\\\"|\\\"Laois\\\"|\\\"Leitrim\\\"|\\\"Limerick\\\"|\\\"Longford\\\"|\\\"Louth\\\"|\\\"Mayo\\\"|\\\"Meath\\\"|\\\"Monaghan\\\"|\\\"Offaly\\\"|\\\"Roscommon\\\"|\\\"Sligo\\\"|\\\"Tipperary\\\"|\\\"Tyrone\\\"|\\\"Waterford\\\"|\\\"Westmeath\\\"|\\\"Wexford\\\"|\\\"Wicklow\\\"\"\n    }\n  ]\n      at new ZodError \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/core/core.js:30:39\u001b[90m)\u001b[39m\n      at Module.<anonymous> \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/core/parse.js:40:20\u001b[90m)\u001b[39m\n      at _.inst.safeParse \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/zod@4.0.17/node_modules/\u001b[4mzod\u001b[24m/v4/classic/schemas.js:30:46\u001b[90m)\u001b[39m\n      at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/personal-info/route.ts:288:49\u001b[90m)\u001b[39m\n  \u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n      at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/personal-info/personal-info.test.ts:397:24\n      at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n}\n\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Core Functionality > handles POST requests with valid data\n=== CONSENT SIGNATURE API HIT ===\n\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Core Functionality > handles POST requests with valid data\nSession check: {\n  isAuthenticated: \u001b[33mtrue\u001b[39m,\n  userId: \u001b[32m'830eb261-edb9-4a7c-b122-911dbc487f64'\u001b[39m\n}\n\n ❯ tests/api/debug/verification/verification.test.ts (10 tests | 3 failed) 28198ms\n   ✓ /api/debug/verification > Core Functionality > handles GET requests with valid authentication  5450ms\n   × /api/debug/verification > Core Functionality > handles POST requests with valid data 2848ms\n     → POST is not a function\n   × /api/debug/verification > Error States > returns proper error for unauthenticated requests 57ms\n     → POST is not a function\n   ✓ /api/debug/verification > Security > requires valid JWT authentication 3ms\n   ✓ /api/debug/verification > Security > validates JWT signature integrity 6ms\n   ✓ /api/debug/verification > Performance > responds within acceptable time with real authentication  3728ms\n   ✓ /api/debug/verification > Database Integrity > maintains data consistency with real database operations  4326ms\n   ✓ /api/debug/verification > Integration Scenarios > integrates with authentication workflow  3550ms\n   ✓ /api/debug/verification > Compliance > meets API standards with proper authentication  4082ms\n   × /api/debug/verification > Edge Cases > handles malformed JSON appropriately 4124ms\n     → POST is not a function\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Edge Cases > handles malformed JSON appropriately\nOnboarding completion check: {\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  allStepsCompleted: \u001b[33mtrue\u001b[39m,\n  alreadyCompleted: \u001b[33mfalse\u001b[39m\n}\n\nstdout | tests/api/onboarding/complete/complete.test.ts > /api/onboarding/complete > Edge Cases > handles malformed JSON appropriately\nMarked onboarding complete for user 30a9b24d-607a-4389-ab77-9b6af3fa973a\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow\nReceived data: {\n  firstName: \u001b[32m'Test'\u001b[39m,\n  lastName: \u001b[32m'User'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m,\n  photoMarkedForDeletion: \u001b[33mtrue\u001b[39m,\n  photo_url: \u001b[1mnull\u001b[22m\n}\n\n ❯ tests/api/onboarding/complete/complete.test.ts (10 tests | 9 failed) 28282ms\n   × /api/onboarding/complete > Core Functionality > handles GET requests with valid authentication 4917ms\n     → GET is not a function\n   ✓ /api/onboarding/complete > Core Functionality > handles POST requests with valid data  3080ms\n   × /api/onboarding/complete > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/onboarding/complete > Security > requires valid JWT authentication 0ms\n     → GET is not a function\n   × /api/onboarding/complete > Security > validates JWT signature integrity 1ms\n     → GET is not a function\n   × /api/onboarding/complete > Performance > responds within acceptable time with real authentication 3944ms\n     → GET is not a function\n   × /api/onboarding/complete > Database Integrity > maintains data consistency with real database operations 3089ms\n     → GET is not a function\n   × /api/onboarding/complete > Integration Scenarios > integrates with authentication workflow 3946ms\n     → GET is not a function\n   × /api/onboarding/complete > Compliance > meets API standards with proper authentication 3946ms\n     → GET is not a function\n   × /api/onboarding/complete > Edge Cases > handles malformed JSON appropriately 5349ms\n     → expected 200 to be greater than or equal to 400\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow\nCurrent user query result: {\n  id: \u001b[32m'87bf0bd4-d757-4b37-a3c7-bb2da93a3ea2'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013122597-547acf30@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T19:12:02.681Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T19:12:02.681Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Test User'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013122597-547acf30@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m''\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m''\u001b[39m,\n  county: \u001b[32m''\u001b[39m,\n  eircode: \u001b[32m''\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Test User'\u001b[39m,\n    email: \u001b[32m'test-auth-1757013122597-547acf30@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m''\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m''\u001b[39m,\n    county: \u001b[32m''\u001b[39m,\n    eircode: \u001b[32m''\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\n ❯ tests/api/auth/refresh/refresh.test.ts (10 tests | 1 failed) 27934ms\n   ✓ /api/auth > Core Functionality > handles authenticated requests with real JWT tokens  4275ms\n   × /api/auth > Core Functionality > handles POST requests with valid data 3533ms\n     → expected 401 to be less than 300\n   ✓ /api/auth > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/auth > Security > requires valid JWT authentication 0ms\n   ✓ /api/auth > Security > validates JWT signature integrity 1ms\n   ✓ /api/auth > Performance > responds within acceptable time with real authentication  3442ms\n   ✓ /api/auth > Database Integrity > maintains data consistency with real database operations  3072ms\n   ✓ /api/auth > Integration Scenarios > integrates with authentication workflow  4448ms\n   ✓ /api/auth > Compliance > meets API standards with proper authentication  4626ms\n   ✓ /api/auth > Edge Cases > handles malformed requests appropriately  4529ms\n ❯ tests/api/onboarding/verification/verification.test.ts (10 tests | 1 failed) 29308ms\n   ✓ /api/onboarding > Core Functionality > handles authenticated requests with real JWT tokens  5491ms\n   × /api/onboarding > Core Functionality > handles POST requests with valid data 3013ms\n     → expected 400 to be less than 300\n   ✓ /api/onboarding > Error States > returns proper error for unauthenticated requests 2ms\n   ✓ /api/onboarding > Security > requires valid JWT authentication 1ms\n   ✓ /api/onboarding > Security > validates JWT signature integrity 1ms\n   ✓ /api/onboarding > Performance > responds within acceptable time with real authentication  4054ms\n   ✓ /api/onboarding > Database Integrity > maintains data consistency with real database operations  3481ms\n   ✓ /api/onboarding > Integration Scenarios > integrates with authentication workflow  4854ms\n   ✓ /api/onboarding > Compliance > meets API standards with proper authentication  4617ms\n   ✓ /api/onboarding > Edge Cases > handles malformed requests appropriately  3783ms\n ❯ tests/api/rules/[id]/[id].test.ts (11 tests | 3 failed) 29339ms\n   × /api/rules/[id] > Core Functionality > handles GET requests with valid authentication 6049ms\n     → expected 500 to be less than 300\n   × /api/rules/[id] > Core Functionality > handles PUT requests with valid data 4029ms\n     → expected 500 to be less than 300\n   × /api/rules/[id] > Core Functionality > handles DELETE requests with authentication 2465ms\n     → expected 500 to be less than 500\n   ✓ /api/rules/[id] > Error States > returns proper error for unauthenticated requests 3ms\n   ✓ /api/rules/[id] > Security > requires valid JWT authentication 2ms\n   ✓ /api/rules/[id] > Security > validates JWT signature integrity 1ms\n   ✓ /api/rules/[id] > Performance > responds within acceptable time with real authentication  3242ms\n   ✓ /api/rules/[id] > Database Integrity > maintains data consistency with real database operations  4212ms\n   ✓ /api/rules/[id] > Integration Scenarios > integrates with authentication workflow  4591ms\n   ✓ /api/rules/[id] > Compliance > meets API standards with proper authentication  4738ms\n   ✓ /api/rules/[id] > Edge Cases > handles edge cases appropriately 1ms\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately\n=== CONSENT SIGNATURE API HIT ===\n\nstdout | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately\nSession check: {\n  isAuthenticated: \u001b[33mtrue\u001b[39m,\n  userId: \u001b[32m'13f86f93-9ca8-4724-a875-453770a61556'\u001b[39m\n}\n\n ❯ tests/api/onboarding/consent-signature/consent-signature.test.ts (10 tests | 9 failed) 27453ms\n   × /api/onboarding/consent-signature > Core Functionality > handles GET requests with valid authentication 5561ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Core Functionality > handles POST requests with valid data 4144ms\n     → expected 400 to be less than 300\n   × /api/onboarding/consent-signature > Error States > returns proper error for unauthenticated requests 2ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Security > requires valid JWT authentication 1ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Security > validates JWT signature integrity 1ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Performance > responds within acceptable time with real authentication 3872ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Database Integrity > maintains data consistency with real database operations 3600ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Integration Scenarios > integrates with authentication workflow 2057ms\n     → GET is not a function\n   × /api/onboarding/consent-signature > Compliance > meets API standards with proper authentication 3965ms\n     → GET is not a function\n   ✓ /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately  4245ms\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Token Management > maintains session consistency across operations\nReceived data: {\n  firstName: \u001b[32m'Test'\u001b[39m,\n  lastName: \u001b[32m'User'\u001b[39m,\n  phoneNumber: \u001b[32m'+353871234567'\u001b[39m,\n  dateOfBirth: \u001b[32m'1990-01-01'\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Token Management > maintains session consistency across operations\nCurrent user query result: {\n  id: \u001b[32m'6cec8fcf-126a-4055-b49e-31da88e4ddf8'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013140206-bf5e9c51@example.com'\u001b[39m,\n  password_hash: \u001b[1mnull\u001b[22m,\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  onboarding_status: \u001b[32m'not_started'\u001b[39m,\n  onboarding_current_step: \u001b[32m'personal_info'\u001b[39m,\n  onboarding_completed_at: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m,\n  personal_info_completed_at: \u001b[1mnull\u001b[22m,\n  signature_completed: \u001b[33mtrue\u001b[39m,\n  signature_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consent_completed: \u001b[33mtrue\u001b[39m,\n  legal_consent_completed_at: \u001b[1mnull\u001b[22m,\n  legal_consents: \u001b[1mnull\u001b[22m,\n  verification_completed: \u001b[33mtrue\u001b[39m,\n  verification_completed_at: \u001b[1mnull\u001b[22m,\n  verification_session_id: \u001b[1mnull\u001b[22m,\n  verification_status: \u001b[32m'verified'\u001b[39m,\n  onboarding_completed: \u001b[33mtrue\u001b[39m,\n  auth_provider: \u001b[1mnull\u001b[22m,\n  auth_provider_id: \u001b[1mnull\u001b[22m,\n  created_at: \u001b[35m2025-09-04T19:12:20.277Z\u001b[39m,\n  updated_at: \u001b[35m2025-09-04T19:12:20.277Z\u001b[39m\n}\nValidation data: {\n  name: \u001b[32m'Test User'\u001b[39m,\n  email: \u001b[32m'test-auth-1757013140206-bf5e9c51@example.com'\u001b[39m,\n  phone: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[32m''\u001b[39m,\n  address_line_1: \u001b[32m''\u001b[39m,\n  address_line_2: \u001b[32m''\u001b[39m,\n  city: \u001b[32m''\u001b[39m,\n  county: \u001b[32m''\u001b[39m,\n  eircode: \u001b[32m''\u001b[39m,\n  country: \u001b[32m'Ireland'\u001b[39m\n}\nValidation result: {\n  success: \u001b[33mtrue\u001b[39m,\n  data: {\n    name: \u001b[32m'Test User'\u001b[39m,\n    email: \u001b[32m'test-auth-1757013140206-bf5e9c51@example.com'\u001b[39m,\n    phone: \u001b[32m'+353871234567'\u001b[39m,\n    pps_number: \u001b[32m''\u001b[39m,\n    address_line_1: \u001b[32m''\u001b[39m,\n    address_line_2: \u001b[32m''\u001b[39m,\n    city: \u001b[32m''\u001b[39m,\n    county: \u001b[32m''\u001b[39m,\n    eircode: \u001b[32m''\u001b[39m,\n    country: \u001b[32m'Ireland'\u001b[39m,\n    date_of_birth: \u001b[32m'1990-01-01'\u001b[39m\n  }\n}\nOld data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nNew data: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\nstdout | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Token Management > maintains session consistency across operations\nAbout to compare fields - oldData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[1mnull\u001b[22m,\n  date_of_birth: \u001b[1mnull\u001b[22m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\nAbout to compare fields - newData: {\n  first_name: \u001b[32m'Test'\u001b[39m,\n  last_name: \u001b[32m'User'\u001b[39m,\n  phone_number: \u001b[32m'+353871234567'\u001b[39m,\n  date_of_birth: \u001b[32m'1990-01-01'\u001b[39m,\n  pps_number: \u001b[1mnull\u001b[22m,\n  address_line_1: \u001b[1mnull\u001b[22m,\n  address_line_2: \u001b[1mnull\u001b[22m,\n  city: \u001b[1mnull\u001b[22m,\n  county: \u001b[1mnull\u001b[22m,\n  eircode: \u001b[1mnull\u001b[22m,\n  profile_photo_url: \u001b[1mnull\u001b[22m,\n  personal_info_completed: \u001b[33mtrue\u001b[39m\n}\n\n ❯ tests/api/onboarding/personal-info/personal-info.test.ts (25 tests | 9 failed) 82533ms\n   × /api/onboarding/personal-info > Core Functionality > handles GET requests with valid authentication 492ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: f002d540-b779-4840-a7fb-de5dce4a5708,test-auth-1757013064823-a44e9dc5@example.com,Test,User,true,true,true,true,verified\n   × /api/onboarding/personal-info > Core Functionality > returns completion status correctly 647ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: 15e2b64e-f68f-4bf0-9680-7be60adbfe66,test-auth-1757013065313-7db6781b@example.com,Test,User,true,false,false,false,verified\n   × /api/onboarding/personal-info > Core Functionality > handles POST requests with valid personal info data 373ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: 5bc8f548-9ff1-4854-bf81-fe8eb1363cbf,test-auth-1757013065960-f13e85fb@example.com,Test,User,true,true,true,true,verified\n   ✓ /api/onboarding/personal-info > Error States > returns 401 for unauthenticated GET requests 124ms\n   ✓ /api/onboarding/personal-info > Error States > returns 401 for unauthenticated POST requests 148ms\n   × /api/onboarding/personal-info > Error States > validates required personal info fields 308ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: ff113fb8-ecf6-4ff4-a093-8e5ce17346de,test-auth-1757013066606-d928db93@example.com,Test,User,true,true,true,true,verified\n   ✓ /api/onboarding/personal-info > Security > requires valid JWT authentication for GET  2468ms\n   ✓ /api/onboarding/personal-info > Security > requires valid JWT authentication for POST  945ms\n   ✓ /api/onboarding/personal-info > Security > validates JWT signature integrity  727ms\n   × /api/onboarding/personal-info > Security > prevents OAuth email tampering 398ms\n     → Failed query: insert into \"app_users\" (\"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\") values ($1, $2, default, $3, $4, default, default, default, default, default, default, default, default, default, default, default, default, $5, default, $6, default, $7, default, default, $8, default, default, $9, default, default, default, default) returning \"id\", \"email\", \"password_hash\", \"first_name\", \"last_name\", \"phone_number\", \"date_of_birth\", \"pps_number\", \"profile_photo_url\", \"address_line_1\", \"address_line_2\", \"city\", \"county\", \"eircode\", \"onboarding_status\", \"onboarding_current_step\", \"onboarding_completed_at\", \"personal_info_completed\", \"personal_info_completed_at\", \"signature_completed\", \"signature_completed_at\", \"legal_consent_completed\", \"legal_consent_completed_at\", \"legal_consents\", \"verification_completed\", \"verification_completed_at\", \"verification_session_id\", \"verification_status\", \"onboarding_completed\", \"auth_provider\", \"auth_provider_id\", \"created_at\", \"updated_at\"\nparams: 06349c01-5008-4566-8485-27d9386baec6,original@example.com,Test,User,true,true,true,true,verified\n   ✓ /api/onboarding/personal-info > Performance > responds within acceptable time with real authentication  4589ms\n   × /api/onboarding/personal-info > Performance > handles concurrent requests efficiently 6186ms\n     → expected 3017.7380839999987 to be less than 3000\n   ✓ /api/onboarding/personal-info > Database Integrity > maintains user data consistency with real database operations  4325ms\n   ✓ /api/onboarding/personal-info > Database Integrity > creates proper audit trail for personal info updates  5480ms\n   × /api/onboarding/personal-info > Integration Scenarios > integrates with OAuth data source tracking 4838ms\n     → expected false to be true // Object.is equality\n   ✓ /api/onboarding/personal-info > Integration Scenarios > handles complete onboarding workflow progression  5662ms\n   ✓ /api/onboarding/personal-info > Compliance > meets API standards with proper authentication  5308ms\n   ✓ /api/onboarding/personal-info > Compliance > follows REST API conventions  4222ms\n   × /api/onboarding/personal-info > Compliance > validates Irish compliance requirements 5775ms\n     → expected 400 to be less than 300\n   ✓ /api/onboarding/personal-info > Edge Cases > handles requests with malformed JSON  4758ms\n   ✓ /api/onboarding/personal-info > Edge Cases > handles photo deletion workflow  5293ms\n   × /api/onboarding/personal-info > Edge Cases > handles users with incomplete profile data 5487ms\n     → expected 'Test' to be '' // Object.is equality\n   ✓ /api/onboarding/personal-info > Token Management > validates access token structure and claims  5889ms\n   ✓ /api/onboarding/personal-info > Token Management > handles expired tokens appropriately  942ms\n   ✓ /api/onboarding/personal-info > Token Management > maintains session consistency across operations  7142ms\n ❯ tests/api/audit/log-event/log-event.test.ts (10 tests | 9 failed) 29216ms\n   × /api/audit/log-event > Core Functionality > handles GET requests with valid authentication 5450ms\n     → GET is not a function\n   ✓ /api/audit/log-event > Core Functionality > handles POST requests with valid data  3738ms\n   × /api/audit/log-event > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/audit/log-event > Security > requires valid JWT authentication 1ms\n     → GET is not a function\n   × /api/audit/log-event > Security > validates JWT signature integrity 1ms\n     → GET is not a function\n   × /api/audit/log-event > Performance > responds within acceptable time with real authentication 4322ms\n     → GET is not a function\n   × /api/audit/log-event > Database Integrity > maintains data consistency with real database operations 4107ms\n     → GET is not a function\n   × /api/audit/log-event > Integration Scenarios > integrates with authentication workflow 3572ms\n     → GET is not a function\n   × /api/audit/log-event > Compliance > meets API standards with proper authentication 3975ms\n     → GET is not a function\n   × /api/audit/log-event > Edge Cases > handles malformed JSON appropriately 4042ms\n     → expected 200 to be greater than or equal to 400\n ❯ tests/api/auth/google/google.test.ts (10 tests | 6 failed) 28619ms\n   × /api/auth/google > Core Functionality > handles GET requests with valid authentication 4459ms\n     → expected 307 to be less than 300\n   × /api/auth/google > Core Functionality > handles POST requests with valid data 4290ms\n     → POST is not a function\n   × /api/auth/google > Error States > returns proper error for unauthenticated requests 1ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google > Security > requires valid JWT authentication 1ms\n     → expected 307 to be greater than or equal to 400\n   × /api/auth/google > Security > validates JWT signature integrity 1ms\n     → expected 307 to be greater than or equal to 400\n   ✓ /api/auth/google > Performance > responds within acceptable time with real authentication  3906ms\n   ✓ /api/auth/google > Database Integrity > maintains data consistency with real database operations  4512ms\n   ✓ /api/auth/google > Integration Scenarios > integrates with authentication workflow  4109ms\n   ✓ /api/auth/google > Compliance > meets API standards with proper authentication  3761ms\n   × /api/auth/google > Edge Cases > handles malformed JSON appropriately 3570ms\n     → POST is not a function\n ❯ tests/api/onboarding/photo/photo.test.ts (10 tests | 1 failed) 28523ms\n   ✓ /api/onboarding > Core Functionality > handles authenticated requests with real JWT tokens  4823ms\n   × /api/onboarding > Core Functionality > handles POST requests with valid data 4258ms\n     → expected 500 to be less than 300\n   ✓ /api/onboarding > Error States > returns proper error for unauthenticated requests 1ms\n   ✓ /api/onboarding > Security > requires valid JWT authentication 0ms\n   ✓ /api/onboarding > Security > validates JWT signature integrity 1ms\n   ✓ /api/onboarding > Performance > responds within acceptable time with real authentication  3890ms\n   ✓ /api/onboarding > Database Integrity > maintains data consistency with real database operations  3927ms\n   ✓ /api/onboarding > Integration Scenarios > integrates with authentication workflow  3858ms\n   ✓ /api/onboarding > Compliance > meets API standards with proper authentication  3768ms\n   ✓ /api/onboarding > Edge Cases > handles malformed requests appropriately  3991ms\n ❯ tests/api/beneficiaries/photo/photo.test.ts (10 tests | 9 failed) 29676ms\n   × /api/beneficiaries/photo > Core Functionality > handles GET requests with valid authentication 5644ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Core Functionality > handles POST requests with valid data 4220ms\n     → expected 500 to be less than 300\n   × /api/beneficiaries/photo > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Security > requires valid JWT authentication 1ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Security > validates JWT signature integrity 1ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Performance > responds within acceptable time with real authentication 3841ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Database Integrity > maintains data consistency with real database operations 4429ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Integration Scenarios > integrates with authentication workflow 4174ms\n     → GET is not a function\n   × /api/beneficiaries/photo > Compliance > meets API standards with proper authentication 3241ms\n     → GET is not a function\n   ✓ /api/beneficiaries/photo > Edge Cases > handles malformed JSON appropriately  4119ms\n ❯ tests/api/auth/logout/logout.test.ts (10 tests | 9 failed) 30913ms\n   × /api/auth/logout > Core Functionality > handles GET requests with valid authentication 5238ms\n     → GET is not a function\n   ✓ /api/auth/logout > Core Functionality > handles POST requests with valid data  4251ms\n   × /api/auth/logout > Error States > returns proper error for unauthenticated requests 1ms\n     → GET is not a function\n   × /api/auth/logout > Security > requires valid JWT authentication 1ms\n     → GET is not a function\n   × /api/auth/logout > Security > validates JWT signature integrity 2ms\n     → GET is not a function\n   × /api/auth/logout > Performance > responds within acceptable time with real authentication 4261ms\n     → GET is not a function\n   × /api/auth/logout > Database Integrity > maintains data consistency with real database operations 4147ms\n     → GET is not a function\n   × /api/auth/logout > Integration Scenarios > integrates with authentication workflow 4012ms\n     → GET is not a function\n   × /api/auth/logout > Compliance > meets API standards with proper authentication 4055ms\n     → GET is not a function\n   × /api/auth/logout > Edge Cases > handles malformed JSON appropriately 4939ms\n     → expected 200 to be greater than or equal to 400\n ❯ tests/api/debug-user/debug-user.test.ts (10 tests | 4 failed) 29633ms\n   × /api/debug-user > Core Functionality > handles GET requests with valid authentication 6827ms\n     → expected 400 to be less than 300\n   × /api/debug-user > Core Functionality > handles POST requests with valid data 3535ms\n     → POST is not a function\n   × /api/debug-user > Error States > returns proper error for unauthenticated requests 2ms\n     → POST is not a function\n   ✓ /api/debug-user > Security > requires valid JWT authentication 1ms\n   ✓ /api/debug-user > Security > validates JWT signature integrity 1ms\n   ✓ /api/debug-user > Performance > responds within acceptable time with real authentication  3855ms\n   ✓ /api/debug-user > Database Integrity > maintains data consistency with real database operations  3929ms\n   ✓ /api/debug-user > Integration Scenarios > integrates with authentication workflow  3573ms\n   ✓ /api/debug-user > Compliance > meets API standards with proper authentication  4467ms\n   × /api/debug-user > Edge Cases > handles malformed JSON appropriately 3430ms\n     → POST is not a function\n ❯ tests/api/auth/register/register.test.ts (10 tests | 1 failed) 27219ms\n   ✓ /api/auth > Core Functionality > handles authenticated requests with real JWT tokens  6916ms\n   × /api/auth > Core Functionality > handles POST requests with valid data 3554ms\n     → expected 400 to be less than 300\n   ✓ /api/auth > Error States > returns proper error for unauthenticated requests 2ms\n   ✓ /api/auth > Security > requires valid JWT authentication 1ms\n   ✓ /api/auth > Security > validates JWT signature integrity 1ms\n   ✓ /api/auth > Performance > responds within acceptable time with real authentication  3776ms\n   ✓ /api/auth > Database Integrity > maintains data consistency with real database operations  3568ms\n   ✓ /api/auth > Integration Scenarios > integrates with authentication workflow  3012ms\n   ✓ /api/auth > Compliance > meets API standards with proper authentication  2500ms\n   ✓ /api/auth > Edge Cases > handles malformed requests appropriately  3882ms\n ❯ tests/api/auth/login/login.test.ts (10 tests | 1 failed) 25789ms\n   ✓ /api/auth > Core Functionality > handles authenticated requests with real JWT tokens  5296ms\n   × /api/auth > Core Functionality > handles POST requests with valid data 3832ms\n     → expected 400 to be less than 300\n   ✓ /api/auth > Error States > returns proper error for unauthenticated requests 2ms\n   ✓ /api/auth > Security > requires valid JWT authentication 1ms\n   ✓ /api/auth > Security > validates JWT signature integrity 1ms\n   ✓ /api/auth > Performance > responds within acceptable time with real authentication  3540ms\n   ✓ /api/auth > Database Integrity > maintains data consistency with real database operations  3241ms\n   ✓ /api/auth > Integration Scenarios > integrates with authentication workflow  3228ms\n   ✓ /api/auth > Compliance > meets API standards with proper authentication  2543ms\n   ✓ /api/auth > Edge Cases > handles malformed requests appropriately  4097ms\nstderr | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Error States > returns 401 for unauthenticated GET requests\nAudit logging failed: DrizzleQueryError: Failed query: SET app.current_session_id = '70ece331-abb3-4666-b933-49af0b6c61b0'\nparams: \n    at PostgresJsPreparedQuery.queryWithCache \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/pg-core/session.ts:73:11\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at AuditLogger.logEvent \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/audit-middleware.ts:46:9\u001b[90m)\u001b[39m\n    at Object.logSecurityEvent \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/audit-middleware.ts:299:5\u001b[90m)\u001b[39m\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/personal-info/route.ts:25:7\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/personal-info/personal-info.test.ts:105:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20 {\n  query: \u001b[32m\"SET app.current_session_id = '70ece331-abb3-4666-b933-49af0b6c61b0'\"\u001b[39m,\n  params: [],\n  cause: AggregateError: \n  \u001b[90m    at internalConnectMultiple (node:net:1139:18)\u001b[39m\n  \u001b[90m    at afterConnectMultiple (node:net:1712:7)\u001b[39m {\n    code: \u001b[32m'ECONNREFUSED'\u001b[39m,\n    [errors]: [ \u001b[36m[Error]\u001b[39m, \u001b[36m[Error]\u001b[39m ]\n  }\n}\n\nstderr | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Error States > returns 401 for unauthenticated POST requests\nAudit logging failed: DrizzleQueryError: Failed query: SET app.current_session_id = 'd3cda752-9fa9-4d82-9857-29657dea56f9'\nparams: \n    at PostgresJsPreparedQuery.queryWithCache \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/pg-core/session.ts:73:11\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at AuditLogger.logEvent \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/audit-middleware.ts:46:9\u001b[90m)\u001b[39m\n    at Object.logSecurityEvent \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/audit-middleware.ts:299:5\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/personal-info/route.ts:165:7\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/personal-info/personal-info.test.ts:120:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20 {\n  query: \u001b[32m\"SET app.current_session_id = 'd3cda752-9fa9-4d82-9857-29657dea56f9'\"\u001b[39m,\n  params: [],\n  cause: AggregateError: \n  \u001b[90m    at internalConnectMultiple (node:net:1139:18)\u001b[39m\n  \u001b[90m    at afterConnectMultiple (node:net:1712:7)\u001b[39m {\n    code: \u001b[32m'ECONNREFUSED'\u001b[39m,\n    [errors]: [ \u001b[36m[Error]\u001b[39m, \u001b[36m[Error]\u001b[39m ]\n  }\n}\n\nstderr | tests/api/rules/rules.test.ts > /api/rules > Edge Cases > handles malformed JSON appropriately\nError creating rule: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/route.ts:130:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/rules.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/beneficiaries/beneficiaries.test.ts > /api/beneficiaries > Edge Cases > handles malformed requests appropriately\nError creating beneficiary: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/beneficiaries/route.ts:107:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/beneficiaries/beneficiaries.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles GET requests with valid authentication\nError fetching rule: DrizzleQueryError: Failed query: select \"id\", \"user_id\", \"name\", \"description\", \"rule_definition\", \"priority\", \"is_active\", \"created_at\", \"updated_at\" from \"inheritance_rules\" where (\"inheritance_rules\".\"id\" = $1 and \"inheritance_rules\".\"user_id\" = $2)\nparams: test-id-123,\n    at PostgresJsPreparedQuery.queryWithCache \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/pg-core/session.ts:73:11\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/postgres-js/session.ts:58:17\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:54:20\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:27:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20 {\n  query: \u001b[32m'select \"id\", \"user_id\", \"name\", \"description\", \"rule_definition\", \"priority\", \"is_active\", \"created_at\", \"updated_at\" from \"inheritance_rules\" where (\"inheritance_rules\".\"id\" = $1 and \"inheritance_rules\".\"user_id\" = $2)'\u001b[39m,\n  params: [ \u001b[32m'test-id-123'\u001b[39m, \u001b[90mundefined\u001b[39m ],\n  cause: Error: UNDEFINED_VALUE: Undefined values are not allowed\n      at handleValue \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/types.js:83:20\u001b[90m)\u001b[39m\n      at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:225:38\n      at Array.forEach (<anonymous>)\n      at build \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:225:25\u001b[90m)\u001b[39m\n      at Object.execute \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:167:7\u001b[90m)\u001b[39m\n      at go \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/index.js:345:14\u001b[90m)\u001b[39m\n      at Query.handler \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/index.js:334:14\u001b[90m)\u001b[39m\n      at Query.handle \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/query.js:140:65\u001b[90m)\u001b[39m\n  \u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m {\n    code: \u001b[32m'UNDEFINED_VALUE'\u001b[39m\n  }\n}\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles PUT requests with valid data\nError updating rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.PUT \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:108:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:43:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/signature/signature.test.ts > /api/onboarding > Edge Cases > handles malformed requests appropriately\nSignature save error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/signature/route.ts:74:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/signature/signature.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Core Functionality > handles DELETE requests with authentication\nError deleting rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.DELETE \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:267:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:52:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Error States > returns proper error for unauthenticated requests\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:64:27\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Security > requires valid JWT authentication\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:74:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Security > validates JWT signature integrity\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:87:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Performance > responds within acceptable time with real authentication\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:99:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Database Integrity > maintains data consistency with real database operations\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:112:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Integration Scenarios > integrates with authentication workflow\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:123:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/personal-info/personal-info.test.ts > /api/onboarding/personal-info > Edge Cases > handles requests with malformed JSON\nPersonal info save error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/personal-info/route.ts:184:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/personal-info/personal-info.test.ts:412:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/rules/[id]/[id].test.ts > /api/rules/[id] > Compliance > meets API standards with proper authentication\nError fetching rule: TypeError: Cannot read properties of undefined (reading 'id')\n    at Module.GET \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/rules/[id]/route.ts:58:76\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/rules/[id]/[id].test.ts:134:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Core Functionality > handles POST requests with valid data\nAudit logging error: DrizzleQueryError: Failed query: insert into \"audit_events\" (\"id\", \"user_id\", \"event_type\", \"event_action\", \"resource_type\", \"resource_id\", \"event_data\", \"old_data\", \"new_data\", \"ip_address\", \"user_agent\", \"session_id\", \"event_time\") values (default, $1, default, default, default, default, $2, default, default, $3, $4, default, default)\nparams: a02ac67f-e19d-4b13-8197-73166f42725c,{},unknown,unknown\n    at PostgresJsPreparedQuery.queryWithCache \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/drizzle-orm@0.44.4_@types+pg@8.15.5_postgres@3.4.7/node_modules/\u001b[4msrc\u001b[24m/pg-core/session.ts:73:11\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/audit/log-event/route.ts:33:5\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/audit/log-event/log-event.test.ts:42:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20 {\n  query: \u001b[32m'insert into \"audit_events\" (\"id\", \"user_id\", \"event_type\", \"event_action\", \"resource_type\", \"resource_id\", \"event_data\", \"old_data\", \"new_data\", \"ip_address\", \"user_agent\", \"session_id\", \"event_time\") values (default, $1, default, default, default, default, $2, default, default, $3, $4, default, default)'\u001b[39m,\n  params: [\n    \u001b[32m'a02ac67f-e19d-4b13-8197-73166f42725c'\u001b[39m,\n    \u001b[32m'{}'\u001b[39m,\n    \u001b[32m'unknown'\u001b[39m,\n    \u001b[32m'unknown'\u001b[39m\n  ],\n  cause: PostgresError: null value in column \"event_type\" of relation \"audit_events\" violates not-null constraint\n      at ErrorResponse \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:794:26\u001b[90m)\u001b[39m\n      at handle \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:480:6\u001b[90m)\u001b[39m\n      at Socket.data \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/postgres@3.4.7/node_modules/\u001b[4mpostgres\u001b[24m/src/connection.js:315:9\u001b[90m)\u001b[39m\n  \u001b[90m    at Socket.emit (node:events:507:28)\u001b[39m\n  \u001b[90m    at addChunk (node:internal/streams/readable:559:12)\u001b[39m\n  \u001b[90m    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)\u001b[39m\n  \u001b[90m    at Socket.Readable.push (node:internal/streams/readable:390:5)\u001b[39m\n  \u001b[90m    at TCP.onStreamRead (node:internal/stream_base_commons:189:23)\u001b[39m {\n    severity_local: \u001b[32m'ERROR'\u001b[39m,\n    severity: \u001b[32m'ERROR'\u001b[39m,\n    code: \u001b[32m'23502'\u001b[39m,\n    detail: \u001b[32m'Failing row contains (35044b9d-a01d-4467-8a05-54c7f08f0f53, a02ac67f-e19d-4b13-8197-73166f42725c, null, null, null, null, {}, null, null, unknown, unknown, null, 2025-09-04 19:12:06.853657).'\u001b[39m,\n    schema_name: \u001b[32m'public'\u001b[39m,\n    table_name: \u001b[32m'audit_events'\u001b[39m,\n    column_name: \u001b[32m'event_type'\u001b[39m,\n    file: \u001b[32m'execMain.c'\u001b[39m,\n    line: \u001b[32m'1982'\u001b[39m,\n    routine: \u001b[32m'ExecConstraints'\u001b[39m\n  }\n}\n\nstderr | tests/api/onboarding/photo/photo.test.ts > /api/onboarding > Core Functionality > handles POST requests with valid data\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/photo/photo.test.ts:52:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/consent-signature/consent-signature.test.ts > /api/onboarding/consent-signature > Edge Cases > handles malformed JSON appropriately\nConsent signature save error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/consent-signature/route.ts:27:18\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/consent-signature/consent-signature.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Core Functionality > handles POST requests with valid data\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/beneficiaries/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/beneficiaries/photo/photo.test.ts:42:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/audit/log-event/log-event.test.ts > /api/audit/log-event > Edge Cases > handles malformed JSON appropriately\nAudit logging error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/audit/log-event/route.ts:10:7\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/audit/log-event/log-event.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/onboarding/photo/photo.test.ts > /api/onboarding > Edge Cases > handles malformed requests appropriately\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/onboarding/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/onboarding/photo/photo.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/beneficiaries/photo/photo.test.ts > /api/beneficiaries/photo > Edge Cases > handles malformed JSON appropriately\nPhoto upload error: DOMException [InvalidStateError]: Failed to construct FormData object: The \"content-type\" header is neither \"application/x-www-form-urlencoded\" nor \"multipart/form-data\".\n    at NextRequest.formData \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:473:9\u001b[90m)\u001b[39m\n    at Module.POST \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/beneficiaries/photo/route.ts:18:36\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/beneficiaries/photo/photo.test.ts:148:24\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/auth/register/register.test.ts > /api/auth > Edge Cases > handles malformed requests appropriately\nRegistration error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at registerHandler \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/auth/register/route.ts:11:54\u001b[90m)\u001b[39m\n    at Module.<anonymous> \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/rate-limit.ts:111:22\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/auth/register/register.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\nstderr | tests/api/auth/login/login.test.ts > /api/auth > Edge Cases > handles malformed requests appropriately\nLogin error: SyntaxError: Unexpected token 'j', \"{\"malformed\": json}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at NextRequest.json \u001b[90m(file:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/happy-dom@18.0.1/node_modules/\u001b[4mhappy-dom\u001b[24m/src/fetch/Request.ts:419:15\u001b[90m)\u001b[39m\n\u001b[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)\u001b[39m\n    at loginHandler \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/api/auth/login/route.ts:11:33\u001b[90m)\u001b[39m\n    at Module.<anonymous> \u001b[90m(/Users/dean/code/Herit/\u001b[39mapp/lib/rate-limit.ts:111:22\u001b[90m)\u001b[39m\n    at \u001b[90m/Users/dean/code/Herit/\u001b[39mtests/api/auth/login/login.test.ts:188:26\n    at \u001b[90mfile:///Users/dean/code/Herit/\u001b[39mnode_modules/\u001b[4m.pnpm\u001b[24m/@vitest+runner@3.2.4/node_modules/\u001b[4m@vitest\u001b[24m/runner/dist/chunk-hooks.js:752:20\n\n",
      "startTime": 1757013059830,
      "endTime": 1757013179870,
      "duration": 120040,
      "error": "Process exited with code 143",
      "individualTests": {
        "total": 236,
        "passed": 141,
        "failed": 95,
        "skipped": 0,
        "passRate": 60,
        "progress": 90
      }
    },
    "linting": {
      "command": "npm run lint",
      "status": "completed",
      "output": "\n> herit@0.1.0 lint\n> eslint --fix\n\n\n/Users/dean/code/Herit/app/(auth)/layout.tsx\n  1:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(auth)/login/page.tsx\n  22:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/LegalConsentStep.tsx\n  199:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/PersonalInfoStep.cy.tsx\n  23:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/PersonalInfoStep.tsx\n  120:11  warning  Unexpected console statement  no-console\n  142:25  warning  Unexpected console statement  no-console\n  224:27  warning  Unexpected console statement  no-console\n  252:25  warning  Unexpected console statement  no-console\n  273:25  warning  Unexpected console statement  no-console\n  278:7   warning  Unexpected console statement  no-console\n  296:25  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/SignatureStamp-optimized.cy.tsx\n   9:3  warning  'timestamp' is defined but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                          @typescript-eslint/no-unused-vars\n  41:9  warning  Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element  @next/next/no-img-element\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/SignatureStep.tsx\n   29:3  warning  'onChange' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  113:9  warning  'handleBackToCreation' is assigned a value but never used                       @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(auth)/onboarding/components/VerificationStep.tsx\n   59:5  warning  Unexpected console statement  no-console\n   68:9  warning  Unexpected console statement  no-console\n   82:9  warning  Unexpected console statement  no-console\n   88:7  warning  Unexpected console statement  no-console\n  137:5  warning  Unexpected console statement  no-console\n  153:9  warning  Unexpected console statement  no-console\n  163:9  warning  Unexpected console statement  no-console\n  183:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(auth)/onboarding/page.tsx\n   48:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n   86:5   warning  Unexpected console statement                                                           no-console\n  101:9   warning  Unexpected console statement                                                           no-console\n  110:9   warning  Unexpected console statement                                                           no-console\n  135:5   warning  Unexpected console statement                                                           no-console\n  142:5   warning  Unexpected console statement                                                           no-console\n  149:5   warning  Unexpected console statement                                                           no-console\n  153:7   warning  Unexpected console statement                                                           no-console\n  159:9   warning  Unexpected console statement                                                           no-console\n  174:11  warning  Unexpected console statement                                                           no-console\n  182:11  warning  Unexpected console statement                                                           no-console\n  193:13  warning  Unexpected console statement                                                           no-console\n  198:9   warning  Unexpected console statement                                                           no-console\n  206:7   warning  Unexpected console statement                                                           no-console\n  212:9   warning  Unexpected console statement                                                           no-console\n  216:11  warning  Unexpected console statement                                                           no-console\n  219:9   warning  Unexpected console statement                                                           no-console\n  227:7   warning  Unexpected console statement                                                           no-console\n  233:9   warning  Unexpected console statement                                                           no-console\n  241:11  warning  Unexpected console statement                                                           no-console\n  244:9   warning  Unexpected console statement                                                           no-console\n  251:7   warning  Unexpected console statement                                                           no-console\n  283:7   warning  Unexpected console statement                                                           no-console\n  322:7   warning  Unexpected console statement                                                           no-console\n  350:7   warning  Unexpected console statement                                                           no-console\n  355:7   warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(auth)/signup/page.tsx\n  14:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  82:15  warning  'confirmPassword' is assigned a value but never used                                   @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/assets/[id]/edit/page.tsx\n  8:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/assets/add/page.tsx\n    62:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n   160:5   warning  Unexpected console statement                                                           no-console\n   161:5   warning  Unexpected console statement                                                           no-console\n   166:9   warning  Unexpected console statement                                                           no-console\n   167:9   warning  Unexpected console statement                                                           no-console\n   171:11  warning  Unexpected console statement                                                           no-console\n   176:13  warning  Unexpected console statement                                                           no-console\n   179:11  warning  Unexpected console statement                                                           no-console\n   185:9   warning  Unexpected console statement                                                           no-console\n   189:7   warning  Unexpected console statement                                                           no-console\n   194:5   warning  Unexpected console statement                                                           no-console\n   202:9   warning  Unexpected console statement                                                           no-console\n   203:9   warning  Unexpected console statement                                                           no-console\n   204:9   warning  Unexpected console statement                                                           no-console\n   205:9   warning  Unexpected console statement                                                           no-console\n   209:9   warning  Unexpected console statement                                                           no-console\n   219:9   warning  Unexpected console statement                                                           no-console\n   237:7   warning  Unexpected console statement                                                           no-console\n   238:7   warning  Unexpected console statement                                                           no-console\n   241:7   warning  Unexpected console statement                                                           no-console\n   248:7   warning  Unexpected console statement                                                           no-console\n   249:7   warning  Unexpected console statement                                                           no-console\n   254:9   warning  Unexpected console statement                                                           no-console\n   255:9   warning  Unexpected console statement                                                           no-console\n   260:9   warning  Unexpected console statement                                                           no-console\n   268:9   warning  Unexpected console statement                                                           no-console\n   275:7   warning  Unexpected console statement                                                           no-console\n   288:5   warning  Unexpected console statement                                                           no-console\n   289:5   warning  Unexpected console statement                                                           no-console\n   290:5   warning  Unexpected console statement                                                           no-console\n   303:7   warning  Unexpected console statement                                                           no-console\n   811:21  warning  Unexpected console statement                                                           no-console\n   815:21  warning  Unexpected console statement                                                           no-console\n  1037:17  warning  Unexpected console statement                                                           no-console\n  1038:17  warning  Unexpected console statement                                                           no-console\n  1039:17  warning  Unexpected console statement                                                           no-console\n  1040:17  warning  Unexpected console statement                                                           no-console\n  1041:17  warning  Unexpected console statement                                                           no-console\n  1045:21  warning  Unexpected console statement                                                           no-console\n  1048:21  warning  Unexpected console statement                                                           no-console\n  1054:19  warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/assets/page.tsx\n  39:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  46:21  warning  'setSortOrder' is assigned a value but never used                                      @typescript-eslint/no-unused-vars\n  75:9   warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/beneficiaries/[id]/edit/page.tsx\n  20:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/beneficiaries/add/page.tsx\n  13:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/beneficiaries/page.tsx\n  29:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/dashboard/DashboardClient.tsx\n  29:11  warning  'DashboardStats' is defined but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/dashboard/page.tsx\n  8:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/layout.tsx\n  4:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/CreateRuleModal.cy.tsx\n  20:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/CreateRuleModal.tsx\n  213:9  warning  Unexpected console statement  no-console\n  270:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/EditRuleModal.cy.tsx\n  21:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/EditRuleModal.tsx\n  216:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(dashboard)/rules/components/ViewRuleModal.tsx\n  46:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/(dashboard)/rules/page.tsx\n  27:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  64:9  warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/test-shared-form/page.tsx\n   9:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n  13:5  warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/(dashboard)/will/WillClient.tsx\n  22:12  warning  'willError' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/(dashboard)/will/page.tsx\n  7:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/_lib/QueryProvider.cy.tsx\n  16:9   warning  'queryClient' is assigned a value but never used  @typescript-eslint/no-unused-vars\n  39:17  warning  'queryClient' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/_lib/error.tsx\n  5:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/api/assets/[id]/documents/route.ts\n   73:5   warning  Unexpected console statement                 no-console\n   75:7   warning  Unexpected console statement                 no-console\n  121:7   warning  Unexpected console statement                 no-console\n  125:7   warning  Unexpected console statement                 no-console\n  166:5   warning  Unexpected console statement                 no-console\n  167:5   warning  Unexpected console statement                 no-console\n  196:11  warning  'filter' is assigned a value but never used  @typescript-eslint/no-unused-vars\n  221:5   warning  Unexpected console statement                 no-console\n\n/Users/dean/code/Herit/app/api/assets/[id]/route.ts\n   52:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n  146:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n  210:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/assets/categories/route.ts\n  12:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  37:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/assets/route.ts\n  164:5   warning  Unexpected console statement       no-console\n  277:12  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/audit/log-event/route.ts\n  45:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/create-test-user/route.ts\n  75:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/google/callback/route.ts\n   39:7  warning  Unexpected console statement  no-console\n  166:7  warning  Unexpected console statement  no-console\n  216:7  warning  Unexpected console statement  no-console\n  505:7  warning  Unexpected console statement  no-console\n  534:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/google/route.ts\n   6:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  56:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/auth/login/route.ts\n  70:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/logout/route.ts\n   5:28  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  12:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/auth/refresh/route.ts\n  51:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/register/route.ts\n  85:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/auth/session/route.ts\n   5:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  27:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/beneficiaries/[id]/route.ts\n   49:5  warning  Unexpected console statement  no-console\n  127:5  warning  Unexpected console statement  no-console\n  180:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/beneficiaries/count/route.ts\n   8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  40:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/beneficiaries/photo/route.ts\n  75:7  warning  Unexpected console statement  no-console\n  83:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/beneficiaries/route.ts\n   90:5  warning  Unexpected console statement  no-console\n  154:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/debug-user/route.ts\n  68:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/debug/verification/route.ts\n  147:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/documents/[id]/route.ts\n  24:5  warning  Unexpected console statement  no-console\n  55:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/documents/requirements/[type]/route.ts\n  25:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/health/route.ts\n  34:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  55:11  warning  'result' is assigned a value but never used                                    @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/onboarding/complete/route.ts\n    9:28  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   48:9   warning  Unexpected console statement                                                   no-console\n   61:11  warning  Unexpected console statement                                                   no-console\n   78:9   warning  Unexpected console statement                                                   no-console\n   91:5   warning  Unexpected console statement                                                   no-console\n  127:7   warning  Unexpected console statement                                                   no-console\n  136:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/consent-signature/route.ts\n   9:3  warning  Unexpected console statement  no-console\n  13:5  warning  Unexpected console statement  no-console\n  19:7  warning  Unexpected console statement  no-console\n  91:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/legal-consent/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   38:5   warning  Unexpected console statement                                                   no-console\n  110:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/personal-info/route.ts\n  127:5   warning  Unexpected console statement  no-console\n  186:5   warning  Unexpected console statement  no-console\n  210:5   warning  Unexpected console statement  no-console\n  283:5   warning  Unexpected console statement  no-console\n  289:7   warning  Unexpected console statement  no-console\n  291:7   warning  Unexpected console statement  no-console\n  341:5   warning  Unexpected console statement  no-console\n  349:7   warning  Unexpected console statement  no-console\n  369:5   warning  Unexpected console statement  no-console\n  405:13  warning  Unexpected console statement  no-console\n  406:13  warning  Unexpected console statement  no-console\n  412:13  warning  Unexpected console statement  no-console\n  432:5   warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/photo/route.ts\n  75:7  warning  Unexpected console statement  no-console\n  83:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/save-step/route.ts\n   91:5  warning  Unexpected console statement  no-console\n  100:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/onboarding/signature/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   54:5   warning  Unexpected console statement                                                   no-console\n  173:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/status/route.ts\n   5:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  23:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/verification/route.ts\n   9:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  93:7   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/onboarding/verification/sync/route.ts\n    9:28  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   66:11  warning  Unexpected console statement                                                   no-console\n   96:9   warning  Unexpected console statement                                                   no-console\n  139:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/rules/[id]/route.ts\n   86:5  warning  Unexpected console statement  no-console\n  248:5  warning  Unexpected console statement  no-console\n  284:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/rules/route.ts\n   40:6   warning  'CreateRuleRequest' is defined but never used                                  @typescript-eslint/no-unused-vars\n   42:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  105:5   warning  Unexpected console statement                                                   no-console\n  247:5   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/api/rules/validate-allocation/route.ts\n   22:6  warning  'ValidateAllocationRequest' is defined but never used  @typescript-eslint/no-unused-vars\n  195:5  warning  Unexpected console statement                           no-console\n\n/Users/dean/code/Herit/app/api/stripe/webhook/route.ts\n   22:7   warning  Unexpected console statement                           no-console\n   39:14  warning  'error' is defined but never used                      @typescript-eslint/no-unused-vars\n   57:12  warning  'error' is defined but never used                      @typescript-eslint/no-unused-vars\n   72:7   warning  Unexpected console statement                           no-console\n   77:29  warning  'verificationData' is assigned a value but never used  @typescript-eslint/no-unused-vars\n  113:7   warning  Unexpected console statement                           no-console\n  128:5   warning  Unexpected console statement                           no-console\n  151:7   warning  Unexpected console statement                           no-console\n  160:5   warning  Unexpected console statement                           no-console\n  168:5   warning  Unexpected console statement                           no-console\n\n/Users/dean/code/Herit/app/api/test-counts/route.ts\n  18:5  warning  Unexpected console statement  no-console\n  25:5  warning  Unexpected console statement  no-console\n  26:5  warning  Unexpected console statement  no-console\n  33:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/test-db/route.ts\n  18:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/test-reports/route.ts\n  25:11  warning  Unexpected console statement  no-console\n  43:5   warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/api/test-runner/route.ts\n   23:5   warning  Unexpected console statement       no-console\n   49:7   warning  Unexpected console statement       no-console\n   83:11  warning  Unexpected console statement       no-console\n  114:24  warning  'error' is defined but never used  @typescript-eslint/no-unused-vars\n  165:13  warning  Unexpected console statement       no-console\n  177:13  warning  Unexpected console statement       no-console\n  196:15  warning  Unexpected console statement       no-console\n  207:11  warning  Unexpected console statement       no-console\n  232:5   warning  Unexpected console statement       no-console\n  248:5   warning  Unexpected console statement       no-console\n  253:7   warning  Unexpected console statement       no-console\n  267:5   warning  Unexpected console statement       no-console\n\n/Users/dean/code/Herit/app/api/will/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   58:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n  116:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/api/will/status/route.ts\n    8:27  warning  'request' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   61:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n  136:12  warning  'error' is defined but never used                                              @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/auth/AuthErrorHandler.tsx\n  31:7  warning  Unexpected console statement  no-console\n  40:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/auth/EmailSignupForm.tsx\n  62:15  warning  'confirmPassword' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/auth/LoginForm-enhanced.cy.tsx\n  555:13  warning  'currentMode' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/auth/ProtectedRoute.tsx\n  25:5  warning  Unexpected console statement  no-console\n  41:9  warning  Unexpected console statement  no-console\n  50:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/auth/SignatureCanvas.tsx\n  24:11  warning  'theme' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryForm.cy.tsx\n  22:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryList.tsx\n  59:3  warning  'onPageSizeChange' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryPhotoInput.cy.tsx\n  22:7  warning  'mockCallbacks' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/beneficiaries/BeneficiaryPhotoInput.tsx\n  24:3  warning  'isInvalid' is assigned a value but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  25:3  warning  'errorMessage' is defined but never used. Allowed unused args must match /^_.*?$/u        @typescript-eslint/no-unused-vars\n  91:7  warning  Unexpected console statement                                                              no-console\n\n/Users/dean/code/Herit/app/components/documents/DocumentManager.tsx\n   53:1   warning  Prefer named exports over default exports for React components to improve testability                                                                                                                                                                                                    storybook-cypress-compliance/require-named-export\n   60:10  warning  'viewMode' is assigned a value but never used                                                                                                                                                                                                                                            @typescript-eslint/no-unused-vars\n   60:20  warning  'setViewMode' is assigned a value but never used                                                                                                                                                                                                                                         @typescript-eslint/no-unused-vars\n  122:5   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  130:11  warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  144:9   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  162:9   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  404:17  warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  430:19  warning  Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element  @next/next/no-img-element\n\n/Users/dean/code/Herit/app/components/documents/DocumentUploadZone.tsx\n   49:1   warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n   51:3   warning  'assetType' is defined but never used. Allowed unused args must match /^_.*?$/u        @typescript-eslint/no-unused-vars\n  118:11  warning  'uploadId' is assigned a value but never used                                          @typescript-eslint/no-unused-vars\n  171:13  warning  Unexpected console statement                                                           no-console\n  228:7   warning  Unexpected console statement                                                           no-console\n\n/Users/dean/code/Herit/app/components/layout/navbar.tsx\n  23:17  warning  'isSessionLoading' is assigned a value but never used  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/pages/HomePageClient.tsx\n  31:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/shared/DependencyInjectionExample.tsx\n   60:13  warning  'key' is defined but never used. Allowed unused args must match /^_.*?$/u    @typescript-eslint/no-unused-vars\n   60:18  warning  'value' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   63:13  warning  'key' is defined but never used. Allowed unused args must match /^_.*?$/u    @typescript-eslint/no-unused-vars\n   64:16  warning  'key' is defined but never used. Allowed unused args must match /^_.*?$/u    @typescript-eslint/no-unused-vars\n  141:7   warning  Unexpected console statement                                                 no-console\n  161:7   warning  Unexpected console statement                                                 no-console\n  182:7   warning  Unexpected console statement                                                 no-console\n  303:14  warning  'error' is defined but never used                                            @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/components/shared/SharedPersonalInfoFormProvider.tsx\n  65:7  warning  Unexpected console statement  no-console\n  69:7  warning  Unexpected console statement  no-console\n  86:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/components/shared/SharedPhotoUpload.tsx\n   27:3   warning  'name' is assigned a value but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                      @typescript-eslint/no-unused-vars\n   28:3   warning  'isInvalid' is assigned a value but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                 @typescript-eslint/no-unused-vars\n   29:3   warning  'errorMessage' is defined but never used. Allowed unused args must match /^_.*?$/u                                                                                                                                                                                                       @typescript-eslint/no-unused-vars\n  129:7   warning  Unexpected console statement                                                                                                                                                                                                                                                             no-console\n  171:9   warning  'markPhotoForDeletion' is assigned a value but never used                                                                                                                                                                                                                                @typescript-eslint/no-unused-vars\n  183:9   warning  'restorePhoto' is assigned a value but never used                                                                                                                                                                                                                                        @typescript-eslint/no-unused-vars\n  209:9   warning  'getTitle' is assigned a value but never used                                                                                                                                                                                                                                            @typescript-eslint/no-unused-vars\n  231:9   warning  'getDescription' is assigned a value but never used                                                                                                                                                                                                                                      @typescript-eslint/no-unused-vars\n  313:13  warning  Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element  @next/next/no-img-element\n\n/Users/dean/code/Herit/app/components/ui/ErrorBoundary.tsx\n   29:5  warning  Unexpected console statement  no-console\n  101:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/hooks/useAssets.ts\n  220:22  warning  'assetId' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/hooks/useDocuments.ts\n  79:20  warning  'documentId' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/hooks/useRules.ts\n  109:7  warning  Unexpected console statement  no-console\n  152:7  warning  Unexpected console statement  no-console\n  185:7  warning  Unexpected console statement  no-console\n  218:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/layout.tsx\n  48:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/lib/audit-middleware.ts\n   66:7   warning  Unexpected console statement                 no-console\n   84:11  warning  'action' is assigned a value but never used  @typescript-eslint/no-unused-vars\n   99:14  warning  'error' is defined but never used            @typescript-eslint/no-unused-vars\n  185:14  warning  'error' is defined but never used            @typescript-eslint/no-unused-vars\n  202:16  warning  'error' is defined but never used            @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/app/lib/auth-client.ts\n  28:7  warning  Unexpected console statement  no-console\n  40:5  warning  Unexpected console statement  no-console\n  74:5  warning  Unexpected console statement  no-console\n  93:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/auth.ts\n   70:5  warning  Unexpected console statement  no-console\n   89:5  warning  Unexpected console statement  no-console\n  108:5  warning  Unexpected console statement  no-console\n  128:5  warning  Unexpected console statement  no-console\n  150:7  warning  Unexpected console statement  no-console\n  174:7  warning  Unexpected console statement  no-console\n  246:5  warning  Unexpected console statement  no-console\n  302:7  warning  Unexpected console statement  no-console\n  361:7  warning  Unexpected console statement  no-console\n  407:5  warning  Unexpected console statement  no-console\n  517:5  warning  Unexpected console statement  no-console\n  533:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/document-storage.ts\n  103:7   warning  Unexpected console statement                                                   no-console\n  115:7   warning  Unexpected console statement                                                   no-console\n  140:7   warning  Unexpected console statement                                                   no-console\n  219:27  warning  'assetId' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  225:7   warning  Unexpected console statement                                                   no-console\n  240:7   warning  Unexpected console statement                                                   no-console\n\n/Users/dean/code/Herit/app/lib/logger.ts\n  42:11  warning  Unexpected console statement  no-console\n  46:9   warning  Unexpected console statement  no-console\n  49:9   warning  Unexpected console statement  no-console\n  52:9   warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/photo-utils.ts\n   54:7  warning  Unexpected console statement  no-console\n   60:5  warning  Unexpected console statement  no-console\n   64:7  warning  Unexpected console statement  no-console\n   73:7  warning  Unexpected console statement  no-console\n   80:7  warning  Unexpected console statement  no-console\n   97:5  warning  Unexpected console statement  no-console\n  101:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/query-error-handling.ts\n  78:9  warning  Unexpected console statement  no-console\n  92:9  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/signature-extract.ts\n  496:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/stripe.ts\n   51:9  warning  Unexpected console statement  no-console\n  102:9  warning  Unexpected console statement  no-console\n  144:7  warning  Unexpected console statement  no-console\n  168:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/lib/svg-sanitizer.ts\n  80:7  warning  Unexpected console statement  no-console\n  87:5  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/app/page.tsx\n  6:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/app/test-status/page.tsx\n  3:1  warning  Prefer named exports over default exports for React components to improve testability  storybook-cypress-compliance/require-named-export\n\n/Users/dean/code/Herit/components/TestStatusDashboard.tsx\n    54:7   warning  'SSE_CHUNK_TIMEOUT' is assigned a value but never used                       @typescript-eslint/no-unused-vars\n    59:3   warning  'error' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n   181:5   warning  Unexpected console statement                                                 no-console\n   531:9   warning  Unexpected console statement                                                 no-console\n   654:9   warning  'calculateWeightedProgress' is assigned a value but never used               @typescript-eslint/no-unused-vars\n   704:7   warning  Unexpected console statement                                                 no-console\n   706:7   warning  Unexpected console statement                                                 no-console\n   717:7   warning  Unexpected console statement                                                 no-console\n   724:7   warning  Unexpected console statement                                                 no-console\n   729:5   warning  Unexpected console statement                                                 no-console\n   769:7   warning  Unexpected console statement                                                 no-console\n   784:11  warning  Unexpected console statement                                                 no-console\n   965:5   warning  Unexpected console statement                                                 no-console\n   979:9   warning  Unexpected console statement                                                 no-console\n   981:9   warning  Unexpected console statement                                                 no-console\n   987:7   warning  Unexpected console statement                                                 no-console\n  1022:9   warning  Unexpected console statement                                                 no-console\n  1028:7   warning  Unexpected console statement                                                 no-console\n  1153:11  warning  Unexpected console statement                                                 no-console\n  1167:9   warning  Unexpected console statement                                                 no-console\n  1470:19  warning  Unexpected console statement                                                 no-console\n  1521:17  warning  Unexpected console statement                                                 no-console\n  1918:7   warning  Unexpected console statement                                                 no-console\n  2014:9   warning  'getSuccessRate' is assigned a value but never used                          @typescript-eslint/no-unused-vars\n  2036:9   warning  'liveTestStats' is assigned a value but never used                           @typescript-eslint/no-unused-vars\n  2369:23  warning  'totalTests' is assigned a value but never used                              @typescript-eslint/no-unused-vars\n  2370:23  warning  'passedTests' is assigned a value but never used                             @typescript-eslint/no-unused-vars\n  2371:23  warning  'failedTests' is assigned a value but never used                             @typescript-eslint/no-unused-vars\n  2374:23  warning  'passRate' is assigned a value but never used                                @typescript-eslint/no-unused-vars\n  2868:59  warning  'index' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n\n/Users/dean/code/Herit/lib/test-counter.ts\n  145:7  warning  Unexpected console statement  no-console\n\n/Users/dean/code/Herit/lib/test-runner.ts\n   72:7   warning  Unexpected console statement                                                       no-console\n   92:7   warning  Unexpected console statement                                                       no-console\n   96:7   warning  Unexpected console statement                                                       no-console\n  111:11  warning  Unexpected console statement                                                       no-console\n  135:14  warning  'error' is defined but never used                                                  @typescript-eslint/no-unused-vars\n  136:7   warning  Unexpected console statement                                                       no-console\n  231:5   warning  'abortSignal' is defined but never used. Allowed unused args must match /^_.*?$/u  @typescript-eslint/no-unused-vars\n  237:5   warning  Unexpected console statement                                                       no-console\n  319:7   warning  Unexpected console statement                                                       no-console\n  324:9   warning  Unexpected console statement                                                       no-console\n  334:9   warning  Unexpected console statement                                                       no-console\n  338:11  warning  Unexpected console statement                                                       no-console\n  352:15  warning  Unexpected console statement                                                       no-console\n  363:13  warning  Unexpected console statement                                                       no-console\n  366:13  warning  Unexpected console statement                                                       no-console\n  381:11  warning  Unexpected console statement                                                       no-console\n  395:15  warning  Unexpected console statement                                                       no-console\n  404:13  warning  Unexpected console statement                                                       no-console\n  407:13  warning  Unexpected console statement                                                       no-console\n  427:9   warning  Unexpected console statement                                                       no-console\n  456:13  warning  Unexpected console statement                                                       no-console\n  481:7   warning  Unexpected console statement                                                       no-console\n  485:7   warning  Unexpected console statement                                                       no-console\n  509:7   warning  Unexpected console statement                                                       no-console\n  526:11  warning  Unexpected console statement                                                       no-console\n  564:11  warning  Unexpected console statement                                                       no-console\n  567:11  warning  Unexpected console statement                                                       no-console\n  569:11  warning  Unexpected console statement                                                       no-console\n  645:7   warning  Unexpected console statement                                                       no-console\n  647:7   warning  Unexpected console statement                                                       no-console\n\n✖ 419 problems (0 errors, 419 warnings)\n\n",
      "startTime": 1757013046911,
      "endTime": 1757013054291,
      "duration": 7380,
      "individualTests": {
        "total": 1,
        "passed": 1,
        "failed": 0,
        "skipped": 0,
        "passRate": 100,
        "progress": 100
      }
    },
    "build": {
      "command": "npm run typecheck",
      "status": "completed",
      "output": "\n> herit@0.1.0 typecheck\n> tsc --noEmit --skipLibCheck\n\n",
      "startTime": 1757013054292,
      "endTime": 1757013059829,
      "duration": 5537,
      "individualTests": {
        "total": 1,
        "passed": 1,
        "failed": 0,
        "skipped": 0,
        "passRate": 100,
        "progress": 100
      }
    },
    "componentTestsAccessibility": {
      "command": "npm run test:ct:accessibility",
      "status": "failed",
      "output": "\n> herit@0.1.0 test:ct:accessibility\n> cypress run --component --config video=false,screenshotOnRunFailure=false --quiet --spec 'app/_lib/**/*.cy.tsx,app/components/auth/**/*.cy.tsx,app/components/ui/**/*.cy.tsx,app/components/layout/**/*.cy.tsx,app/components/branding/**/*.cy.tsx,app/components/pages/**/*.cy.tsx,app/components/examples/**/*.cy.tsx'\n\nYour configFile threw an error from: cypress.config.js\n\nWe stopped running your tests because your config file crashed.\n\nError: listen EADDRINUSE: address already in use 127.0.0.1:8080\n    at Server.setupListenHandle [as _listen2] (node:net:1937:16)\n    at listenInCluster (node:net:1994:12)\n    at node:net:2203:7\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n[77141:0904/201101.138497:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n[77141:0904/201101.138554:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n\nDevTools listening on ws://127.0.0.1:64117/devtools/browser/aea2762b-5a79-47bb-b240-dde45c7563ca\n",
      "startTime": 1757013059831,
      "endTime": 1757013067352,
      "duration": 7521,
      "error": "Process exited with code 1",
      "individualTests": {
        "total": 1,
        "passed": 0,
        "failed": 1,
        "skipped": 0,
        "passRate": 0,
        "progress": 25
      }
    },
    "componentTestsCore": {
      "command": "npm run test:ct:core",
      "status": "failed",
      "output": "\n> herit@0.1.0 test:ct:core\n> cypress run --component --config video=false,screenshotOnRunFailure=false --quiet --spec 'app/components/beneficiaries/**/*.cy.tsx,app/components/documents/**/*.cy.tsx,app/components/shared/**/*.cy.tsx,app/components/dashboard/**/*.cy.tsx,app/(dashboard)/**/*.cy.tsx,app/(auth)/**/*.cy.tsx,components/**/*.cy.tsx'\n\n14 assets\n967 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 2159 ms\n18 assets\n1439 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 995 ms\n\n\n  BeneficiaryCard\n    Core Functionality\n      (Attempt 1 of 2) renders without crashing\n      1) renders without crashing\n      ✓ displays beneficiary name (38ms)\n      ✓ displays beneficiary email (31ms)\n      ✓ displays relationship type (30ms)\n      (Attempt 1 of 2) shows menu dropdown\n      2) shows menu dropdown\n\n\n  3 passing (16s)\n  2 failing\n\n  1) BeneficiaryCard\n       Core Functionality\n         renders without crashing:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-cy=\"beneficiary-card\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryCard.cy.tsx:44:52)\n\n  2) BeneficiaryCard\n       Core Functionality\n         shows menu dropdown:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `button[aria-haspopup=\"menu\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryCard.cy.tsx:84:52)\n\n\n\n18 assets\n1574 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 1914 ms\n\n\n  BeneficiaryForm\n    Core Functionality\n      (Attempt 1 of 3) renders without crashing\n      (Attempt 2 of 3) renders without crashing\n      1) renders without crashing\n      (Attempt 1 of 3) responds to user interactions\n      (Attempt 2 of 3) responds to user interactions\n      2) responds to user interactions\n    Error Handling\n      (Attempt 1 of 3) shows validation errors\n      (Attempt 2 of 3) shows validation errors\n      3) shows validation errors\n    Accessibility\n      (Attempt 1 of 3) meets basic accessibility standards\n      (Attempt 2 of 3) meets basic accessibility standards\n      4) meets basic accessibility standards\n      (Attempt 1 of 3) supports keyboard navigation\n      (Attempt 2 of 3) supports keyboard navigation\n      5) supports keyboard navigation\n    User Interactions\n      (Attempt 1 of 3) handles click events\n      (Attempt 2 of 3) handles click events\n      6) handles click events\n    Responsive Design\n      (Attempt 1 of 3) adapts to different screen sizes\n      (Attempt 2 of 3) adapts to different screen sizes\n      7) adapts to different screen sizes\n    Integration\n      (Attempt 1 of 3) works within parent containers\n      (Attempt 2 of 3) works within parent containers\n      8) works within parent containers\n\n\n  0 passing (2m)\n  8 failing\n\n  1) BeneficiaryForm\n       Core Functionality\n         renders without crashing:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"beneficiary-button\"], [data-testid=\"beneficiaryform\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryForm.cy.tsx:65:95)\n      at getRet (http://localhost:8080/__cypress/runner/cypress_runner.js:120768:20)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise.attempt.Promise.try (http://localhost:8080/__cypress/runner/cypress_runner.js:4285:29)\n      at Context.thenFn (http://localhost:8080/__cypress/runner/cypress_runner.js:120779:66)\n      at Context.then (http://localhost:8080/__cypress/runner/cypress_runner.js:121030:21)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n\n  2) BeneficiaryForm\n       Core Functionality\n         responds to user interactions:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"beneficiary-button\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryForm.cy.tsx:94:16)\n\n  3) BeneficiaryForm\n       Error Handling\n         shows validation errors:\n     CypressError: Timed out retrying after 4050ms: `cy.click()` failed because this element is `disabled`:\n\n`<button data-disabled=\"true\" data-loading=\"true\" type=\"submit\" disabled=\"\" data-react-aria-pressable=\"true\" data-component-category=\"input\" data-testid=\"beneficiary-submit\" class=\"z-0 group relative inline-flex items-center justify-center box-border appearance-none select-none whitespace-nowrap font-normal subpixel-antialiased overflow-hidden tap-highlight-transparent transform-gpu data-[pressed=true]:scale-[0.97] cursor-pointer outline-solid outline-transparent data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 px-4 min-w-20 h-10 text-small gap-2 rounded-medium opacity-disabled pointer-events-none [&amp;>svg]:max-w-[theme(spacing.8)] transition-transform-colors-opacity motion-reduce:transition-none bg-primary text-primary-foreground data-[hover=true]:opacity-hover\">...</button>`\n\nFix this problem, or use `{force: true}` to disable error checking.\n\nhttps://on.cypress.io/element-cannot-be-interacted-with\n      at Object.isNotDisabled (http://localhost:8080/__cypress/runner/cypress_runner.js:148421:58)\n      at runAllChecks (http://localhost:8080/__cypress/runner/cypress_runner.js:114522:26)\n      at retryActionability (http://localhost:8080/__cypress/runner/cypress_runner.js:114611:16)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise.attempt.Promise.try (http://localhost:8080/__cypress/runner/cypress_runner.js:4285:29)\n      at whenStable (http://localhost:8080/__cypress/runner/cypress_runner.js:147282:68)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147223:14)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromise0 (http://localhost:8080/__cypress/runner/cypress_runner.js:1591:10)\n      at Promise._settlePromises (http://localhost:8080/__cypress/runner/cypress_runner.js:1671:18)\n      at Promise._fulfill (http://localhost:8080/__cypress/runner/cypress_runner.js:1615:18)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:5420:46)\n\n  4) BeneficiaryForm\n       Accessibility\n         meets basic accessibility standards:\n\n      Timed out retrying after 4000ms\n      + expected - actual\n\n\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryForm.cy.tsx:147:43)\n      at getRet (http://localhost:8080/__cypress/runner/cypress_runner.js:120768:20)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise.attempt.Promise.try (http://localhost:8080/__cypress/runner/cypress_runner.js:4285:29)\n      at Context.thenFn (http://localhost:8080/__cypress/runner/cypress_runner.js:120779:66)\n      at Context.then (http://localhost:8080/__cypress/runner/cypress_runner.js:121030:21)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n\n  5) BeneficiaryForm\n       Accessibility\n         supports keyboard navigation:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `focused`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryForm.cy.tsx:175:26)\n\n  6) BeneficiaryForm\n       User Interactions\n         handles click events:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"beneficiary-button\"], [data-testid=\"beneficiaryform\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryForm.cy.tsx:206:91)\n\n  7) BeneficiaryForm\n       Responsive Design\n         adapts to different screen sizes:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"beneficiary-button\"], [data-testid=\"beneficiaryform\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryForm.cy.tsx:230:91)\n\n  8) BeneficiaryForm\n       Integration\n         works within parent containers:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `[data-testid=\"beneficiary-button\"], [data-testid=\"beneficiaryform\"]`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryForm.cy.tsx:269:95)\n      at withinFn (http://localhost:8080/__cypress/runner/cypress_runner.js:135903:8)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:135984:16)\n      at __WEBPACK_DEFAULT_EXPORT__ (http://localhost:8080/__cypress/runner/cypress_runner.js:133819:10)\n      at Context.within (http://localhost:8080/__cypress/runner/cypress_runner.js:135970:67)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n\n\n\n18 assets\n1654 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 3535 ms\n\n\n  BeneficiaryList\n    Core Functionality\n      ✓ renders without crashing (144ms)\n      (Attempt 1 of 3) responds to user interactions\n      (Attempt 2 of 3) responds to user interactions\n      1) responds to user interactions\n    Accessibility\n      ✓ meets basic accessibility standards (41ms)\n      (Attempt 1 of 3) supports keyboard navigation\n      (Attempt 2 of 3) supports keyboard navigation\n      2) supports keyboard navigation\n    User Interactions\n      ✓ handles click events (180ms)\n    Responsive Design\n      ✓ adapts to different screen sizes (57ms)\n    Integration\n      ✓ works within parent containers (45ms)\n\n\n  5 passing (13s)\n  2 failing\n\n  1) BeneficiaryList\n       Core Functionality\n         responds to user interactions:\n     CypressError: `cy.click()` can only be called on a single element. Your subject contained 2 elements. Pass `{ multiple: true }` if you want to serially click each element.\n\nhttps://on.cypress.io/click\n      at mouseAction (http://localhost:8080/__cypress/runner/cypress_runner.js:113780:68)\n      at Context.click (http://localhost:8080/__cypress/runner/cypress_runner.js:113947:14)\n      at wrapped (http://localhost:8080/__cypress/runner/cypress_runner.js:141618:19)\n      at <unknown> (http://localhost:8080/__cypress/runner/cypress_runner.js:147554:15)\n      at tryCatcher (http://localhost:8080/__cypress/runner/cypress_runner.js:1777:23)\n      at Promise._settlePromiseFromHandler (http://localhost:8080/__cypress/runner/cypress_runner.js:1489:31)\n      at Promise._settlePromise (http://localhost:8080/__cypress/runner/cypress_runner.js:1546:18)\n      at Promise._settlePromiseCtx (http://localhost:8080/__cypress/runner/cypress_runner.js:1583:10)\n      at _drainQueueStep (http://localhost:8080/__cypress/runner/cypress_runner.js:2381:12)\n      at _drainQueue (http://localhost:8080/__cypress/runner/cypress_runner.js:2370:9)\n      at Async._drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2386:5)\n      at Async.drainQueues (http://localhost:8080/__cypress/runner/cypress_runner.js:2256:14)\n\n  2) BeneficiaryList\n       Accessibility\n         supports keyboard navigation:\n     AssertionError: Timed out retrying after 4000ms: Expected to find element: `focused`, but never found it.\n      at Context.eval (webpack-internal:///./app/components/beneficiaries/BeneficiaryList.cy.tsx:124:26)\n\n\n\n18 assets\n1175 modules\n\u001b[1mclient\u001b[39m\u001b[22m (webpack 5.98.0) compiled \u001b[1m\u001b[32msuccessfully\u001b[39m\u001b[22m in 608 ms\n\n\n  BeneficiaryPhotoInput\n    Core Functionality\n      (Attempt 1 of 3) renders without crashing\n      (Attempt 2 of 3) renders without crashing\n      1) renders without crashing\n      (Attempt 1 of 3) responds to user interactions\n      (Attempt 2 of 3) responds to user interactions\n      2) responds to user interactions\n    Accessibility\nwrite EPIPE\nError: write EPIPE\n    at afterWriteDispatched (node:internal/stream_base_commons:159:15)\n    at writeGeneric (node:internal/stream_base_commons:150:3)\n    at Socket._writeGeneric (node:net:971:11)\n    at Socket._write (node:net:983:8)\n    at writeOrBuffer (node:internal/streams/writable:572:12)\n    at _write (node:internal/streams/writable:501:10)\n    at Writable.write (node:internal/streams/writable:510:10)\n    at execSync (node:child_process:967:20)\n    at node:electron/js2c/node_init:2:17313\n    at <embedded>:1245:1069694\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)\n[77140:0904/201101.138495:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n[77140:0904/201101.138554:ERROR:electron/shell/common/node_bindings.cc:411] Most NODE_OPTIONs are not supported in packaged apps. See documentation for more details.\n\nDevTools listening on ws://127.0.0.1:64118/devtools/browser/252b80e1-a111-4c67-89d6-048e8decfec3\n<<<CYPRESS.STDERR.START>>><i> [webpack-dev-server] Project is running at:\n<i> [webpack-dev-server] Loopback: \u001b[36mhttp://127.0.0.1:8080/\u001b[39m\n<i> [webpack-dev-server] Content not from webpack is served from '\u001b[36m/Users/dean/code/Herit/public\u001b[39m' directory\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>><<<CYPRESS.STDERR.START>>><i> [webpack-dev-middleware] wait until bundle finished: /__cypress/src/index.html\n<<<CYPRESS.STDERR.END>>>",
      "startTime": 1757013059833,
      "endTime": 1757013240968,
      "duration": 181135,
      "error": "Process was terminated (SIGTERM) due to timeout",
      "individualTests": {
        "total": 3,
        "passed": 3,
        "failed": 0,
        "skipped": 0,
        "passRate": 100,
        "progress": 100
      }
    }
  },
  "individualTests": {
    "total": 242,
    "passed": 146,
    "failed": 96,
    "skipped": 0,
    "passRate": 60,
    "progress": 81
  }
}