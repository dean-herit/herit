#!/bin/sh

echo "🔍 Running pre-commit checks..."

# Run lint-staged (includes component test validation)
npx lint-staged

if [ $? -ne 0 ]; then
  echo "❌ Lint-staged checks failed"
  exit 1
fi

# Check if any component tests were modified
COMPONENT_TESTS=$(git diff --cached --name-only | grep -E "\.cy\.tsx$|\.stories\.tsx$")

if [ ! -z "$COMPONENT_TESTS" ]; then
  echo "🧪 Component tests modified, skipping validation in pre-commit (will be verified in CI)..."
fi

echo "✨ Pre-commit checks completed successfully!"
